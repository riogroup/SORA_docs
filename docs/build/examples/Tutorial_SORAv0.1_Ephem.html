

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>&lt;no title&gt; &mdash; Stellar Occultation Reduction Analysis develop documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="LightCurve Object Class" href="Tutorial_SORAv0.1_LightCurve.html" />
    <link rel="prev" title="ChiSquare Object Class" href="Tutorial_SORAv0.1_ChiSquare.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Stellar Occultation Reduction Analysis
          

          
          </a>

          
            
            
              <div class="version">
                0.2.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Manual:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../goals_updates.html">Goals and Version updates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../curiosities.html">Curiosities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../future_linea.html">The future and the LIneA TNO Portal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_output.html">Input and Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora_code.html">SORA Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora_code.html#python-hints-tips-and-tools-for-users-sec-python-hints">Python hints, tips and tools (for users) [Sec:Python_hints]</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_SORAv0.1_ChiSquare.html">ChiSquare Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_SORAv0.1_LightCurve.html">LightCurve Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_SORAv0.1_Observer.html">Observer Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_SORAv0.1_Occultation.html">Occultation Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_SORAv0.1_Prediction.html"><em>prediction()</em> and PredictionTable Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_SORAv0.1_Star.html">Star Class</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sora.html">Ephem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#lightcurve">Lightcurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#module-sora.Observer">Observer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#module-sora.Occultation">Occultation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#prediction">Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#module-sora.Star">Star</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#module-sora.Body">Body</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#extra">Extra</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Stellar Occultation Reduction Analysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>&lt;no title&gt;</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples/Tutorial_SORAv0.1_Ephem.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p><strong>SORA - Stellar Occultation Reduction and Analysis</strong></p>
<h2><p>Ephemeris Object Classes</p>
</h2><p>The Ephemeris Classes within SORA were created to generate geocentric ephemeris for an object. The documentation at add link contains the details about every step.</p>
<p>This Jupyter-Notebook was designed as a tutorial for how to work with the LightCurve Object Class. Any further question, please contact the core team: Altair Ramos Gomes Júnior, Bruno Eduardo Morgado, Gustavo Benedetti Rossi, and Rodrigo Carlos Boufleur.</p>
<p>Index</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="#section_1">Instantiating the Ephemeris Objects</a></p></li>
<li><p><a class="reference external" href="#section_2">Obtaining positions</a></p></li>
<li><p><a class="reference external" href="#section_3">Ksi and Eta projection</a></p></li>
<li><p><a class="reference external" href="#section_4">Adding offsets</a></p></li>
<li><p><a class="reference external" href="#section_5">Pole Position Angle and Aperture Angle</a></p></li>
<li><p><a class="reference external" href="#section_5">Apparent Magnitude</a></p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## import the Ephemeris Classes</span>
<span class="kn">from</span> <span class="nn">sora.ephem</span> <span class="kn">import</span> <span class="n">EphemPlanete</span><span class="p">,</span> <span class="n">EphemJPL</span><span class="p">,</span> <span class="n">EphemKernel</span>

<span class="c1">## To facilitate, sora allows to import Ephem directly from the sora package.</span>
<span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">EphemPlanete</span><span class="p">,</span> <span class="n">EphemJPL</span><span class="p">,</span> <span class="n">EphemKernel</span>
</pre></div>
</div>
</div>
<h3 id="section_1"><ol class="arabic">
<li><p>Instantiating the Ephemeris Objects</p>
</h3></li>
</ol>
<p>As shown in the command above, there are 3 different types of Ephemeris Classes.</p>
<ul class="simple">
<li><p>EphemPlanete - Emulates what is done by fortran codes ephemplanete.f and fit_d2_ksi_eta.</p></li>
<li><p>EphemJPL - Queries the JPL Horizons website and download ephemeris informations.</p></li>
<li><p>EphemKernel - Reads the BSP files to calculate ephemeris.</p></li>
</ul>
<p><strong>The Ephemeris Docstrings were designed to help the users. Also, each function has its Docstring containing its main purpose and the needed parameters (physical description and formats). Please, do not hesitate to use it.</strong></p>
<h4><p>1.1 Instantiating an EphemPlanete Object</p>
</h4><p>In this case, a file must be given containing Julian Date, RA (in deg), DEC (in deg) and Distance (in AU), in this order, separated by an space. Please, look at the “ephem_phoebe_ph15_jd.txt” file for an example. Only the name of the object and the file with the ephemeris is required.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>EphemPlanete<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Init signature:</span> EphemPlanete<span class="ansi-blue-fg">(</span>ephem<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> spkid<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>      &lt;no docstring&gt;
<span class="ansi-red-fg">Init docstring:</span>
Simulates the former fortran programs ephem_planete and fit_d2_ksi_eta.

Parameters:
    name (str): name of the object to search in the JPL database
    ephem (str): Input file with JD (UTC), and geocentric RA (deg), DEC (deg), and distance (AU)
    radius (int,float): Object radius, in km (Default: Online database)
    error_ra (int,float): Ephemeris RA*cosDEC error, in arcsec (Default: Online database)
    error_dec (int,float): Ephemeris DEC error, in arcsec (Default: Online database)
    mass (int,float): Object Mass, in kg (Default: 0.0)
    H (int,float): Object Absolute Magnitude (Default: NaN)
    G (int,float): Object Phase slope (Default: NaN)
<span class="ansi-red-fg">File:</span>           ~/miniconda3/lib/python3.8/site-packages/sora/ephem.py
<span class="ansi-red-fg">Type:</span>           type
<span class="ansi-red-fg">Subclasses:</span>

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_pla</span> <span class="o">=</span> <span class="n">EphemPlanete</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Phoebe&#39;</span><span class="p">,</span> <span class="n">ephem</span><span class="o">=</span><span class="s1">&#39;input/ascii/ephem_phoebe_ph15_jd.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">eph_pla</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
----------- Ephemeris -----------

EphemPlanete: Valid from 2019-06-07 02:54:00.000 until 2019-06-07 04:54:00.000 (SPKID=)
Ephem Error: RA*cosDEC: 0.000 arcsec; DEC: 0.000 arcsec

</pre></div></div>
</div>
<h4><p>1.2. Instantiating an EphemJPL Object</p>
</h4><p>In this case, only the name of the object is required as this will be used to queries the JPL database. Another important keyword is the “id_type”, which will be used to constrain the search of the object. For instance, if the name is “Europa” and the id_type is “smallbody” it looks the asteroid Europa, while if id_type is “majorbody” it looks for the Jovian satellite Europa. However, in some cases, there are still conflict name issue which solutions are being verified. A common solver is to use
the IAU ID number in the name variable</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>EphemJPL<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Init signature:</span> EphemJPL<span class="ansi-blue-fg">(</span>name<span class="ansi-blue-fg">,</span> id_type<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;smallbody&#39;</span><span class="ansi-blue-fg">,</span> spkid<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>      &lt;no docstring&gt;
<span class="ansi-red-fg">Init docstring:</span>
Obtains the ephemeris from Horizons/JPL service.

Web tool URL = https://ssd.jpl.nasa.gov/horizons.cgi

Parameters:
    name (str): name of the object to search in the JPL database
    id_type (str): type of object options: &#39;smallbody&#39;, &#39;majorbody&#39;
        (planets but also anything that is not a small body), &#39;designation&#39;,
        &#39;name&#39;, &#39;asteroid_name&#39;, &#39;comet_name&#39;, &#39;id&#39; (Horizons id number),
        or &#39;smallbody&#39; (find the closest match under any id_type). Default: &#39;smallbody&#39;
    radius (int,float): Object radius, in km (Default: Online database)
    error_ra (int,float): Ephemeris RA*cosDEC error, in arcsec (Default: Online database)
    error_dec (int,float): Ephemeris DEC error, in arcsec (Default: Online database)
    mass (int,float): Object Mass, in kg (Default: 0.0)
    H (int,float): Object Absolute Magnitude (Default: NaN)
    G (int,float): Object Phase slope (Default: NaN)
<span class="ansi-red-fg">File:</span>           ~/miniconda3/lib/python3.8/site-packages/sora/ephem.py
<span class="ansi-red-fg">Type:</span>           type
<span class="ansi-red-fg">Subclasses:</span>

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_jpl</span> <span class="o">=</span> <span class="n">EphemJPL</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Chariklo&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">eph_jpl</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
----------- Ephemeris -----------

EphemJPL: Ephemeris are downloaded from Horizons website (SPKID=)
Ephem Error: RA*cosDEC: 0.000 arcsec; DEC: 0.000 arcsec

</pre></div></div>
</div>
<h4><p>1.3. Instantiating an EphemKernel Object</p>
</h4><p>This is the most powerful Ephemeris Class. Since it reads the BSP files directly, it is faster. What is needed here is the name of the object, the kernel code which the object can be referred, and the list of kernels. Even if only one kernel is passed, it must be a list.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>EphemKernel<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Init signature:</span> EphemKernel<span class="ansi-blue-fg">(</span>kernels<span class="ansi-blue-fg">,</span> spkid<span class="ansi-blue-fg">,</span> name<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>      &lt;no docstring&gt;
<span class="ansi-red-fg">Init docstring:</span>
Gets the ephemeris from bsp kernels.

Parameters:
    name (str): name of the object to search in the JPL database
    spkid (str): spkid of the targeting object. Former &#39;code&#39; (v0.1)
    kernels(list): list of paths for kernels files
    radius (int,float): Object radius, in km (Default: Online database)
    error_ra (int,float): Ephemeris RA*cosDEC error, in arcsec (Default: Online database)
    error_dec (int,float): Ephemeris DEC error, in arcsec (Default: Online database)
    mass (int,float): Object Mass, in kg (Default: 0.0)
    H (int,float): Object Absolute Magnitude (Default: NaN)
    G (int,float): Object Phase slope (Default: NaN)
<span class="ansi-red-fg">File:</span>           ~/miniconda3/lib/python3.8/site-packages/sora/ephem.py
<span class="ansi-red-fg">Type:</span>           type
<span class="ansi-red-fg">Subclasses:</span>

</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_ker</span> <span class="o">=</span> <span class="n">EphemKernel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Chariklo&#39;</span><span class="p">,</span> <span class="n">spkid</span><span class="o">=</span><span class="s1">&#39;2010199&#39;</span><span class="p">,</span> <span class="n">kernels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;input/bsp/Chariklo.bsp&#39;</span><span class="p">,</span> <span class="s1">&#39;input/bsp/de438_small.bsp&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">eph_ker</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
----------- Ephemeris -----------

EphemKernel: CHARIKLO/DE438_SMALL (SPKID=2010199)
Ephem Error: RA*cosDEC: 0.000 arcsec; DEC: 0.000 arcsec

</pre></div></div>
</div>
<h4><p>1.4 Other parameters</p>
</h4><p>All the 3 Ephemeris Classes allow for the user to pass physical parameter, like radius, mass, the absolute magnitude (H), the Phase slope (G) and the ephemeris error in RA*cosDEC and DEC</p>
<p>If not given, the radius and ephemeris error will be downloaded from our online database.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_ker</span> <span class="o">=</span> <span class="n">EphemKernel</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Chariklo&#39;</span><span class="p">,</span> <span class="n">spkid</span><span class="o">=</span><span class="s1">&#39;2010199&#39;</span><span class="p">,</span> <span class="n">kernels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;input/bsp/Chariklo.bsp&#39;</span><span class="p">,</span> <span class="s1">&#39;input/bsp/de438_small.bsp&#39;</span><span class="p">],</span>
                      <span class="n">radius</span><span class="o">=</span><span class="mi">75</span><span class="p">,</span> <span class="n">mass</span><span class="o">=</span><span class="mf">4.2e18</span><span class="p">,</span> <span class="n">error_ra</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">error_dec</span><span class="o">=</span><span class="mf">0.02</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">eph_ker</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
----------- Ephemeris -----------

EphemKernel: CHARIKLO/DE438_SMALL (SPKID=2010199)
Ephem Error: RA*cosDEC: 0.020 arcsec; DEC: 0.020 arcsec

</pre></div></div>
</div>
<h3 id="section_2"><ol class="arabic" start="2">
<li><p>Obtaining positions</p>
</h3></li>
</ol>
<p>The Ephemeris allows the user to get the on-sky geocentric position of the object for a certain time. This function does not exist for the EphemPlanete Class since, in this case, the ephemeris is an input parameter. The returned variable is an Astropy SkyCoord object, so their functions can be used.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>eph_ker.get_position<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Signature:</span> eph_ker<span class="ansi-blue-fg">.</span>get_position<span class="ansi-blue-fg">(</span>time<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Returns the object geocentric position.

Parameters:
    time (str, Time): Reference time to calculate the object position.

Returns:
    coord (SkyCoord): Astropy SkyCoord object with the object coordinates at the given time
<span class="ansi-red-fg">File:</span>      ~/miniconda3/lib/python3.8/site-packages/sora/ephem.py
<span class="ansi-red-fg">Type:</span>      method

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pos</span> <span class="o">=</span> <span class="n">eph_ker</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="s1">&#39;2017-06-22 00:00:00&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pos</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;SkyCoord (ICRS): (ra, dec, distance) in (deg, deg, km)
    (283.86685123, -31.52237927, 2.19331444e+09)&gt;
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">ra</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">dec</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">distance</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;AU&#39;</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pos</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="s1">&#39;hmsdms&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39; &#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
283d52m00.6644s
-31d31m20.5654s
14.661401433721714 AU
18 55 28.04429 -31 31 20.56536
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_jpl</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="s1">&#39;2017-06-22 00:00:00&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&lt;SkyCoord (ICRS): (ra, dec, distance) in (deg, deg, AU)
    (283.86685422, -31.52237803, 14.66140344)&gt;
</pre></div></div>
</div>
<h3 id="section_3"><ol class="arabic" start="3">
<li><p>Ksi and Eta projection</p>
</h3></li>
</ol>
<p>Ephemeris objects calculates the orthographic projection (ksi and eta) of a site in the direction of a star given the following function. Ksi is in the East direction and Eta in the North direction.</p>
<p>The coordinates of the star given must be in the Geocentric Celestial Reference System (GCRS).</p>
<p>This is calculated automaticaly in Occultation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>eph_ker.get_ksi_eta<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Signature:</span> eph_ker<span class="ansi-blue-fg">.</span>get_ksi_eta<span class="ansi-blue-fg">(</span>time<span class="ansi-blue-fg">,</span> star<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Returns projected position* of the object in the tangent sky plane relative to a star.
    * ortographic projection.

Parameters:
    time (str, Time): Reference time to calculate the object position.
    star (str, SkyCoord): Coordinate of the star in the same reference frame as the ephemeris.

Returns:
    ksi, eta (float): projected position (ortographic projection) of the object in the tangent sky plane
        relative to a star.
        Ksi is in the North-South direction (North positive)
        Eta is in the East-West direction (East positive)
<span class="ansi-red-fg">File:</span>      ~/miniconda3/lib/python3.8/site-packages/sora/ephem.py
<span class="ansi-red-fg">Type:</span>      method

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_ker</span><span class="o">.</span><span class="n">get_ksi_eta</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:18:00&#39;</span><span class="p">,</span> <span class="n">star</span><span class="o">=</span><span class="s1">&#39;18 55 15.65250 -31 31 21.67051&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1059.3876121640205, 522.2713452577591)
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_jpl</span><span class="o">.</span><span class="n">get_ksi_eta</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:18:00&#39;</span><span class="p">,</span> <span class="n">star</span><span class="o">=</span><span class="s1">&#39;18 55 15.65250 -31 31 21.67051&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(1157.3047728204567, 569.3302025641514)
</pre></div></div>
</div>
<p><strong>In the case of EphemPlanete, the time given must be in the range of the input ephemeris.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">eph_pla</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
----------- Ephemeris -----------

EphemPlanete: Valid from 2019-06-07 02:54:00.000 until 2019-06-07 04:54:00.000 (SPKID=)
Ephem Error: RA*cosDEC: 0.000 arcsec; DEC: 0.000 arcsec

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_pla</span><span class="o">.</span><span class="n">get_ksi_eta</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">,</span> <span class="n">star</span><span class="o">=</span><span class="s1">&#39;19 21 18.63201 -21 44 25.3924&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Fitting ephemeris position relative to star coordinate 19h21m18.632s -21d44m25.3924s
ksi = aksi*t² + bksi*t + cksi
eta = aeta*t² + beta*t + ceta
t=(jd-2458641.62083333)/(2458641.70416667-2458641.62083333)
        aksi=-74.33578570337855
        bksi=-120036.66964478265
        cksi=56728.18870944269
        aeta=-11.57936927588004
        beta=-17144.75884811865
        ceta=6972.329990726598
Residual RMS: ksi=0.004 km, eta=0.001 km
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-3685.7460633119117, -1656.7962535909273)
</pre></div></div>
</div>
<p><strong>For EphemPlanete, the user can also make the fit before running get_ksi_eta. If the fit is done, get_ksi_eta will only need the time param.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>eph_pla.fit_d2_ksi_eta<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Signature:</span> eph_pla<span class="ansi-blue-fg">.</span>fit_d2_ksi_eta<span class="ansi-blue-fg">(</span>star<span class="ansi-blue-fg">,</span> log<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">True</span><span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Fits the projected position* of the object in the tangent sky plane relative to a star
    * ortographic projection.

Parameters:
    star (str, SkyCoord): The coordinate of the star in the same reference frame as the ephemeris.
    log (bool): if True, log is printed. Default: True
<span class="ansi-red-fg">File:</span>      ~/miniconda3/lib/python3.8/site-packages/sora/ephem.py
<span class="ansi-red-fg">Type:</span>      method

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_pla</span><span class="o">.</span><span class="n">fit_d2_ksi_eta</span><span class="p">(</span><span class="s1">&#39;19 21 18.63201 -21 44 25.3923&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Fitting ephemeris position relative to star coordinate 19h21m18.632s -21d44m25.3923s
ksi = aksi*t² + bksi*t + cksi
eta = aeta*t² + beta*t + ceta
t=(jd-2458641.62083333)/(2458641.70416667-2458641.62083333)
        aksi=-74.33578570337855
        bksi=-120036.66964478265
        cksi=56728.18870944269
        aeta=-11.57936945893781
        beta=-17144.758788142477
        ceta=6971.659735843642
Residual RMS: ksi=0.004 km, eta=0.001 km
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_pla</span><span class="o">.</span><span class="n">get_ksi_eta</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-3685.7460633119117, -1657.4664783438775)
</pre></div></div>
</div>
<h3 id="section_4"><ol class="arabic" start="4">
<li><p>Adding Offsets</p>
</h3></li>
</ol>
<p>If an ephemeris offset was obtained from astrometry, it can be added to the Ephemeris objects using add_offset. This values are given in <span class="math notranslate nohighlight">\(\Delta\alpha\cos\delta\)</span> and <span class="math notranslate nohighlight">\(\Delta\delta\)</span> in mas.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>eph_ker.add_offset<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Signature:</span> eph_ker<span class="ansi-blue-fg">.</span>add_offset<span class="ansi-blue-fg">(</span>da_cosdec<span class="ansi-blue-fg">,</span> ddec<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Adds an offset to the Ephemeris

Parameters:
    da_cosdec (int, float): Delta_alpha_cos_delta in mas
    ddec (int, float): Delta_delta in mas
<span class="ansi-red-fg">File:</span>      ~/miniconda3/lib/python3.8/site-packages/sora/ephem.py
<span class="ansi-red-fg">Type:</span>      method

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_ker</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="s1">&#39;2017-06-22 00:00:00&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="s1">&#39;hmsdms&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;18h55m28.0443s -31d31m20.5654s&#39;
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_ker</span><span class="o">.</span><span class="n">add_offset</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">eph_jpl</span><span class="o">.</span><span class="n">add_offset</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">eph_pla</span><span class="o">.</span><span class="n">add_offset</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">eph_ker</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="s1">&#39;2017-06-22 00:00:00&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="s1">&#39;hmsdms&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
&#39;18h55m28.0474s -31d31m20.5154s&#39;
</pre></div></div>
</div>
<h3 id="section_5"><ol class="arabic" start="5">
<li><p>Pole Position Angle and Aperture Angle</p>
</h3></li>
</ol>
<p>For a given time, and given pole coordinate, EphemJPL and EphemKernel are able to calculate the Pole Position Angle relative to the North pole in the ICRS and the Aperture Angle of the object pole coordinate.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>eph_ker.get_pole_position_angle<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Signature:</span> eph_ker<span class="ansi-blue-fg">.</span>get_pole_position_angle<span class="ansi-blue-fg">(</span>pole<span class="ansi-blue-fg">,</span> time<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Returns the object geocentric position.

Parameters:
    pole (str, SkyCoord): Coordinate of the object pole ICRS.
    time (str, Time): Time from which to calculate the position.

Returns:
    position_angle (float): Position angle of the object pole, in degrees
    aperture_angle (float): Apeture angle of the object pole, in degrees
<span class="ansi-red-fg">File:</span>      ~/miniconda3/lib/python3.8/site-packages/sora/ephem.py
<span class="ansi-red-fg">Type:</span>      method

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pos_ang</span><span class="p">,</span> <span class="n">ap_ang</span> <span class="o">=</span> <span class="n">eph_ker</span><span class="o">.</span><span class="n">get_pole_position_angle</span><span class="p">(</span><span class="s1">&#39;10 30 00 +45 50 00&#39;</span><span class="p">,</span> <span class="s1">&#39;2017-06-22 00:00:00&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">pos_ang</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ap_ang</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
305.1787848766948 deg
46.652999109286604 deg
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
&lt;ipython-input-30-ea66f7bc73f5&gt;:1: FutureWarning: get_pole_position_angle is deprecated and will be removed in v1.0; Please use get_pole_position_angle from Body object
  pos_ang, ap_ang = eph_ker.get_pole_position_angle(&#39;10 30 00 +45 50 00&#39;, &#39;2017-06-22 00:00:00&#39;)
</pre></div></div>
</div>
<h3 id="section_6"><ol class="arabic" start="6">
<li><p>Apparent Magnitude</p>
</h3></li>
</ol>
<p>The Ephemeris objectcs calculates the Apparent Magnitude of an object using the H and G given by the user. The equation is:</p>
<p><span class="math notranslate nohighlight">\(\phi_0 = \exp(-3.33(\tan(0.5 phase)^{0.63}))\)</span></p>
<p><span class="math notranslate nohighlight">\(\phi_1 = \exp(-1.87(\tan(0.5 phase)^{1.22}))\)</span></p>
<p><span class="math notranslate nohighlight">\(apmag = H - 2.5\log10((1-G)\phi_0 + G\phi_1) + 5\log10(sundist*dist)\)</span></p>
<p>However, if these values are not given by the user, the apparent magnitude will be downloaded from JPL Horizons website. If JPL has H and G, this values will be saved and then used for calculation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">eph_ker</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="n">eph_ker</span><span class="o">.</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">AttributeError</span>                            Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-31-db931461a975&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>print<span class="ansi-blue-fg">(</span>eph_ker<span class="ansi-blue-fg">.</span>H<span class="ansi-blue-fg">,</span> eph_ker<span class="ansi-blue-fg">.</span>G<span class="ansi-blue-fg">)</span>

<span class="ansi-green-fg">~/miniconda3/lib/python3.8/site-packages/sora/ephem.py</span> in <span class="ansi-cyan-fg">H</span><span class="ansi-blue-fg">(self)</span>
<span class="ansi-green-intense-fg ansi-bold">    167</span>             <span class="ansi-green-fg">return</span> self<span class="ansi-blue-fg">.</span>_H
<span class="ansi-green-intense-fg ansi-bold">    168</span>         <span class="ansi-green-fg">else</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-fg">--&gt; 169</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">raise</span> AttributeError<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;{} does not have H&#39;</span><span class="ansi-blue-fg">.</span>format<span class="ansi-blue-fg">(</span>self<span class="ansi-blue-fg">.</span>__class__<span class="ansi-blue-fg">.</span>__name__<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">    170</span>
<span class="ansi-green-intense-fg ansi-bold">    171</span>     <span class="ansi-blue-fg">@</span>H<span class="ansi-blue-fg">.</span>setter

<span class="ansi-red-fg">AttributeError</span>: EphemKernel does not have H
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># downloading from JPL</span>
<span class="n">eph_ker</span><span class="o">.</span><span class="n">apparent_magnitude</span><span class="p">(</span><span class="s1">&#39;2017-06-22 00:00:00&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">eph_ker</span><span class="o">.</span><span class="n">H</span><span class="p">,</span> <span class="n">eph_ker</span><span class="o">.</span><span class="n">G</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># calculating using H and G</span>
<span class="n">eph_ker</span><span class="o">.</span><span class="n">apparent_magnitude</span><span class="p">(</span><span class="s1">&#39;2017-06-22 00:00:00&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>This Jupyter-Notebook was designed as a tutorial for how to work with the Ephemeris Object Classes. More information about the other classes, please refer to their specif Jupyter-Notebook. Any further question, please contact the core team: Altair Ramos Gomes Júnior, Bruno Eduardo Morgado, Gustavo Benedetti Rossi, and Rodrigo Carlos Boufleur.</strong></p>
<p><em>The End.</em></p>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Tutorial_SORAv0.1_LightCurve.html" class="btn btn-neutral float-right" title="LightCurve Object Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Tutorial_SORAv0.1_ChiSquare.html" class="btn btn-neutral float-left" title="ChiSquare Object Class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, SORA Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>