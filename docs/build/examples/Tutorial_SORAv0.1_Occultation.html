

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Occultation Object Class &mdash; Stellar Occultation Reduction Analysis develop documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="prediction() and PredictionTable Object Class" href="Tutorial_SORAv0.1_Prediction.html" />
    <link rel="prev" title="Observer Object Class" href="Tutorial_SORAv0.1_Observer.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> Stellar Occultation Reduction Analysis
          

          
          </a>

          
            
            
              <div class="version">
                0.2.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Manual:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../goals_updates.html">Goals and Version updates</a></li>
<li class="toctree-l1"><a class="reference internal" href="../curiosities.html">Curiosities</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="../future_linea.html">The future and the LIneA TNO Portal</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="../input_output.html">Input and Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora_code.html">SORA Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora_code.html#python-hints-tips-and-tools-for-users-sec-python-hints">Python hints, tips and tools (for users) [Sec:Python_hints]</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="Tutorial_SORAv0.1_ChiSquare.html">ChiSquare Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_SORAv0.1_LightCurve.html">LightCurve Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_SORAv0.1_Observer.html">Observer Object Class</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Occultation Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_SORAv0.1_Prediction.html"><em>prediction()</em> and PredictionTable Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tutorial_SORAv0.1_Star.html">Star Class</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../sora.html">Ephem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#lightcurve">Lightcurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#module-sora.Observer">Observer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#module-sora.Occultation">Occultation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#prediction">Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#module-sora.Star">Star</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#module-sora.Body">Body</a></li>
<li class="toctree-l1"><a class="reference internal" href="../sora.html#extra">Extra</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Stellar Occultation Reduction Analysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Occultation Object Class</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/examples/Tutorial_SORAv0.1_Occultation.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p><strong>SORA - Stellar Occultation Reduction and Analysis</strong></p>
<div class="section" id="Occultation-Object-Class">
<h1>Occultation Object Class<a class="headerlink" href="#Occultation-Object-Class" title="Permalink to this headline">¶</a></h1>
<p>The Occultation Object Class within SORA was created to reduce and analyze stellar occultations, and control all the other Object Classes at SORA package. Here we have some useful tasks that allow converting the times for each observatory in positions in the sky plane (<span class="math notranslate nohighlight">\(\xi\)</span>, <span class="math notranslate nohighlight">\(\eta\)</span>), fit an ellipse to the points, obtain the astrometrical position resulting, among others.</p>
<p>The documentation at add link contains the details about every step.</p>
<p>This Jupyter-Notebook was designed as a tutorial for how to work with the Occultation Object Class. More information about the other classes, please refer to their specif Jupyter-Notebook. Any further question, please contact the core team: Altair Ramos Gomes Júnior, Bruno Eduardo Morgado, Gustavo Benedetti Rossi, and Rodrigo Carlos Boufleur.</p>
<p>Index</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="#section_1">Instantiating the Occultation Object and adding observations</a></p></li>
<li><p><cite>Converting from times to :math:</cite>xi` and <span class="math notranslate nohighlight">\(\eta\)</span> in the sky plane &lt;#section_2&gt;`__</p></li>
<li><p><a class="reference external" href="#section_3">Chords display and ellipse fit</a></p></li>
<li><p><a class="reference external" href="#section_4">Viewing and saving the results</a></p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">## SORA package</span>
<span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">Occultation</span><span class="p">,</span> <span class="n">EphemKernel</span><span class="p">,</span> <span class="n">Star</span><span class="p">,</span> <span class="n">LightCurve</span><span class="p">,</span> <span class="n">Observer</span>

<span class="c1">## Other main packages</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>

<span class="c1">## Usual packages</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">pl</span>
<span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
</div>
<h3 id="section_1"><ol class="arabic">
<li><p>Instantiating the Occultation Object and adding observations</p>
</h3></li>
</ol>
<p>The Occultation Object Class can be instantiated in only one way. For this it is needed a Star Object, an Ephemeris Object (EphemKernel, EphemPlanet or EphemJPL), and the occultation time (within 10 minutes for the correct value).</p>
<p><strong>The Object Docstring was designed to help the users. Also, each function has its Docstring containing its main purpose and the needed parameters (physical description and formats). Please, do not hesitate to use it.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>Occultation<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Init signature:</span> Occultation<span class="ansi-blue-fg">(</span>star<span class="ansi-blue-fg">,</span> body<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> ephem<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">,</span> time<span class="ansi-blue-fg">=</span><span class="ansi-green-fg">None</span><span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Does the reduction of the occultation

<span class="ansi-red-fg">Init docstring:</span>
Instantiates the Occultation object.

Parameters:
    star (Star, str): The coordinate of the star in the same reference frame as the ephemeris.
        It must be a Star object or a string with the coordinates of the object to search on
        Vizier (required).
    body* (Body, str): Object that will occult the star. It must be a Body object or its
        name to search in the Small Body Database.
    ephem* (Ephem): object ephemeris. It must be an Ephemeris object or a list .
    time (str, Time): Reference time of the occultation.
        Time does not need to be exact, but needs to be within approximately 50 minutes
        of the occultation closest approach to calculate occultation parameters (required).

* When instantiating with &#34;body&#34; and &#34;ephem&#34;, the user may define the Occultation in 3 ways:
    - With &#34;body&#34; and &#34;ephem&#34;.
    - With only &#34;body&#34;. In this case, the &#34;body&#34; parameter must be a Body object and have an
        ephemeris associated (see Body documentation).
    - With only &#34;ephem&#34;. In this case, the &#34;ephem&#34; parameter must be one of the Ephem Classes
        and have a name (see Ephem documentation) to search for the body in the Small Body Database.
<span class="ansi-red-fg">File:</span>           ~/miniconda3/lib/python3.8/site-packages/sora/occultation.py
<span class="ansi-red-fg">Type:</span>           type
<span class="ansi-red-fg">Subclasses:</span>

</pre></div></div>
</div>
<p><strong>First let’s instanciate the Star and the Ephemeris</strong></p>
<p>SORA will automatically search for the star information. A warning will raise when any information is missing. In this example, there is no star radius available in Gaia.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ephem_occ</span> <span class="o">=</span> <span class="n">EphemKernel</span><span class="p">(</span><span class="s1">&#39;Chariklo&#39;</span><span class="p">,</span> <span class="mi">2010199</span><span class="p">,</span> <span class="n">kernels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;input/bsp/Chariklo.bsp&#39;</span><span class="p">,</span><span class="s1">&#39;input/bsp/de438_small.bsp&#39;</span><span class="p">])</span>
<span class="n">star_occ</span>  <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="s1">&#39;18 55 15.65250 -31 31 21.67051&#39;</span><span class="p">)</span> <span class="c1"># Occ Chariklo 22-06-2017</span>
<span class="n">time_occ</span>  <span class="o">=</span> <span class="s1">&#39;2017-06-22 21:18&#39;</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">TypeError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-3-c5f65ba9997a&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>ephem_occ <span class="ansi-blue-fg">=</span> EphemKernel<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Chariklo&#39;</span><span class="ansi-blue-fg">,</span> <span class="ansi-cyan-fg">2010199</span><span class="ansi-blue-fg">,</span> kernels<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;input/bsp/Chariklo.bsp&#39;</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;input/bsp/de438_small.bsp&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> star_occ  <span class="ansi-blue-fg">=</span> Star<span class="ansi-blue-fg">(</span>coord<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;18 55 15.65250 -31 31 21.67051&#39;</span><span class="ansi-blue-fg">)</span> <span class="ansi-red-fg"># Occ Chariklo 22-06-2017</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> time_occ  <span class="ansi-blue-fg">=</span> <span class="ansi-blue-fg">&#39;2017-06-22 21:18&#39;</span>

<span class="ansi-green-fg">~/miniconda3/lib/python3.8/site-packages/sora/config/decorators.py</span> in <span class="ansi-cyan-fg">wrapper</span><span class="ansi-blue-fg">(*args, **kwargs)</span>
<span class="ansi-green-intense-fg ansi-bold">     14</span>         <span class="ansi-green-fg">def</span> wrapper<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">:</span>
<span class="ansi-green-intense-fg ansi-bold">     15</span>             rename_kwargs<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">.</span>__name__<span class="ansi-blue-fg">,</span> kwargs<span class="ansi-blue-fg">,</span> aliases<span class="ansi-blue-fg">)</span>
<span class="ansi-green-fg">---&gt; 16</span><span class="ansi-red-fg">             </span><span class="ansi-green-fg">return</span> f<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">*</span>args<span class="ansi-blue-fg">,</span> <span class="ansi-blue-fg">**</span>kwargs<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">     17</span>         <span class="ansi-green-fg">return</span> wrapper
<span class="ansi-green-intense-fg ansi-bold">     18</span>     <span class="ansi-green-fg">return</span> deco

<span class="ansi-red-fg">TypeError</span>: __init__() got multiple values for argument &#39;kernels&#39;
</pre></div></div>
</div>
<p><strong>Now, we can instantiate the Occultation</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span> <span class="o">=</span> <span class="n">Occultation</span><span class="p">(</span><span class="n">star_occ</span><span class="p">,</span> <span class="n">ephem_occ</span><span class="p">,</span> <span class="n">time_occ</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">occ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-4-42a704308058&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ <span class="ansi-blue-fg">=</span> Occultation<span class="ansi-blue-fg">(</span>star_occ<span class="ansi-blue-fg">,</span> ephem_occ<span class="ansi-blue-fg">,</span> time_occ<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> print<span class="ansi-blue-fg">(</span>occ<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;star_occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>Note that at the print(Occultation) there are no observations added to this Occultation yet.</strong></p>
<p>It is needed one Observer and one LightCurve to define an observation.</p>
<p><strong>Let’s instanciate the Observers</strong></p>
<p>Here we will give 5 locations</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">out</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Outeniqua&#39;</span>  <span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="s1">&#39;+16 49 17.710&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;-21 17 58.170&#39;</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span><span class="mi">1416</span><span class="p">)</span>
<span class="n">ond</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Onduruquea&#39;</span> <span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="s1">&#39;+15 59 33.750&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;-21 36 26.040&#39;</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span><span class="mi">1220</span><span class="p">)</span>
<span class="n">tiv</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Tivoli&#39;</span>     <span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="s1">&#39;+18 01 01.240&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;-23 27 40.190&#39;</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span><span class="mi">1344</span><span class="p">)</span>
<span class="n">whc</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Windhoek&#39;</span>   <span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="s1">&#39;+17 06 31.900&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;-22 41 55.160&#39;</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span><span class="mi">1902</span><span class="p">)</span>
<span class="n">hak</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Hakos&#39;</span>      <span class="p">,</span><span class="n">lon</span><span class="o">=</span><span class="s1">&#39;+16 21 41.320&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;-23 14 11.040&#39;</span><span class="p">,</span> <span class="n">height</span> <span class="o">=</span><span class="mi">1843</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Let’s instanciate the LightCurves</strong></p>
<p>Here we give 6 light curves. Note that 2 are for the same site observed with different telescopes.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">out_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Outeniqua lc&#39;</span><span class="p">,</span>
                    <span class="n">initial_time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:20:00.056&#39;</span><span class="p">,</span>
                    <span class="n">end_time</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:29:59.963&#39;</span><span class="p">,</span>
                    <span class="n">immersion</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:20.329&#39;</span><span class="p">,</span><span class="n">immersion_err</span><span class="o">=</span><span class="mf">0.032</span><span class="p">,</span>
                    <span class="n">emersion</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:30.343&#39;</span><span class="p">,</span><span class="n">emersion_err</span><span class="o">=</span><span class="mf">0.034</span><span class="p">)</span>

<span class="n">ond_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Onduruquea lc&#39;</span><span class="p">,</span>
                    <span class="n">initial_time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:11:52.175&#39;</span><span class="p">,</span>
                    <span class="n">end_time</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:25:13.389&#39;</span><span class="p">,</span>
                    <span class="n">immersion</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:22.213&#39;</span><span class="p">,</span><span class="n">immersion_err</span><span class="o">=</span><span class="mf">0.010</span><span class="p">,</span>
                    <span class="n">emersion</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:33.824&#39;</span><span class="p">,</span><span class="n">emersion_err</span><span class="o">=</span><span class="mf">0.011</span><span class="p">)</span>

<span class="n">tiv_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Tivoli lc&#39;</span><span class="p">,</span>
                    <span class="n">initial_time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:16:00.094&#39;</span><span class="p">,</span>
                    <span class="n">end_time</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:28:00.018&#39;</span><span class="p">,</span>
                    <span class="n">immersion</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:15.628&#39;</span><span class="p">,</span><span class="n">immersion_err</span><span class="o">=</span><span class="mf">0.011</span><span class="p">,</span>
                    <span class="n">emersion</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:19.988&#39;</span><span class="p">,</span><span class="n">emersion_err</span><span class="o">=</span><span class="mf">0.038</span><span class="p">)</span>

<span class="n">whc_c14_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Windhoek C14 lc&#39;</span><span class="p">,</span>
                    <span class="n">initial_time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:12:48.250&#39;</span><span class="p">,</span>
                    <span class="n">end_time</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:32:47.963&#39;</span><span class="p">,</span>
                    <span class="n">immersion</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:17.609&#39;</span><span class="p">,</span><span class="n">immersion_err</span><span class="o">=</span><span class="mf">0.024</span><span class="p">,</span>
                    <span class="n">emersion</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:27.564&#39;</span><span class="p">,</span><span class="n">emersion_err</span><span class="o">=</span><span class="mf">0.026</span><span class="p">)</span>

<span class="n">whc_d16_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Windhoek D16 lc&#39;</span><span class="p">,</span>
                    <span class="n">initial_time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:20:01.884&#39;</span><span class="p">,</span>
                    <span class="n">end_time</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:22:21.894&#39;</span><span class="p">,</span>
                    <span class="n">immersion</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:17.288&#39;</span><span class="p">,</span><span class="n">immersion_err</span><span class="o">=</span><span class="mf">0.028</span><span class="p">,</span>
                    <span class="n">emersion</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:21:27.228&#39;</span><span class="p">,</span><span class="n">emersion_err</span><span class="o">=</span><span class="mf">0.034</span><span class="p">)</span>

<span class="n">hak_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;Hakos lc&#39;</span><span class="p">,</span>
                    <span class="n">initial_time</span><span class="o">=</span><span class="s1">&#39;2017-06-22 21:10:19.461&#39;</span><span class="p">,</span>
                    <span class="n">end_time</span> <span class="o">=</span><span class="s1">&#39;2017-06-22 21:30:19.345&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>To add the observation to the Occultation just use the Occultation.add_observer()</strong></p>
<p>During this step the LightCurve is automatic updated using the Occultation parameters: the Shadow’s velocity, the star diameter and the distance to the occulting body. This means that is no need for the user to do the <em>LightCurve.set_dist()</em>, <em>LightCurve.set_vel()</em> and <em>LightCurve.set_star_diam()</em>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">add_observation</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">out_lc</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">add_observation</span><span class="p">(</span><span class="n">ond</span><span class="p">,</span><span class="n">ond_lc</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">add_observation</span><span class="p">(</span><span class="n">tiv</span><span class="p">,</span><span class="n">tiv_lc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-7-cb1070312653&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>add_observation<span class="ansi-blue-fg">(</span>out<span class="ansi-blue-fg">,</span>out_lc<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> occ<span class="ansi-blue-fg">.</span>add_observation<span class="ansi-blue-fg">(</span>ond<span class="ansi-blue-fg">,</span>ond_lc<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> occ<span class="ansi-blue-fg">.</span>add_observation<span class="ansi-blue-fg">(</span>tiv<span class="ansi-blue-fg">,</span>tiv_lc<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p>Note that a warning comes up if the flux drop is not calculated automatically.</p>
<p><strong>The same goes for two observation at with the same Observer</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">add_observation</span><span class="p">(</span><span class="n">whc</span><span class="p">,</span><span class="n">whc_c14_lc</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">add_observation</span><span class="p">(</span><span class="n">whc</span><span class="p">,</span><span class="n">whc_d16_lc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-8-15accee50e58&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>add_observation<span class="ansi-blue-fg">(</span>whc<span class="ansi-blue-fg">,</span>whc_c14_lc<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> occ<span class="ansi-blue-fg">.</span>add_observation<span class="ansi-blue-fg">(</span>whc<span class="ansi-blue-fg">,</span>whc_d16_lc<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>Also, the same goes for negative observations</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">add_observation</span><span class="p">(</span><span class="n">hak</span><span class="p">,</span><span class="n">hak_lc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-9-e91737f566ed&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>add_observation<span class="ansi-blue-fg">(</span>hak<span class="ansi-blue-fg">,</span>hak_lc<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>To check which observers were added to the Occultation just use</strong> <em>Occultation.observations()</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">observations</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-10-0cb9a39bdf5e&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>observations<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>If any of them was wrongly added just remove it using</strong> <em>Occultation.remove_observation()</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">remove_observation</span><span class="p">(</span><span class="s1">&#39;Outeniqua&#39;</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">remove_observation</span><span class="p">(</span><span class="s1">&#39;Hakos lc&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-11-9bd5f475e383&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>remove_observation<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Outeniqua&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> occ<span class="ansi-blue-fg">.</span>remove_observation<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;Hakos lc&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">observations</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-12-0cb9a39bdf5e&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>observations<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">add_observation</span><span class="p">(</span><span class="n">out</span><span class="p">,</span><span class="n">out_lc</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">add_observation</span><span class="p">(</span><span class="n">hak</span><span class="p">,</span><span class="n">hak_lc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-13-0a795c98a07e&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>add_observation<span class="ansi-blue-fg">(</span>out<span class="ansi-blue-fg">,</span>out_lc<span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> occ<span class="ansi-blue-fg">.</span>add_observation<span class="ansi-blue-fg">(</span>hak<span class="ansi-blue-fg">,</span>hak_lc<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<h3 id="section_2"><ol class="arabic" start="2">
<li><p>Converting from times to <span class="math notranslate nohighlight">\(\xi\)</span> and <span class="math notranslate nohighlight">\(\eta\)</span> in the sky plane</p>
</h3></li>
</ol>
<p>This step is done automatically without the user has to ask for it. The user can see its results using the python dictionary Occultation.positions that contains all positions for all observations added.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">positions</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-14-f89c0bb0c54c&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>positions

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>Any specif value can be obtained using the keys [Observer][LightCurve]</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="s1">&#39;Outeniqua&#39;</span><span class="p">][</span><span class="s1">&#39;Outeniqua lc&#39;</span><span class="p">][</span><span class="s1">&#39;immersion&#39;</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-15-e2304f6765fa&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>positions<span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;Outeniqua&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;Outeniqua lc&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;immersion&#39;</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">&#39;value&#39;</span><span class="ansi-blue-fg">]</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>The user can save these position</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">to_file</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-16-0dc83b03c799&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>to_file<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>Even thought it is not needed, the user can use it freely, just import the positionv function within the sora.occultation.</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sora.occultation</span> <span class="kn">import</span> <span class="n">positionv</span>

positionv<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">Signature:</span> positionv<span class="ansi-blue-fg">(</span>star<span class="ansi-blue-fg">,</span> ephem<span class="ansi-blue-fg">,</span> observer<span class="ansi-blue-fg">,</span> time<span class="ansi-blue-fg">)</span>
<span class="ansi-red-fg">Docstring:</span>
Calculates the position and velocity of the occultation shadow relative to the observer.

Parameters:
    star (Star): The coordinate of the star in the same reference frame as the ephemeris.
       It must be a Star object.
    ephem (Ephem): The object ephemeris. It must be an Ephemeris object.
    observer (Observer): The Observer information. It must be an Observer object.
    time (Time): Reference instant to calculate position and velocity.

Return:
    f, g (float): The orthographic projection of the shadow relative to the observer.
        f is in the x-axis (East-West direction; East positive)
        g is in the y-axis (North-South direction; North positive)
<span class="ansi-red-fg">File:</span>      ~/miniconda3/lib/python3.8/site-packages/sora/occultation.py
<span class="ansi-red-fg">Type:</span>      function

</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="n">vel_f</span><span class="p">,</span> <span class="n">vel_g</span> <span class="o">=</span> <span class="n">positionv</span><span class="p">(</span><span class="n">star_occ</span><span class="p">,</span><span class="n">ephem_occ</span><span class="p">,</span><span class="n">out</span><span class="p">,</span><span class="s1">&#39;2017-06-22 21:21:22.213&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;f:  </span><span class="si">{:+07.3f}</span><span class="s1"> km&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;g:  </span><span class="si">{:+07.3f}</span><span class="s1"> km&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vf: </span><span class="si">{:+07.3f}</span><span class="s1"> km/s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vel_f</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;vg: </span><span class="si">{:+07.3f}</span><span class="s1"> km/s&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">vel_g</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-18-ed937f053688&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>f<span class="ansi-blue-fg">,</span> g<span class="ansi-blue-fg">,</span> vel_f<span class="ansi-blue-fg">,</span> vel_g <span class="ansi-blue-fg">=</span> positionv<span class="ansi-blue-fg">(</span>star_occ<span class="ansi-blue-fg">,</span>ephem_occ<span class="ansi-blue-fg">,</span>out<span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">&#39;2017-06-22 21:21:22.213&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;f:  {:+07.3f} km&#39;</span><span class="ansi-blue-fg">.</span>format<span class="ansi-blue-fg">(</span>f<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;g:  {:+07.3f} km&#39;</span><span class="ansi-blue-fg">.</span>format<span class="ansi-blue-fg">(</span>g<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> print<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;vf: {:+07.3f} km/s&#39;</span><span class="ansi-blue-fg">.</span>format<span class="ansi-blue-fg">(</span>vel_f<span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;star_occ&#39; is not defined
</pre></div></div>
</div>
<h3 id="section_1"><ol class="arabic" start="3">
<li><p>Chords display and ellipse fit</p>
</h3></li>
</ol>
<p>The next step is the visualization of the chords in the sky plane and the fitting of an ellipse. The five parameters that describe the ellipse are:</p>
<p><strong>1.</strong> and <strong>2.</strong> The centre position (<span class="math notranslate nohighlight">\(f_0\)</span>, <span class="math notranslate nohighlight">\(g_0\)</span>)</p>
<p><strong>3.</strong> The apparent equatorial radius, semi-major axix (<span class="math notranslate nohighlight">\(a'\)</span>)</p>
<p><strong>4.</strong> The oblatness (<span class="math notranslate nohighlight">\(\epsilon' = \frac{a' - b'}{a'}\)</span>)</p>
<p><strong>5.</strong> The position angle of the pole, semi-minor axix (<span class="math notranslate nohighlight">\(P\)</span>)</p>
<p>The result of the fit is a ChiSquare Object, and its functions can be found at its specific Jupyter-Notebook.</p>
<p><strong>Let’s look at the chords</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">()</span>

<span class="c1">##################################################</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">+</span><span class="mi">170</span><span class="p">,</span><span class="o">-</span><span class="mi">170</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">170</span><span class="p">,</span><span class="o">+</span><span class="mi">170</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-19-93f7c80dd957&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>plot_chords<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-red-fg">##################################################</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> pl<span class="ansi-blue-fg">.</span>xlim<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">170</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">170</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> pl<span class="ansi-blue-fg">.</span>ylim<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">170</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">170</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>If there are know time shifts, this can be easily solved using</strong> <em>LightCurve.dt</em></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">out_lc</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.150</span>
<span class="n">ond_lc</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.190</span>
<span class="n">tiv_lc</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.150</span>
<span class="n">whc_c14_lc</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.375</span>
<span class="n">whc_d16_lc</span><span class="o">.</span><span class="n">dt</span> <span class="o">=</span> <span class="o">+</span><span class="mf">0.000</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">()</span>

<span class="c1">##################################################</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">+</span><span class="mi">170</span><span class="p">,</span><span class="o">-</span><span class="mi">170</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">170</span><span class="p">,</span><span class="o">+</span><span class="mi">170</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-21-93f7c80dd957&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>plot_chords<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> <span class="ansi-red-fg">##################################################</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> pl<span class="ansi-blue-fg">.</span>xlim<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">170</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">170</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span> pl<span class="ansi-blue-fg">.</span>ylim<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">170</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">170</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>Now, let’s fit the ellipse</strong></p>
<p>Here, there is only the manual method, the user should provide the parameters to the fit and also the region for searching each parameters.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span>occ.fit_ellipse<span class="o">?</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Object `occ.fit_ellipse` not found.
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ellipse_chi2</span>  <span class="o">=</span> <span class="n">occ</span><span class="o">.</span><span class="n">fit_ellipse</span><span class="p">(</span><span class="n">center_f</span><span class="o">=-</span><span class="mf">15.046</span><span class="p">,</span> <span class="n">center_g</span><span class="o">=-</span><span class="mf">2.495</span><span class="p">,</span> <span class="n">dcenter_f</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dcenter_g</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
                                <span class="n">equatorial_radius</span><span class="o">=</span><span class="mi">138</span><span class="p">,</span> <span class="n">dequatorial_radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">oblateness</span><span class="o">=</span><span class="mf">0.093</span><span class="p">,</span>
                                <span class="n">doblateness</span><span class="o">=</span><span class="mf">0.02</span><span class="p">,</span> <span class="n">position_angle</span><span class="o">=</span><span class="mi">126</span><span class="p">,</span> <span class="n">dposition_angle</span><span class="o">=</span><span class="mi">10</span> <span class="p">,</span><span class="n">loop</span><span class="o">=</span><span class="mi">100000</span><span class="p">,</span>
                                <span class="n">dchi_min</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span><span class="n">number_chi</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-23-d2f9f1f35f8d&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> ellipse_chi2  = occ.fit_ellipse(center_f=-15.046, center_g=-2.495, dcenter_f=3, dcenter_g=10,
</span><span class="ansi-green-intense-fg ansi-bold">      2</span>                                 equatorial_radius<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">138</span><span class="ansi-blue-fg">,</span> dequatorial_radius<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">,</span> oblateness<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.093</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span>                                 doblateness<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">0.02</span><span class="ansi-blue-fg">,</span> position_angle<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">126</span><span class="ansi-blue-fg">,</span> dposition_angle<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">10</span> <span class="ansi-blue-fg">,</span>loop<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">100000</span><span class="ansi-blue-fg">,</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span>                                 dchi_min=10,number_chi=10000)

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p>Note that here we only used 100000 loops, but it is recommended at least 10 millions for a good sample for each parameter.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[24]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">ellipse_chi2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-24-306406c30e3c&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>print<span class="ansi-blue-fg">(</span>ellipse_chi2<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;ellipse_chi2&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[25]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">ellipse_chi2</span><span class="o">.</span><span class="n">plot_chi2</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-25-6e9225d79f2d&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>ellipse_chi2<span class="ansi-blue-fg">.</span>plot_chi2<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;ellipse_chi2&#39; is not defined
</pre></div></div>
</div>
<p><strong>Now, besides the chords we can plot the fitted ellipse</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[26]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">from</span> <span class="nn">sora.extra</span> <span class="kn">import</span> <span class="n">draw_ellipse</span>

<span class="n">draw_ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">ellipse_chi2</span><span class="o">.</span><span class="n">get_values</span><span class="p">())</span>
<span class="n">occ</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">()</span>

<span class="c1">##################################################</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">+</span><span class="mi">170</span><span class="p">,</span><span class="o">-</span><span class="mi">170</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">170</span><span class="p">,</span><span class="o">+</span><span class="mi">170</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-26-79132fac21ff&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-intense-fg ansi-bold">      1</span> <span class="ansi-green-fg">from</span> sora<span class="ansi-blue-fg">.</span>extra <span class="ansi-green-fg">import</span> draw_ellipse
<span class="ansi-green-intense-fg ansi-bold">      2</span>
<span class="ansi-green-fg">----&gt; 3</span><span class="ansi-red-fg"> </span>draw_ellipse<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>ellipse_chi2<span class="ansi-blue-fg">.</span>get_values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> occ<span class="ansi-blue-fg">.</span>plot_chords<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>

<span class="ansi-red-fg">NameError</span>: name &#39;ellipse_chi2&#39; is not defined
</pre></div></div>
</div>
<p><strong>Not just the fitted ellipse, but the user can also plot all the ellipses inside an sigma region, for instance within :math:`3sigma`</strong></p>
<p>This step will, possible, plot large number of ellipses, this can spend some CPU time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[27]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">draw_ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">ellipse_chi2</span><span class="o">.</span><span class="n">get_values</span><span class="p">())</span>
<span class="n">draw_ellipse</span><span class="p">(</span><span class="o">**</span><span class="n">ellipse_chi2</span><span class="o">.</span><span class="n">get_values</span><span class="p">(</span><span class="n">sigma</span><span class="o">=</span><span class="mi">3</span><span class="p">))</span>

<span class="n">occ</span><span class="o">.</span><span class="n">plot_chords</span><span class="p">()</span>

<span class="c1">##################################################</span>
<span class="n">pl</span><span class="o">.</span><span class="n">xlim</span><span class="p">(</span><span class="o">+</span><span class="mi">170</span><span class="p">,</span><span class="o">-</span><span class="mi">170</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">170</span><span class="p">,</span><span class="o">+</span><span class="mi">170</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-27-c0b4bb6d1177&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>draw_ellipse<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>ellipse_chi2<span class="ansi-blue-fg">.</span>get_values<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span> draw_ellipse<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">**</span>ellipse_chi2<span class="ansi-blue-fg">.</span>get_values<span class="ansi-blue-fg">(</span>sigma<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">3</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span>
<span class="ansi-green-intense-fg ansi-bold">      4</span> occ<span class="ansi-blue-fg">.</span>plot_chords<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      5</span>

<span class="ansi-red-fg">NameError</span>: name &#39;ellipse_chi2&#39; is not defined
</pre></div></div>
</div>
<p><strong>The radial velocity issue</strong></p>
<p>During the LightCurve fitting, the user has to add the velocity for that light curve. In the initial process, only the geocentric velocity was determined, and only after the fit, a radial velocity can be correctly calculated.</p>
<p>Usually, the light curves’ features are dominated by the exposure time. However, in the cases that the fresnel diffraction plays a significant role in it, we suggest that the LightCurve fitting procedure should be redone with the correct velocities.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[28]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">check_velocities</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-28-2ef4468f0b08&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>check_velocities<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<h3 id="section_4"><ol class="arabic" start="4">
<li><p>Viewing and saving the results</p>
</h3></li>
</ol>
<p>In the end, we can see the results using Python dictionaries. The <em>Occultation.fitted_params</em> will have fitted parameters and their <span class="math notranslate nohighlight">\(1\sigma\)</span> uncertainties. The <em>Occultation.chi2_params</em> will have some information about the fit and its quality.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[29]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">fitted_params</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-29-88ef705870ab&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>fitted_params

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[30]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">chi2_params</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-30-7f4196fb5021&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>chi2_params

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>The astrometrical positions obtained can be seen using</strong> <em>Occultation.new_astrometric_position()</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[31]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">new_astrometric_position</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-31-eb4075ee92a0&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>new_astrometric_position<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>If the user wants the position at a specific time</strong></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[32]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">new_astrometric_position</span><span class="p">(</span><span class="s1">&#39;2017-06-22 21:21:00.000&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-32-a44c388b09df&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>new_astrometric_position<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;2017-06-22 21:21:00.000&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>Also a ‘post-fit’ occultation map can be created using</strong> <em>Occultation.plot_occ_map()</em></p>
<p>The fucntion that plots the map contains a large number of <em>kwargs</em>. They can be used to complete control the map and its tutorial can be found at SORA documentation add link</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[33]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">centermap_delta</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">3500</span><span class="p">,</span><span class="o">+</span><span class="mi">400</span><span class="p">],</span><span class="n">zoom</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span><span class="n">nameimg</span><span class="o">=</span><span class="s1">&#39;output/map_posfit&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-33-4827fca62cb1&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>plot_occ_map<span class="ansi-blue-fg">(</span>centermap_delta<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">[</span><span class="ansi-blue-fg">-</span><span class="ansi-cyan-fg">3500</span><span class="ansi-blue-fg">,</span><span class="ansi-blue-fg">+</span><span class="ansi-cyan-fg">400</span><span class="ansi-blue-fg">]</span><span class="ansi-blue-fg">,</span>zoom<span class="ansi-blue-fg">=</span><span class="ansi-cyan-fg">20</span><span class="ansi-blue-fg">,</span>nameimg<span class="ansi-blue-fg">=</span><span class="ansi-blue-fg">&#39;output/map_posfit&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><img alt="a4d1b12ecf8348339eacf4160354d050" src="../_images/map_posfit.png" /></p>
<p><strong>All this information can also be seen using</strong> <em>print(Occultation)</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[34]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="nb">print</span><span class="p">(</span><span class="n">occ</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-34-782a81f85486&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>print<span class="ansi-blue-fg">(</span>occ<span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>And this can be saved to an ASCII file using</strong> <em>Occultation.to_log</em></p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[35]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">occ</span><span class="o">.</span><span class="n">to_log</span><span class="p">(</span><span class="s1">&#39;output/Test_occ.log&#39;</span><span class="p">)</span>

<span class="o">!</span>ls output/*.log
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
<span class="ansi-red-fg">---------------------------------------------------------------------------</span>
<span class="ansi-red-fg">NameError</span>                                 Traceback (most recent call last)
<span class="ansi-green-fg">&lt;ipython-input-35-02e6c2f601d1&gt;</span> in <span class="ansi-cyan-fg">&lt;module&gt;</span>
<span class="ansi-green-fg">----&gt; 1</span><span class="ansi-red-fg"> </span>occ<span class="ansi-blue-fg">.</span>to_log<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;output/Test_occ.log&#39;</span><span class="ansi-blue-fg">)</span>
<span class="ansi-green-intense-fg ansi-bold">      2</span>
<span class="ansi-green-intense-fg ansi-bold">      3</span> get_ipython<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">)</span><span class="ansi-blue-fg">.</span>system<span class="ansi-blue-fg">(</span><span class="ansi-blue-fg">&#39;ls output/*.log&#39;</span><span class="ansi-blue-fg">)</span>

<span class="ansi-red-fg">NameError</span>: name &#39;occ&#39; is not defined
</pre></div></div>
</div>
<p><strong>This Jupyter-Notebook was designed as a tutorial for how to work with the Occultation Object Class. More information about the other classes, please refer to their specif Jupyter-Notebook. Any further question, please contact the core team: Altair Ramos Gomes Júnior, Bruno Eduardo Morgado, Gustavo Benedetti Rossi, and Rodrigo Carlos Boufleur.</strong></p>
<p><em>The End.</em></p>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="Tutorial_SORAv0.1_Prediction.html" class="btn btn-neutral float-right" title="prediction() and PredictionTable Object Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="Tutorial_SORAv0.1_Observer.html" class="btn btn-neutral float-left" title="Observer Object Class" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, SORA Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>