

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Modules &mdash; Stellar Occultation Reduction Analysis develop documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Input and Outputs" href="input_output.html" />
    <link rel="prev" title="The future and the LIneA TNO Portal" href="future_linea.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Stellar Occultation Reduction Analysis
          

          
          </a>

          
            
            
              <div class="version">
                0.2.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Manual:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="goals_updates.html">Goals and Version updates</a></li>
<li class="toctree-l1"><a class="reference internal" href="curiosities.html">Curiosities</a></li>
<li class="toctree-l1"><a class="reference internal" href="general.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="future_linea.html">The future and the LIneA TNO Portal</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#prediction-subsec-prediction">Prediction [SubSec:prediction]</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#kernels-and-ephemerids-subsec-kernels-bsp">Kernels and ephemerids [SubSec:Kernels_bsp]</a></li>
<li class="toctree-l3"><a class="reference internal" href="#spkid-object-code-subsec-spkid">SPKID (object code) [SubSec:spkid]</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#light-curve-fit-lc-fit-subsec-lc-fit">Light Curve fit - LC fit [SubSec:LC_fit]</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sky-projection-subsec-sky-projection">Sky Projection [SubSec:sky_projection]</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ellipse-fit-subsec-ellipse-fit">Ellipse Fit [SubSec:ellipse_fit]</a></li>
<li class="toctree-l2"><a class="reference internal" href="#major-features-to-be-implemented-on-future-upgrades">Major features to be implemented on future upgrades</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="input_output.html">Input and Outputs</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora_code.html">SORA Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora_code.html#python-hints-tips-and-tools-for-users-sec-python-hints">Python hints, tips and tools (for users) [Sec:Python_hints]</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.1_ChiSquare.html">ChiSquare Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.1_LightCurve.html">LightCurve Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.1_Observer.html">Observer Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.1_Occultation.html">Occultation Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.1_Prediction.html"><em>prediction()</em> and PredictionTable Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.1_Star.html">Star Class</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sora.html">Ephem</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#lightcurve">Lightcurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#module-sora.Observer">Observer</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#module-sora.Occultation">Occultation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#prediction">Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#module-sora.Star">Star</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#module-sora.Body">Body</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#extra">Extra</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Stellar Occultation Reduction Analysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Modules</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/modules.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="modules">
<span id="sec-modules"></span><h1>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h1>
<p>To perform the complete data reduction, pre- and post-occultation, we
have implemented the modules described below. Each of them have their
own set of input and output values (I/O). It is important to note that
those I/O can be the same for different modules or even some outputs
from a module will work as input for other, meaning that they are
integrated and has an inside communication. The modules are divided as
follows:</p>
<ul class="simple">
<li><p><strong>Implemented modules:</strong></p>
<ol class="arabic simple">
<li><p><strong>Prediction:</strong> Module to make the prediction of stellar
occultation. It uses the object ephemeris (plus its updates and
offsets) and a star catalogue to create prediction maps of the
candidate events. The maps present the object shadow path on Earth
and contain the occultation related information.</p></li>
<li><p><strong>Light Curve (LC fit):</strong> Module to determine the ingress and
egress instants from an observer data-set (the light curve). It
uses the light curve (with time and normalised relative flux
between the target star and one or more reference stars) to
calculate the instants that the object enters in front of the star
and leave (immersion and emersion instants, respectively).</p></li>
<li><p><strong>Sky Projection:</strong> Module to project each of the times obtained
with the module <em>LC fit</em> into positions (<span class="math notranslate nohighlight">\(f_i\)</span> and
<span class="math notranslate nohighlight">\(g_i\)</span>) in the sky plane for a Geocentric reference frame. It
uses the the times obtained in module <em>LC fit</em> and the occultation
information from module <em>Prediction</em>, added to observer
information, to convert the instants into positions in the sky
plane</p></li>
<li><p><strong>Ellipse fit:</strong> Module to fit an ellipse with given points. It
uses the projected positions in the sky plane (<span class="math notranslate nohighlight">\(f_i\)</span> and
<span class="math notranslate nohighlight">\(g_i\)</span>) obtained in module <em>Sky Projection</em> to fit the 5
parameters of one ellipse. (See specific section to know more
about it, e.g., what assumptions are made if less than 5 points
are available).</p></li>
</ol>
</li>
</ul>
<p>In the next chapters we present a description of each of the modules and
the algorithm and processes done in each part. Note that SORA is mostly
based in the processes and science from Bruno Sicardy’s programs, but it
is not a “literal translation” from fortran to python, i.e., SORA has
its own routines, features, and other approaches in the methods to
calculate the outputs.</p>
<div class="section" id="prediction-subsec-prediction">
<h2>Prediction [SubSec:prediction]<a class="headerlink" href="#prediction-subsec-prediction" title="Permalink to this headline">¶</a></h2>
<p>Module to make the prediction of stellar occultations. It uses the
object ephemerid (plus its updates and offsets) and a star catalogue
(Gaia-DR2) to calculate the occultation parameters and create the
prediction maps of the candidate events.</p>
<p>The ephemerid is calculated for a time interval provided by the user
using the ephemerid kernel (bsp files), or through a query to
Horizons/JPL. Those positions will be projected in the sky plane for
each instant given. The projected positions can also be calculated using
the equations given in Bruno’s Sicardy’s fortran code ephem_planete,
which uses a seconde degree polynom within 2 hours centered in the event
time.</p>
<p>The star information is obtained from Gaia DR2 and NOMAD catalogues
through a query to
<a class="reference external" href="http://vizier.u-strasbg.fr/viz-bin/VizieR">VizieR</a> database. The
outputs are the occultation parameters and the prediction maps, which
present the object shadow path on Earth and contain all the occultation
parameters (besides object information some of the parameters are:
occultation date, star RA and DEC, C/A, P/A, event relative velocity,
object distance in au, normalised magnitude).</p>
<p>This module can also import files and tables in PRAIA format and can
create output files in the user preference:</p>
<ul class="simple">
<li><p>tables in PRAIA format;</p></li>
<li><p>files to feed Occult Watcher;</p></li>
</ul>
<div class="section" id="kernels-and-ephemerids-subsec-kernels-bsp">
<h3>Kernels and ephemerids [SubSec:Kernels_bsp]<a class="headerlink" href="#kernels-and-ephemerids-subsec-kernels-bsp" title="Permalink to this headline">¶</a></h3>
<p>SORA can use the ephemerid file the user obtained from a query to
Horizons/JPL or can use the ephemerid kernels (bsp files). In this last
case, the user needs to have the files locally (i.e., in the same
environment: personal computer, online jupyter-notebook tool, etc.).</p>
<p>The BSP files from JPL can be found at:</p>
<ul>
<li><p>Planetary ephemedides:</p>
<p><a class="reference external" href="https://naif.jpl.nasa.gov/pub/naif/generic_kernels/spk/planets/">https://naif.jpl.nasa.gov/pub/naif/generic_kernels/spk/planets/</a></p>
</li>
<li><p>Satellite ephemerides:</p>
<p><a class="reference external" href="https://naif.jpl.nasa.gov/pub/naif/generic_kernels/spk/satellites/">https://naif.jpl.nasa.gov/pub/naif/generic_kernels/spk/satellites/</a></p>
</li>
</ul>
<p>It is important to read the “*.cmt” files to know which objects are
contained within the BSP file. The irregular satellites of Jupiter, for
example, are within JUP343, but the inner satellites are within JUP310.
Also, note that a higher number does not mean that it is the most up to
date to all satellites.</p>
<p>The BSP files from NIMA - Lucky Star (by Josselin Desmars) can be found
at:</p>
<ul>
<li><p>Planetary ephemerides (mostly minor bodies):</p>
<p><a class="reference external" href="https://lesia.obspm.fr/lucky-star/astrom.php">https://lesia.obspm.fr/lucky-star/astrom.php</a></p>
<p><a class="reference external" href="https://lesia.obspm.fr/lucky-star/nima.php">https://lesia.obspm.fr/lucky-star/nima.php</a></p>
</li>
<li><p>Phoebe (Saturn IX):</p>
<p><a class="reference external" href="http://josselin.desmars.free.fr/work/research/ph20/">http://josselin.desmars.free.fr/work/research/ph20/</a></p>
</li>
</ul>
<p>In those address, the user just need to select the object and in the
individual page, go to “Ephemeris &amp; Observations” section and find the
“bsp file”.</p>
<p>The BSP files from INPOP (IMCCE) can be found at:</p>
<ul>
<li><p>Planetary ephemerides:</p>
<p><a class="reference external" href="https://www.imcce.fr/recherche/equipes/asd/inpop/download19a">https://www.imcce.fr/recherche/equipes/asd/inpop/download19a</a></p>
</li>
<li><p>Satellite ephemerides:</p>
<p><a class="reference external" href="http://nsdb.imcce.fr/multisat/nssephmf.htm">http://nsdb.imcce.fr/multisat/nssephmf.htm</a></p>
</li>
</ul>
<p>Note that in the case of INPOP there is no BSP. The user will have to
generate the ephemeride file (using other tools) and then use it on SORA
(it is important to notice that “EphemPlanete” does not work for
prediction, only for occultation)</p>
<p>Other ephemerid files (such as NOE from Valéry Lenay) should be asked
directly to the author.</p>
</div>
<div class="section" id="spkid-object-code-subsec-spkid">
<h3>SPKID (object code) [SubSec:spkid]<a class="headerlink" href="#spkid-object-code-subsec-spkid" title="Permalink to this headline">¶</a></h3>
<p>In order to identify the object code (SPKID) for the minor bodies, the
user can search on the following address:
<a class="reference external" href="https://ssd.jpl.nasa.gov/sbdb.cgi">https://ssd.jpl.nasa.gov/sbdb.cgi</a> .</p>
<p>For planets and Pluto the SPKID is the order from the Sun *100 + 99.
Examples:</p>
<ul class="simple">
<li><p>Mercury = 199</p></li>
<li><p>Venus = 299</p></li>
<li><p>Earth = 399</p></li>
</ul>
<p>For the planet’s satellites the SPKID is the order of the planet from
the Sun *100 + the number of the object.</p>
<ul class="simple">
<li><p>Himalia (Jupiter VI) = 506</p></li>
<li><p>Phoebe (Saturn IX) = 609</p></li>
<li><p>Charon (Pluto I ) = 901</p></li>
</ul>
</div>
</div>
<div class="section" id="light-curve-fit-lc-fit-subsec-lc-fit">
<h2>Light Curve fit - LC fit [SubSec:LC_fit]<a class="headerlink" href="#light-curve-fit-lc-fit-subsec-lc-fit" title="Permalink to this headline">¶</a></h2>
<p>This module intends to determine the ingress and egress instants from an
observer data-set (the light curve). It uses the time (usually seconds
with respect to 00:00 UTC from the occultation day), and the normalised
relative flux between the target star (plus body) and one or more
reference stars, to calculate a square well model convoluted with the
effect of star diam (diffraction), Fresnel scale, and integration time.
If the flux given is not normalised or it has some trend (due to sky
variations, for example), the user can choose to normalise the light
curve with a polynomial function (using the function normalize). The
synthetic light curve is then compared with the observation to obtain
the instants that the object enters in front of the star and leave
(immersion and emersion instants, respectively). This is an automated
and updated software based on Bruno Sicardy’s program bar.f (and its
variations).</p>
<p>Before considering any effect, the program uses a simple square well
function to search for significant drops in the light curve. The user
can specify the number of drops the program will look for and then the
program will consider each drop separately to convolute with the effects
that can affect the light curve. In the version 0.1, only the most
significant drop in the light curve will be considered to create a
synthetic light curve.</p>
<p>The first effect to be considered in the synthetic light curve is the
Fresnel diffraction scale (or simply Fresnel scale). The light emitted
by a point source (assumed to be at the infinity to yield planar waves)
incident on a sharp-edged obstacle (such as a TNO) is diffracted. Owing
to the Huygens-Fresnel principle of wave propagation, each point of a
wave front may be considered as the center of a secondary disturbance
giving rise to spherical wavelets, which mutually interfere. If part of
the original wave front is blocked by an obstacle, the system of
secondary waves is incomplete, so that diffraction occurs. When observed
at a finite distance D from the obstacle, this effect is known as
“Fresnel diffraction”, and falls within the scope of the Kirchhoff
diffraction theory which remains valid as long as the dimensions of the
diffracting obstacles are large compared to the observed wavelength
<span class="math notranslate nohighlight">\(\lambda\)</span> and small compared to D <a href="#id6"><span class="problematic" id="id1">[2]_</span></a>. The characteristic scale
of the Fresnel diffraction effect is
<span class="math notranslate nohighlight">\(\sqrt{\frac{\lambda * D}{2}}\)</span> (where <span class="math notranslate nohighlight">\(\lambda\)</span> is the
wavelength of the observation, and <span class="math notranslate nohighlight">\(D\)</span> is the geocentric distance
of the object). The Fresnel scale at 40 AU, observed at
<span class="math notranslate nohighlight">\(\lambda = 0.4 \mu\)</span>m, is <span class="math notranslate nohighlight">\(\sim\)</span>1.1 km, so the
diffraction must be seriously taken into account to analyse the
occultations by TNOs.</p>
<p>In this routine, SORA calculates automatically the Fresnel scale for
wavelengths of 0.4 <span class="math notranslate nohighlight">\(microns\)</span> and 1.0 <span class="math notranslate nohighlight">\(microns\)</span>
(corresponding to 0.7 <span class="math notranslate nohighlight">\(\pm\)</span> 0.3 <span class="math notranslate nohighlight">\(microns\)</span>) – if the user do
not provide other values – to create two synthetic light curves, and
then get the average value for each point in the LC.</p>
<p>The second effect to be considered in the light curve is the star
angular diameter, which is the star size projected at the object
distance, as seen by an observer on Earth. This value is calculated on
nodule <strong>Sky Projection</strong>
(sec. <a class="reference external" href="#SubSec:sky_projection">[SubSec:sky_projection]</a>). In this
routine, for each observational point, we divide the star size (assumed
as an uniform sphere) in 24 fractions and check how much of it is
occulted by the object, here assumed to be a sphere.</p>
<p>The last effect involves the exposure time together with the event
velocity. The synthetic curve is created with a time resolution that is
proportional to 1/10 of the Fresnel scale divided by the event velocity,
calculated in the prediction. The final effect for each observational
point is then considering the average of the number of synthetic points
within the exposure time (not considering cycle or dead times).</p>
<p>The final synthetic light curve is the convolution of those three
effects and it is compared with the observational light curve using a
<span class="math notranslate nohighlight">\(\chi^2\)</span> minimisation method. The minimum <span class="math notranslate nohighlight">\(\chi^2\)</span> gives the
best fit for the immersion and emersion times, with their uncertainties.</p>
</div>
<div class="section" id="sky-projection-subsec-sky-projection">
<h2>Sky Projection [SubSec:sky_projection]<a class="headerlink" href="#sky-projection-subsec-sky-projection" title="Permalink to this headline">¶</a></h2>
<p>This module is an automated and updated software based on Bruno
Sicardy’s programs (positionv.f, ephem_planete.f, fit_d2_ksi_eta.f,
polyfit.f) and Julio Camargo’s gstar.f. It calculates the projected
position in the sky plane of the object limb relative to the star
position, considering the times of immersion and emersion obtained in
<em>LC fit</em>, and using the geocenter as reference frame.</p>
<p>This module is divided in many different small routines (created as
python objects: <a class="reference external" href="#item:routine:ephem">[item:routine:ephem]</a> – Ephem;
<a class="reference external" href="#item:routine:star_position">[item:routine:star_position]</a> – Star
position;
<a class="reference external" href="#item:routine:sky_projection">[item:routine:sky_projection]</a> – Sky
Projection; <a class="reference external" href="#item:routine:star_diam">[item:routine:star_diam]</a> –
Star Diam;</p>
<ol class="arabic">
<li><p><strong>Ephem</strong> [item:routine:ephem]</p>
<p>This routine generates geocentric positions for the object around the
event time. It also generates geocentric position for the Sun at the
event predicted time.</p>
</li>
<li><p><strong>Star position</strong> [item:routine:star_position]</p>
<p>This routine calculates the star position on the occultation date,
propagated from the catalogue epoch (e.g., epoch for GDR2 is 2015.5)
to the event epoch, considering star parameters such as proper motion
and parallax.</p>
</li>
<li><p><strong>Sky Projection</strong> [item:routine:sky_projection]</p>
<p>This routine uses the object ephemerid (all object positions -
RA,DEC), and project in the sky plane to obtain the positions
(<span class="math notranslate nohighlight">\(\xi, \eta\)</span>) using the equations below:</p>
<div class="math notranslate nohighlight">
\[\centering
    \label{Eq:xi_projected}
    \xi = -D*cos(\delta_{obj})*sin(\alpha_{obj}-\alpha_{star})\]</div>
<div class="math notranslate nohighlight">
\[\centering
    \label{Eq:eta_projected}
    \eta = -D*[sin(\delta_{obj}-\delta_{star}) + 2*cos(\delta_{obj})*sin(\delta_{star})*sin^2(
    \frac{\alpha_{obj}-\alpha_{star}}{2})\]</div>
<p>Then the routine will fit a second degree polonium to the apparent
path in the sky plane (<span class="math notranslate nohighlight">\(a \cdot x^2 + b \cdot x + c\)</span>) and give
the coefficients <span class="math notranslate nohighlight">\(a_\xi , b_\xi , c_\xi\)</span> and
<span class="math notranslate nohighlight">\(a_\eta , b_\eta ,c_\eta\)</span>.</p>
</li>
<li><p><strong>Star Diam</strong> [item:routine:star_diam]</p>
<p>This routine is intended to calculate diameter of the star projected
at object distance using three methods. Preferentially the star
diameter is calculated using Gaia-DR2 <a href="#id7"><span class="problematic" id="id2">[3]_</span></a> information (when
available). Also it uses the star magnitudes B, V, and K obtained
from NOMAD catalogue <a href="#id8"><span class="problematic" id="id3">[4]_</span></a> and equations from Van Belle (1999) <a href="#id9"><span class="problematic" id="id4">[5]_</span></a>
and Kervella et. al (2004) <a href="#id10"><span class="problematic" id="id5">[6]_</span></a>.</p>
<ol class="arabic">
<li><p>Van Belle (1999) [item:star_diam_vanBelle]</p>
<p>This method uses equations from van Belle (1999) – Publi. Astron.
Soc. Pacific 111, 1515-1523:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\centering
    \label{Eq:van_belle}
\begin{split}
    Diam_V = 10^{A_V + B_V*(V - K) -0.2*V} \\
    Diam_B = 10^{A_B + B_B*(B - K) -0.2*B}
\end{split}\end{split}\]</div>
<p>where B, V and K are the star magnitudes in those bands and</p>
<ul class="simple">
<li><p>For Super Giant star: <span class="math notranslate nohighlight">\(A_V\)</span>= 0.669 , <span class="math notranslate nohighlight">\(B_V\)</span>=
0.223, <span class="math notranslate nohighlight">\(A_B\)</span>= 0.648, <span class="math notranslate nohighlight">\(B_B\)</span>= 0.220</p></li>
<li><p>For Main Sequence star:<span class="math notranslate nohighlight">\(A_V\)</span>= 0.500 , <span class="math notranslate nohighlight">\(B_V\)</span>=
0.264, <span class="math notranslate nohighlight">\(A_B\)</span>= 0.500, <span class="math notranslate nohighlight">\(B_B\)</span>= 0.290</p></li>
<li><p>For Variable star:<span class="math notranslate nohighlight">\(A_V\)</span>= 0.789 , <span class="math notranslate nohighlight">\(B_V\)</span>= 0.218,
<span class="math notranslate nohighlight">\(A_B\)</span>= 0.840, <span class="math notranslate nohighlight">\(B_B\)</span>= 0.211</p></li>
</ul>
<p>The routine calculate the star diameter assuming a super giant to
overestimate the star size. This is because the size of the star
will be usually negligible compared to other effects (Fresnel
scale or exposure time). If the star size is big enough to get
some influence on the light curve, observation of the star and a
better determination of its size will be needed.</p>
</li>
<li><p>Kervella (2004) [item:star_diam_Kervella]</p>
<p>This method uses equations from Kervella et al. (2004) – A&amp;A Vol.
426, No. 1 to calculate the star diameter:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\centering
    \label{Eq:kervella}
\begin{split}
    Diam_V = 10^{0.0755*(V − K) + 0.5170 − 0.2*K} \\
    Diam_B = 10^{0.0535*(B − K) + 0.5159 − 0.2*K}
\end{split}\end{split}\]</div>
<p>where B, V and K are the star magnitudes in those bands.</p>
</li>
<li><p>Gaia (2018) [item:star_diam_Gaia]</p>
<p>This method uses information from the GDR2 catalogue. It will give
the star radius and distance (from parallax) and using the
effective temperature <span class="math notranslate nohighlight">\(T_{eff}\)</span> calculated using
<em>Apsis-Priam</em>, the Radius and Luminosity calculated using
<em>Apsis-Flame</em> (Refs: Andrae et al. A&amp;A 616, A8 (2018);
Bailer-Jones et al. A&amp;A 559 (2018); Bailer-Jones et al. AJ, V.
156, Issue 2, id. 58, 11pp (2018)) it gives de star diameter as:</p>
<div class="math notranslate nohighlight">
\[\centering
    \label{Eq:gaia}
    Diam = 2 * arctan \left(\frac{R_*}{2 D}\right)\]</div>
<p>where R<span class="math notranslate nohighlight">\(_*\)</span> is the star radius in solar radius and D the
object distance in km.</p>
</li>
</ol>
</li>
<li><p><strong>Positionv</strong> [item:routine:positionv]</p>
<p>This routine in this module is based on Bruno Sicardy’s program
positionv.f. It gives the projected position (in the sky plane) of
the instants for immersion and emersion for each observer. This
routine depends on the output from previous modules and also has a
strong dependence of a calculation for the sidereal time propagated
to the occultation day for each site.</p>
<p>It also depends on the geocentric position for each site, which in
turn, depends on the geoid model adopted. Note that the model adopted
is the WGS84, used by the GPS devices, which defines the position on
the Earht surface on ITRS. In SORA we use astropy, which already
takes into account the ITRS.</p>
</li>
</ol>
</div>
<div class="section" id="ellipse-fit-subsec-ellipse-fit">
<h2>Ellipse Fit [SubSec:ellipse_fit]<a class="headerlink" href="#ellipse-fit-subsec-ellipse-fit" title="Permalink to this headline">¶</a></h2>
<p>This module is an automated and updated module based on program
ellipse_fit.f, which is a program based on <em>Numerical Recipes</em> routines
to fit an ellipse with its 5 parameters on the data points (the
<span class="math notranslate nohighlight">\((\xi , \eta)_i\)</span> from the sky projection obtained from
positionv.f).</p>
<p>With the projections in the sky plane (<span class="math notranslate nohighlight">\(\xi , \eta\)</span>) for each
immersion and emersion time for each station (observer and light curve)
we can find the best apparent ellipse. To describe an ellipse we need
five parameters: (i) and (ii) the ellipse centre (<span class="math notranslate nohighlight">\(f_0,g_0\)</span>);
(iii) the apparent semi-major axis (<span class="math notranslate nohighlight">\(a'\)</span>); (iv) the apparent
oblatness <span class="math notranslate nohighlight">\(\left(\epsilon' = \dfrac{a' - b'}{a'}\right)\)</span>; and (v)
the position angle of the semi-minor axis (<span class="math notranslate nohighlight">\(P\)</span>).</p>
<p>With less than 5 points (2.5 chords), it is not possible to fit all the
parameters to find the best apparent ellipse. However, some
considerations can help us. For instance, if some information about the
object is known (equivalent radius from thermal measures or previous
occultations, consider the body as spherical, etc), one or more
parameters can be constrained.</p>
<p>With one chord is only possible to determine the ellipse centre if the
radius is known. Since solutions are degenerate (usually called “North”
and “South” solutions), the result will be the two solutions plus an
average solution. If nothing is known the chord can indicate a limit to
the object’s size.</p>
<p>For version v0.1 the user have to provide the parameters to the fit
(initial guesses and ranges), since no automatic procedure was
implemented. After providing the points, SORA will fit an ellipse and
compare the radial distance of each point to the ellipse using a
<span class="math notranslate nohighlight">\(\chi^2\)</span> method. This procedure is repeated for n-interactions
with the 5 parameters correlated and the minimum <span class="math notranslate nohighlight">\(\chi^2\)</span> will
determine the best solution.</p>
</div>
<div class="section" id="major-features-to-be-implemented-on-future-upgrades">
<span id="subsec-major-upgrades"></span><h2>Major features to be implemented on future upgrades<a class="headerlink" href="#major-features-to-be-implemented-on-future-upgrades" title="Permalink to this headline">¶</a></h2>
<p>Here we briefly present some of the intended modules to be implemented
in future versions of SORA: “body”, “rotation”, and “shape”.</p>
<p>The “body” will deal with the object characteristics. The “rotation”
will include features to work with rotational light curve and obtain
rotational periods. The “shape” is intended to work with how to obtain
the 3D shape (and its characteristics such as density) of an object
combining results from light curves, rotational period and occultation
data.</p>
<p>A module to deal with occultations by objects with atmosphere is also
planned, as well as the implementation of shortcuts for faster use and
the improvement of <span class="math notranslate nohighlight">\(\chi^2\)</span> functions and parallelisation of the
procedures.</p>
<p>Note that SORA is an open source code so any new feature can be easily
implemented and tested and there is room for various implementations.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="input_output.html" class="btn btn-neutral float-right" title="Input and Outputs" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="future_linea.html" class="btn btn-neutral float-left" title="The future and the LIneA TNO Portal" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, SORA Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>