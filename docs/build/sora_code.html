

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>SORA Code &mdash; Stellar Occultation Reduction Analysis develop documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="ChiSquare Object Class" href="examples/Tutorial_SORAv0.1_ChiSquare.html" />
    <link rel="prev" title="Input and Outputs" href="input_output.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Stellar Occultation Reduction Analysis
          

          
          </a>

          
            
            
              <div class="version">
                0.2.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Manual:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="goals_updates.html">Goals and Version updates</a></li>
<li class="toctree-l1"><a class="reference internal" href="curiosities.html">Curiosities</a></li>
<li class="toctree-l1"><a class="reference internal" href="general.html">General</a></li>
<li class="toctree-l1"><a class="reference internal" href="future_linea.html">The future and the LIneA TNO Portal</a></li>
<li class="toctree-l1"><a class="reference internal" href="modules.html">Modules</a></li>
<li class="toctree-l1"><a class="reference internal" href="input_output.html">Input and Outputs</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">SORA Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#python-package-requirements">Python package requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="#python-package-installation">Python package installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sora-installation">SORA installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#sora-update">SORA Update</a></li>
<li class="toctree-l2"><a class="reference internal" href="#object-classes">Object Classes</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-extra">Module: extra</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-observer">Module: observer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-star">Module: star</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-ephem">Module: ephem</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-lightcurve">Module: LightCurve</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-prediction">Module: prediction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-occ-fit">Module: occ_fit</a></li>
<li class="toctree-l3"><a class="reference internal" href="#map-documentation">Map documentation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#python-hints-tips-and-tools-for-users-sec-python-hints">Python hints, tips and tools (for users) [Sec:Python_hints]</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#reporting-a-bur-or-issue-subsec-tips-report-bug">Reporting a bur or issue [SubSec:tips_report_bug]</a></li>
<li class="toctree-l2"><a class="reference internal" href="#jupyter-notebooks-subsec-tips-jupyter-notebooks">Jupyter Notebooks [SubSec:tips_jupyter_notebooks]</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Tutorials:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.1_ChiSquare.html">ChiSquare Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.1_LightCurve.html">LightCurve Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.1_Observer.html">Observer Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.1_Occultation.html">Occultation Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.1_Prediction.html"><em>prediction()</em> and PredictionTable Object Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.1_Star.html">Star Class</a></li>
</ul>
<p class="caption"><span class="caption-text">Modules:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="sora.html">Ephem</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#lightcurve">Lightcurve</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#module-sora.Observer">Observer</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#module-sora.Occultation">Occultation</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#prediction">Prediction</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#module-sora.Star">Star</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#module-sora.Body">Body</a></li>
<li class="toctree-l1"><a class="reference internal" href="sora.html#extra">Extra</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Stellar Occultation Reduction Analysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>SORA Code</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/sora_code.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="sora-code">
<span id="subsec-code"></span><h1>SORA Code<a class="headerlink" href="#sora-code" title="Permalink to this headline">¶</a></h1>
<div class="section" id="python-package-requirements">
<span id="subsec-code-packages"></span><h2>Python package requirements<a class="headerlink" href="#python-package-requirements" title="Permalink to this headline">¶</a></h2>
<p>Here we present the packages that will be used as base for our coding.
Those packages are also installed on the .</p>
<ul class="simple">
<li><p>astropy 4.0: For astronomical related functions, mainly coordinates
and time.</p></li>
<li><p>astroquery 0.4.1: To query astronomical database as JPL and Vizier.</p></li>
<li><p>cartopy 0.17: Geospatial data processing to produce maps.</p></li>
<li><p>matplotlib 3.1.1: For easy and beautiful plots.</p></li>
<li><p>numpy 1.18.1: Otimized mathematical functions.</p></li>
<li><p>scipy 1.4.1: Otimized functions for mathematics, science, and
engineering.</p></li>
<li><p>spiceypy 3.0.2: SPICE/NAIF functions in python.</p></li>
</ul>
</div>
<div class="section" id="python-package-installation">
<span id="subsec-code-package-install"></span><h2>Python package installation<a class="headerlink" href="#python-package-installation" title="Permalink to this headline">¶</a></h2>
<p>Note that on LIneA docker all the packages will be installed and the
user do not need to worry about packages installation. You only need to
install if you want to use SORA in your personal computer.</p>
<p>The best way to install Python 3.7 is using anaconda:
<a class="reference external" href="https://www.anaconda.com/products/individual">https://www.anaconda.com/products/individual</a>. They have versions for
different Operational System (Windows, MacOS and Linux). After
installing Anaconda, to verify which packages and version you have
installed, open a terminal window (in Unix systems <a class="footnote-reference brackets" href="#id9" id="id1">7</a>) and type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user@path$&gt; conda list
</pre></div>
</div>
<p>or to search for a specific package:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user@path$&gt; conda list | grep &lt;package&gt;
</pre></div>
</div>
<p>As an example, to search for the scipy package:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user@path$&gt; conda list | grep scipy
</pre></div>
</div>
<p>In order to install a specific Python package, in a terminal window
type:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user@path$&gt; conda install &lt;package&gt;
</pre></div>
</div>
<p>or to install a specific version of the package:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user@path$&gt; conda install &lt;package&gt;=&lt;version&gt;
</pre></div>
</div>
<p>As an example, to install the scipy package version 1.4.1:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user@path$&gt; conda install scipy=1.4.1
</pre></div>
</div>
<p>If conda can not install a package, the user can try using <em>pip</em> instead
of <em>conda</em>, although it is recommended always using the <em>conda</em>.</p>
<p>For the specific case of SORA, the following commands should be executed
for installing all requirements <a class="footnote-reference brackets" href="#id10" id="id2">8</a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user@path$&gt;conda install astropy=4.0 cartopy=0.17 spiceypy=3.0 matplotlib scipy ipython jupyter
user@path$&gt; conda install -c conda-forge cartopy
user@path$&gt; pip install --pre astroquery
</pre></div>
</div>
</div>
<div class="section" id="sora-installation">
<span id="subsec-sora-install"></span><h2>SORA installation<a class="headerlink" href="#sora-installation" title="Permalink to this headline">¶</a></h2>
<p>After installing all the python packages (from the previous session), to
install SORA locally, you simply need to clone the git repository, and
then install the package:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>user@path$&gt; git clone https://github.com/riogroup/SORA/sora.git
user@path$&gt; cd sora
user@path$&gt; pip install .
</pre></div>
</div>
</div>
<div class="section" id="sora-update">
<span id="subsec-sora-update"></span><h2>SORA Update<a class="headerlink" href="#sora-update" title="Permalink to this headline">¶</a></h2>
<p>When new versions are available, the user can update it downloading the
last release from the SORA package in the riogroup organisation on
GitHub. If you want to be notified just follow the package.</p>
</div>
<div class="section" id="object-classes">
<span id="subsec-code-classes"></span><h2>Object Classes<a class="headerlink" href="#object-classes" title="Permalink to this headline">¶</a></h2>
<p>Here we present the structured object classes that SORA contains. In the
subsections we provide Jupyter-Notebooks containing the main functions
within each Object Class.</p>
<ul class="simple">
<li><p><strong>Ephem:</strong> Three Object Classes created to generate geocentric
ephemeris for a given solar system object. <strong>EphemJPL</strong> queries the
JPL Horizons service and download ephemeris information.
<strong>EphemKernel</strong> reads the BSP files to calculate the ephemeris using
the Spiceypy package. <strong>EphemPlanet</strong> reads an ASCII file with
previously determined positions and interpolate them for a given
instant.</p></li>
<li><p><strong>Star:</strong> Object Class created to deal with the star parameters. From
the Gaia-DR2 Source ID or a sky region, it queries the VizieR service
and downloads the star’s information. From Gaia DR2 Catalog (Gaia
Collaboration 2016a, 2016b and 2018) it gets the RA, DEC, parallax,
proper motions, G magnitude and star radius; from the NOMAD Catalog
(Zacharias et al. 2004) it gets the B, V, R, J, H and K magnitudes.
The user can calculate the ICRS coordinate of the star at any epoch.
It can be barycentric (corrected from proper motion) or geocentric
(corrected from proper motion and parallax). Also, the apparent
diameter of the star is calculated using Gaia DR2 information, or
some models such as Van Belle (1999) and Kervella et al. (2004).</p></li>
<li><p><strong>Observer:</strong> Object Class created to deal with the observer
location. The user can also download the ground-based observatories
from the Minor Planet Center (MPC) database.</p></li>
<li><p><strong>Lightcurve:</strong> Object Class that receives the observational light
curve (with time and the occulted star normalized photometry relative
to reference stars) and some observational parameters (filter and
exposure time). It has functions to determine the instants that the
solar system object enters in front of the star and leaves,
(immersion and emersion times, respectively). The model considers a
sharp-edge occultation model (geometric) convolved with Fresnel
diffraction, stellar diameter (projected at the body distance) and
finite integration time (Widemann et al., 2009; Sicardy et al.,
2011).</p></li>
<li><p><strong>Occultation:</strong> Main Object Class within SORA, created to analyze
stellar occultations, and control all the other Object Classes within
this package. Its functions allow converting the times for each
observatory in the occulted body positions in the sky plane relative
to the occulted star (<span class="math notranslate nohighlight">\(f\)</span>, <span class="math notranslate nohighlight">\(g\)</span>) (IERS Conventions). Also,
to obtain the best ellipse parameters (centre position, apparent
equatorial radius, oblateness and the position angle of the apparent
polar radius) that fit the points. The results are the apparent size,
shape and astrometrical position of the occulting body.</p></li>
<li><p><strong>PredictionTable:</strong> Using the <em>prediction()</em> function within SORA
results in an Object Class that is a slight modification of an
AstropyTable. The added changes allow to create the occultation map
for each prediction, convert into specific formats, such as
OccultWatcher and PRAIA (Assafin et al., 2011).</p></li>
<li><p><strong>ChiSquare:</strong> This Object Class is the result of the fitting
functions within SORA, for instance the <em>LightCurve.occ_lcfit()</em> and
<em>Occultation.fit_ellipse()</em>. This Class has functions that allow
viewing the values that minimize the <span class="math notranslate nohighlight">\(\chi^2\)</span> tests, the
uncertainties within <span class="math notranslate nohighlight">\(n-\sigma\)</span>, plotting the tests, and saving
the values.</p></li>
</ul>
<div class="section" id="module-extra">
<span id="subsubsec-code-classes-extra"></span><h3>Module: extra<a class="headerlink" href="#module-extra" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Set of independent functions that are used by <em>Observer</em> but do not
depend on it.</p>
<ul>
<li><p><strong>draw_ellipse()</strong> – Plots an ellipse given input parameters.</p>
<p><strong>INPUT</strong>: <em>equatorial_radius</em>: Semi-major axis of the ellipse.
<em>oblateness</em>: Oblateness of the ellipse. Default=0.0. <em>center_x</em>
and <em>center_y</em>: Coordinate of the ellipse (x,y respectively).
Default=0.0. <em>pos_angle</em>: Pole position angle. Default=0.0.
<em>**kwargs</em>: all other parameters will be parsed directly by
matplotlib.</p>
</li>
</ul>
</li>
<li><p><strong>ChiSquare</strong> – Object to handle <span class="math notranslate nohighlight">\(\chi^2\)</span>.</p>
<ul>
<li><p><strong>__init__()</strong> – Instantiate a ChiSquare object.</p>
<p><strong>INPUT</strong>: <em>chi2</em>: An array with with the values of chisquare.
<em>npts</em>: Number of points used in the fit. This is not the number
of attempts. <em>**kwargs</em>: Every new argument will be interpreted
as data. The name of the argument is the key to access values.
They must have the same size as chi2. At least one kwargs must be
given.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora.extra</span> <span class="kn">import</span> <span class="n">ChiSquare</span>

<span class="n">chi1</span> <span class="o">=</span> <span class="n">ChiSquare</span><span class="p">(</span><span class="n">chi2</span><span class="o">=</span><span class="n">chi_arr</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">immersion</span><span class="o">=</span><span class="n">immersion_arr</span><span class="p">,</span> <span class="n">emersion</span><span class="o">=</span><span class="n">emersion_arr</span><span class="p">)</span>
<span class="n">chi2</span> <span class="o">=</span> <span class="n">ChiSquare</span><span class="p">(</span><span class="n">chi2</span><span class="o">=</span><span class="n">chi_arr</span><span class="p">,</span> <span class="n">npts</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">many_values</span><span class="p">,</span> <span class="n">oblateness</span><span class="o">=</span><span class="n">other_many_values</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>get_nsigma()</strong> – get mean values and range within given sigma.</p>
<p><strong>INPUT</strong>: <em>sigma</em>: sigma to calculate range of values; <em>key</em>: if
no key is given, it calculates for every param. if given, it
calculates only for given param.</p>
<p><strong>OUTPUT</strong>: if no key is given, it returns a dictionary with the
valeus for all params. if key is given, it return an array with
the mean value and error bar.</p>
</li>
<li><p><strong>get_values()</strong> – Similar to get_nsigma, but it returns arrays
with all the values for each key</p>
<p><strong>INPUT</strong>: <em>sigma</em>: sigma to get range of values.</p>
</li>
<li><p><strong>plot_chi2()</strong> – plots param x chi2.</p>
<p><strong>INPUT</strong>: <em>key</em>: if key is given, it will only plot for this
parameter, otherwise, it will plot for every param.</p>
</li>
<li><p><strong>to_file()</strong> – Saves data in a file</p>
<p><strong>INPUT</strong>: <em>namefile</em>: Name of the file to save data. It will also
save another file named namefile.label stating what each column
is.</p>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="module-observer">
<span id="subsubsec-code-classes-occobs"></span><h3>Module: observer<a class="headerlink" href="#module-observer" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Set of independent functions that are used by <em>Observer</em> but do not
depend on it.</p>
<ul>
<li><p><strong>search_code_mpc()</strong> – Read page
<a class="reference external" href="https://www.minorplanetcenter.net/iau/lists/ObsCodes.html">https://www.minorplanetcenter.net/iau/lists/ObsCodes.html</a> which
contains all observers in the MPC, which is frequently updated. It
contains the IAU code, longitude, latitude, altitude, and name for
the sites.</p>
<p><strong>INPUT</strong>: None</p>
<p><strong>OUTPUT</strong>: python dictionary with information of all available
sites in the MPC database.</p>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora.observer</span> <span class="kn">import</span> <span class="n">search_code_mpc</span>

<span class="n">observatories</span> <span class="o">=</span> <span class="n">search_code_mpc</span><span class="p">()</span>
<span class="c1">#(out) Looking the MPC database ...</span>

<span class="nb">print</span><span class="p">(</span><span class="n">observatories</span><span class="p">)</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">{&#39;000&#39;: (&#39;Greenwich&#39;, &lt;EarthLocation (0.62411, 0., 0.77873) earthRad&gt;),</span>
<span class="sd"> &#39;001&#39;: (&#39;Crowborough&#39;, &lt;EarthLocation (0.62991772, 0.0016953, 0.77411) earthRad&gt;),</span>
<span class="sd"> ...</span>
<span class="sd"> &#39;Z99&#39;: (&#39;Clixby Observatory, Cleethorpes&#39;, &lt;EarthLocation (0.59546796, -0.00022095, 0.800687) earthRad&gt;)}</span>
<span class="sd"> &quot;&quot;&quot;</span>
</pre></div>
</div>
</li>
<li><p><strong>Observer</strong></p>
<ul>
<li><p><strong>__init__()</strong> - instantiate the observer object.</p>
<p><strong>INPUT</strong>: IAU code to search for the sites in the MPC database or
name, latitude, longitude and altitude;</p>
<p><strong>OUTPUT</strong> Site name, longitude, latitude and altitude.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">Observer</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s1">&#39;874&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">obs</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
<span class="c1"># &#39;Observatorio do Pico dos Dias, Itajuba&#39;</span>

<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">EarthLocation</span>
<span class="n">site</span> <span class="o">=</span> <span class="n">EarthLocation</span><span class="p">(</span><span class="s1">&#39;-45 34 57&#39;</span><span class="p">,</span> <span class="s1">&#39; -22 32 04&#39;</span><span class="p">,</span> <span class="mi">1864</span><span class="p">)</span>
<span class="n">lna</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;OPD&#39;</span><span class="p">,</span> <span class="n">site</span><span class="o">=</span><span class="n">site</span><span class="p">)</span>

<span class="n">lna</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;OPD&#39;</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="s1">&#39;-45 34 57&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;-22 32 04&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1864</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">lna</span><span class="p">)</span>
<span class="c1">#Site: OPD</span>
<span class="c1">#Geodetic coordinates: Lon: -45d34m57s, Lat: -22d32m04s, height: 1.864 km</span>
</pre></div>
</div>
</li>
<li><p><strong>sidereal_time()</strong> - Calculates the sidereal time for the time
and local given.</p>
<p><strong>INPUT</strong>: <em>time</em>: an Astropy.time object; <em>mode</em>: location to
calculate the sidereal time that can be ’greenwich’ or ’local’
(apparent for the site location – default).</p>
<p><strong>OUTPUT</strong>: sidereal time for the local chosen in <em>mode</em>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">Observer</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>

<span class="n">obs</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s1">&#39;874&#39;</span><span class="p">)</span>
<span class="n">obs</span><span class="o">.</span><span class="n">sidereal_time</span><span class="p">(</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">,</span> <span class="s1">&#39;local&#39;</span><span class="p">)</span>
<span class="c1"># 17h53m05.8251s</span>
<span class="n">obs</span><span class="o">.</span><span class="n">sidereal_time</span><span class="p">(</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">,</span> <span class="s1">&#39;greenwich&#39;</span><span class="p">)</span>
<span class="c1"># 20h55m25.6251s</span>
</pre></div>
</div>
</li>
<li><p><strong>get_ksi_eta()</strong> - Calculates the <span class="math notranslate nohighlight">\(\xi\)</span> and <span class="math notranslate nohighlight">\(\eta\)</span>
from input time and projected at the direction of star.</p>
<p><strong>INPUT</strong>: <em>time</em>: an Astropy.time object or string in the ISO
format; <em>star</em>: The coordinate of the star in the same frame as
the ephemeris. It can be a string in the format “hh mm ss.s +dd mm
ss.ss” or an astropy SkyCoord object.</p>
<p><strong>OUTPUT</strong>: <span class="math notranslate nohighlight">\(\xi\)</span>, <span class="math notranslate nohighlight">\(\eta\)</span>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">Observer</span>

<span class="n">casleo</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="s1">&#39;Casleo&#39;</span><span class="p">,</span> <span class="s1">&#39;-69 17 44.9&#39;</span><span class="p">,</span> <span class="s1">&#39;-31 47 55.6&#39;</span><span class="p">,</span> <span class="mi">2492</span><span class="p">)</span>
<span class="n">casleo</span><span class="o">.</span><span class="n">get_ksi_eta</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">,</span> <span class="n">star</span><span class="o">=</span><span class="s1">&#39;19 21 18.63201 -21 44 25.3924&#39;</span><span class="p">)</span>
<span class="c1"># -3911.0928016639878 -1705.5362129689515</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
<p>Disclosure: Once an Observer is set, no other Observer object with the
same name can be set again until the first is deleted; After an Observer
is set, the user can correct any value directly to the Observer
attribute, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">Observer</span>

<span class="n">lna</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;OPD&#39;</span><span class="p">,</span> <span class="n">lon</span><span class="o">=</span><span class="s1">&#39;45 34 57&#39;</span><span class="p">,</span> <span class="n">lat</span><span class="o">=</span><span class="s1">&#39;-22 32 04&#39;</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">1864</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lna</span><span class="p">)</span>
<span class="c1">#Site: OPD</span>
<span class="c1">#Geodetic coordinates: Lon: 45d34m57s, Lat: -22d32m04s, height: 1.864 km</span>

<span class="n">lna</span><span class="o">.</span><span class="n">lon</span> <span class="o">=</span> <span class="s1">&#39;-45 34 57&#39;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">lna</span><span class="p">)</span>
<span class="c1">#Site: OPD</span>
<span class="c1">#Geodetic coordinates: Lon: -45d34m57s, Lat: -22d32m04s, height: 1.864 km</span>
</pre></div>
</div>
</div>
<div class="section" id="module-star">
<span id="subsubsec-code-classes-star"></span><h3>Module: star<a class="headerlink" href="#module-star" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Set of independent functions that are used by <em>Star</em> but do not
depend on it.</p>
<ul>
<li><p><strong>search_star()</strong> – Search for stars on the Vizier catalogues:</p>
<p><strong>INPUT</strong>: code of the star or coord and radius for search, the
name of the columns to download, the catalogue from where to
download.</p>
<p><strong>OUTPUT</strong>: Astropy table with all the stars.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora.star</span> <span class="kn">import</span> <span class="n">search_star</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Source&#39;</span><span class="p">,</span> <span class="s1">&#39;RA_ICRS&#39;</span><span class="p">,</span> <span class="s1">&#39;e_RA_ICRS&#39;</span><span class="p">,</span> <span class="s1">&#39;DE_ICRS&#39;</span><span class="p">,</span> <span class="s1">&#39;e_DE_ICRS&#39;</span><span class="p">,</span> <span class="s1">&#39;Plx&#39;</span><span class="p">,</span> <span class="s1">&#39;pmRA&#39;</span><span class="p">,</span> <span class="s1">&#39;e_pmRA&#39;</span><span class="p">,</span> <span class="s1">&#39;pmDE&#39;</span><span class="p">,</span> <span class="s1">&#39;e_pmDE&#39;</span><span class="p">,</span> <span class="s1">&#39;Gmag&#39;</span><span class="p">,</span> <span class="s1">&#39;e_Gmag&#39;</span><span class="p">,</span> <span class="s1">&#39;Dup&#39;</span><span class="p">,</span> <span class="s1">&#39;Epoch&#39;</span><span class="p">,</span> <span class="s1">&#39;Rad&#39;</span><span class="p">]</span>
<span class="n">cat</span> <span class="o">=</span> <span class="n">search_star</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s2">&quot;4117746607441803776&quot;</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="s1">&#39;I/345/gaia2&#39;</span><span class="p">)</span>
<span class="n">cat2</span> <span class="o">=</span> <span class="n">search_star</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="s1">&#39;19 21 18.63201 -21 44 25.3924&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">arcsec</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="s1">&#39;I/345/gaia2&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">cat2</span><span class="p">)</span>
<span class="c1">#TableList with 1 tables:</span>
<span class="c1">#   &#39;0:I/345/gaia2&#39; with 15 column(s) and 1 row(s)</span>
<span class="c1">#       Source           RA_ICRS     e_RA_ICRS ... Dup Epoch   Rad</span>
<span class="c1">#                          deg          mas    ...       yr    Rsun</span>
<span class="c1">#------------------- --------------- --------- ... --- ------ ------</span>
<span class="c1">#6772694935064300416 290.32764199494    0.0385 ...   0 2015.5   1.10</span>
</pre></div>
</div>
</li>
<li><p><strong>van_belle()</strong> – Calculates the star diameter in mas using the
equations from van Belle (1999).</p>
<p><strong>INPUT</strong>: magB, magV, magK.</p>
<p><strong>OUTPUT</strong>: python dictionary with diameter for all magnitudes and
star types.</p>
</li>
<li><p><strong>kervella()</strong> – Calculates the star diameter in mas using the
equations from Kervella (2004).</p>
<p><strong>INPUT</strong>: magB, magV, magK.</p>
<p><strong>OUTPUT</strong>: python dictionary with diameter for all magnitudes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora.star</span> <span class="kn">import</span> <span class="n">van_belle</span><span class="p">,</span> <span class="n">kervella</span>
<span class="n">van_belle</span><span class="p">(</span><span class="n">magB</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">magV</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">magK</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c1">#{&#39;sg&#39;: {&#39;B&#39;: &lt;Quantity 0.01614359 mas&gt;, &#39;V&#39;: &lt;Quantity 0.01761976 mas&gt;},</span>
<span class="c1"># &#39;ms&#39;: {&#39;B&#39;: &lt;Quantity 0.00831764 mas&gt;, &#39;V&#39;: &lt;Quantity 0.01086426 mas&gt;},</span>
<span class="c1"># &#39;vs&#39;: {&#39;B&#39;: &lt;Quantity 0.02254239 mas&gt;, &#39;V&#39;: &lt;Quantity 0.02685344 mas&gt;}}</span>
<span class="n">kervella</span><span class="p">(</span><span class="n">magB</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">magV</span><span class="o">=</span><span class="mi">11</span><span class="p">,</span> <span class="n">magK</span><span class="o">=</span><span class="mi">12</span><span class="p">)</span>
<span class="c1">#{&#39;V&#39;: &lt;Quantity 0.01100272 mas&gt;, &#39;B&#39;: &lt;Quantity 0.01020704 mas&gt;}</span>
</pre></div>
</div>
</li>
</ul>
</li>
<li><p><strong>Star</strong></p>
<ul>
<li><p><strong>__init__()</strong> – instantiate the star object.</p>
<p><strong>INPUT</strong>: gaia code (Source) or coordinate. It will update the
coordinate from Gaia and read the magnitudes from NOMAD.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">Star</span>

<span class="n">star</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">code</span><span class="o">=</span><span class="s1">&#39;4117746607441803776&#39;</span><span class="p">)</span> <span class="c1"># Gaia-DR2 Source code</span>
<span class="n">star2</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="s1">&#39;19 21 18.63201 -21 44 25.3924&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">star2</span><span class="p">)</span>
<span class="c1">#ICRS star coordinate at J2015.5: RA=19h21m18.63408s +/- 0.0385 mas, DEC=-21d44m25.3767s +/- #0.0364 mas</span>
<span class="c1">#Gaia-DR2 star Source ID: 6772694935064300416</span>
<span class="c1">#Magnitudes: G: 15.292, B: 14.380, V: 14.870, R: 15.150, J: 14.119, H: 13.783, K: 13.685</span>
<span class="c1">#Diameter: 0.0081 mas, Source: Gaia-DR2</span>
</pre></div>
</div>
</li>
<li><p><strong>__searchgaia()</strong> – hidden function that searchs for the star in
the Gaia catalogue and saves the information. It is called once in
the __init__(). If the star radius is not found it gives a
warning.</p></li>
<li><p><strong>__getcolors()</strong> – hidden function that searchs for the star in
the NOMAD catalogue and saves the magnitudes. If some band is not
found, it gives a warning.</p></li>
<li><p><strong>set_magnitude()</strong> – Set the magnitudes of a star in any band as
given by the user. It saves the magnitude in a python dictionary.</p>
<p><strong>INPUT</strong>: any ‘band=value‘, see example below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">star</span><span class="o">.</span><span class="n">set_magnitude</span><span class="p">(</span><span class="n">G</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="c1"># UserWarning: G mag already defined. G=15.292 will be replaced by G=10</span>
<span class="n">star</span><span class="o">.</span><span class="n">set_magnitude</span><span class="p">(</span><span class="n">X</span><span class="o">=</span><span class="mf">25.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">star</span><span class="o">.</span><span class="n">mag</span><span class="p">)</span>
<span class="c1">#{&#39;G&#39;: 10, &#39;X&#39;: 25.0}</span>
</pre></div>
</div>
</li>
<li><p><strong>set_diameter()</strong> – Set the user diameter of the star in mas
which has higher priority than other diameters.</p></li>
<li><p><strong>van_belle()</strong> – call van_belle function passing the star
magnitudes.</p></li>
<li><p><strong>kervella()</strong> – call kervella function passing the star
magnitudes.</p></li>
<li><p><strong>apparent_diameter()</strong> – calculate the apparent diameter of the
star given a distance furnish by the user.</p>
<p><strong>INPUT</strong>: distance to calculate apparent radius (required); mode,
the function to calculate, where it can be ‘<em>user</em>’, ‘<em>gaia</em>’,
‘<em>kervella</em>’, ‘<em>van_belle</em>’ or ‘<em>auto</em>’, where ‘<em>auto</em>’ will run
all the functions in this order until it is able to obtain a
value. Default mode=‘<em>auto</em>’. In case mode=‘<em>kervella</em>’, the user
must give parameter obs_filter that can be ‘B’ or ‘V’. In case
mode=‘<em>van_belle</em>’, the user must give parameters obs_type and
star_type, that can be ‘<em>sg</em>’ (super giant), ‘<em>ms</em>’ (main
sequence) or ‘<em>vs</em>’ (variable star).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">star</span><span class="o">.</span><span class="n">apparent_diameter</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="c1">#Apparent diameter using Gaia</span>
<span class="c1">#1.287568km</span>

<span class="n">star</span><span class="o">.</span><span class="n">apparent_diameter</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;kervella&#39;</span><span class="p">,</span> <span class="n">obs_filter</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">)</span>
<span class="c1">#Apparent diameter using Kervella et al. (2004)</span>
<span class="c1">#0.86978164km</span>

<span class="n">star</span><span class="o">.</span><span class="n">apparent_diameter</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;van_belle&#39;</span><span class="p">,</span> <span class="n">obs_filter</span><span class="o">=</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="n">star_type</span><span class="o">=</span><span class="s1">&#39;ms&#39;</span><span class="p">)</span>
<span class="c1">#Apparent diameter using van Belle (1999)</span>
<span class="c1">#0.75472762km</span>
</pre></div>
</div>
</li>
<li><p><strong>barycentric()</strong> – returns the position of the star corrected
from proper motion in the ICRS.</p>
<p><strong>INPUT</strong>: <em>time</em>: Instant of observation.</p>
<p><strong>OUTPUT</strong>: Astropy SkyCoord Object in the barycentric reference
corrected from proper motion.</p>
</li>
<li><p><strong>geocentric()</strong> – returns the position of the star corrected from
proper motion and parallax in the GCRS.</p>
<p><strong>INPUT</strong>: <em>time</em>: Instant of observation.</p>
<p><strong>OUTPUT</strong>: Astropy SkyCoord Object in the geocentric reference
corrected from proper motion and parallax.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">star</span><span class="o">.</span><span class="n">geocentric</span><span class="p">(</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="s1">&#39;hmsdms&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># 19h21m18.63201s -21d44m25.39241s</span>
<span class="n">star</span><span class="o">.</span><span class="n">barycentric</span><span class="p">(</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">to_string</span><span class="p">(</span><span class="s1">&#39;hmsdms&#39;</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="c1"># 19h21m18.63198s -21d44m25.39247s</span>
</pre></div>
</div>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="module-ephem">
<span id="subsubsec-code-classes-ephem"></span><h3>Module: ephem<a class="headerlink" href="#module-ephem" title="Permalink to this headline">¶</a></h3>
<p>In the file ‘<strong>ephem.py</strong>’, there are four classes:
‘<em>EphemPlanete</em>‘, ‘<em>EphemKernel</em>‘, ‘<em>EphemJPL</em>‘ and
‘<em>Ephemeris</em>‘. The first, ‘EphemPlanete‘ emulates what’s done by the
ephem_planete and fit_d2_ksi_eta fortran codes. The second ‘EphemKernel‘
makes use of spiceypy package (python wrapper of SPICE C functions) to
calculate the ephemeris. ‘EphemJPL‘ queries the JPL Horizons website for
the ephemeris desired. The last one, ‘Ephemeris’ class would be used as
controller. If a text file is given, it points to EphemPlanete,
otherwise if it is given <em>bsp</em> files, it points to other classes, and so
on. For now, it only points to ‘EphemPlanete‘.</p>
<ul>
<li><p>Set of independent functions that are used by <em>Ephemeris</em> objects but
do not depend on it.</p>
<ul class="simple">
<li><p><strong>read_obj_data()</strong> – reads data table from
<a class="reference external" href="http://devel2.linea.gov.br/~altair.gomes/radius.txt">http://devel2.linea.gov.br/~altair.gomes/radius.txt</a> with the
radius and ephem error for selected objects.</p></li>
</ul>
</li>
<li><p><strong>EphemPlanete</strong> – Class that controls the ephemeris simulating the
fortran program ephem_planete</p>
<ul>
<li><p><strong>__init__()</strong> – reads the file with the ephemeris, saves the
coordinates and time.</p>
<p><strong>INPUT</strong>: the name of the object and the name of the file with
the ephemeris. The file must have JD, RA and DEC in degrees, and
object geocentric distance in AU.</p>
</li>
<li><p><strong>fit_d2_ksi_eta()</strong> – calculates the on-sky difference between
star and ephemeris (<span class="math notranslate nohighlight">\(\xi,\eta\)</span>) and fits a two degree
function.</p>
<p><strong>INPUT</strong>: an Astropy SkyCoord object.</p>
</li>
<li><p><strong>get_ksi_eta()</strong> – returns the calculated <span class="math notranslate nohighlight">\(\xi\)</span> and
<span class="math notranslate nohighlight">\(\eta\)</span> from input time, the star coordinate can be passed as
well to skip the call of fit_d2_ksi_eta().</p>
<p><strong>INPUT</strong>: time (necessary), star coordinate (not necessary).</p>
<p><strong>OUTPUT</strong>: pair of ksi and eta. If the input time is an array,
two arrays for ksi and eta will be returned.</p>
</li>
</ul>
</li>
</ul>
<p>Example of how to use EphemPlanete</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">EphemPlanete</span>

<span class="n">ephem</span> <span class="o">=</span> <span class="n">EphemPlanete</span><span class="p">(</span><span class="s1">&#39;Phoebe&#39;</span><span class="p">,</span> <span class="s1">&#39;ephem_phoebe_ph15.txt&#39;</span><span class="p">)</span>

<span class="n">ephem</span><span class="o">.</span><span class="n">fit_d2_ksi_eta</span><span class="p">(</span><span class="n">star</span><span class="o">=</span><span class="s1">&#39;19 21 18.63201 -21 44 25.3924&#39;</span><span class="p">)</span>
<span class="c1">#Fitting ephemeris position relative to star coordinate 19h21m18.632s -21d44m25.3924s</span>
<span class="c1">#ksi = aksi*t2 + bksi*t + cksi</span>
<span class="c1">#eta = aeta*t2 + beta*t + ceta</span>
<span class="c1">#t=(jd-2458641.62083333)/(2458641.70416667-2458641.62083333)</span>
<span class="c1">#        aksi=74.33578049015848</span>
<span class="c1">#        bksi=120036.66960513973</span>
<span class="c1">#        cksi=-56728.3072442839</span>
<span class="c1">#        aeta=11.57934951952548</span>
<span class="c1">#        beta=17144.759007406785</span>
<span class="c1">#        ceta=-6972.117976312244</span>
<span class="c1">#Residual RMS: ksi=0.004 km, eta=0.001 km</span>

<span class="n">ephem</span><span class="o">.</span><span class="n">get_ksi_eta</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">Time</span><span class="p">(</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">))</span>
<span class="c1"># 3685.627507205092 1657.0083431480398</span>

<span class="nb">print</span><span class="p">(</span><span class="n">ephem</span><span class="p">)</span>
<span class="c1">#Ephemeris of Phoebe.</span>
<span class="c1">#Valid from 2019-06-07 02:54:00.000 until 2019-06-07 04:54:00.000</span>
</pre></div>
</div>
<ul>
<li><p><strong>EphemKernel</strong> – Class that controls the ephemeris given BSP
kernels.</p>
<ul>
<li><p><strong>__init__()</strong> – reads the BSP files given</p>
<p><strong>INPUT</strong>: <em>name</em>: the name of the object; <em>code</em>: the code in the
kernel of the target; <em>kernels</em>: the list of kernels. The list of
kernels must be in the order of SPICE reading, with the last one
having highest priority. For instance, if the same path is present
in two given kernels, the last one will be used.</p>
</li>
<li><p><strong>get_position()</strong> – Calculates and return the geocentric position
of the target for the given time.</p>
<p><strong>INPUT</strong>: time (necessary).</p>
<p><strong>OUTPUT</strong>: Astropy SkyCoord Object with the geocentric coordinate
of the object for the given times.</p>
</li>
<li><p><strong>get_ksi_eta()</strong> – returns the calculated <span class="math notranslate nohighlight">\(\xi\)</span> and
<span class="math notranslate nohighlight">\(\eta\)</span> from input time, the star coordinate can be passed as
well to skip the call of fit_d2_ksi_eta().</p>
<p><strong>INPUT</strong>: time (necessary), star coordinate (not necessary).</p>
<p><strong>OUTPUT</strong>: pair of <span class="math notranslate nohighlight">\(\xi\)</span> and <span class="math notranslate nohighlight">\(\eta\)</span>. If the input
time is an array, two arrays for <span class="math notranslate nohighlight">\(\xi\)</span> and <span class="math notranslate nohighlight">\(\eta\)</span> will
be returned.</p>
</li>
<li><p><strong>get_pole_position_angle()</strong> – Calculates and return the position
and the aperture angle of the target’s pole for the given time.</p>
<p><strong>INPUT</strong>: pole: Pole coordinate (necessary); time: (necessary).</p>
<p><strong>OUTPUT</strong>: position angle of the pole in degrees; aperture angle
in degrees.</p>
</li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">EphemKernel</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>

<span class="n">ephe2</span> <span class="o">=</span> <span class="n">EphemKernel</span><span class="p">(</span><span class="s1">&#39;Phoebe&#39;</span><span class="p">,</span> <span class="mi">609</span><span class="p">,</span> <span class="n">kernels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;path/ph15.bsp&#39;</span><span class="p">,</span> <span class="s1">&#39;path/de438.bsp&#39;</span><span class="p">])</span>

<span class="n">ephe2</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">)</span>

<span class="n">ksi</span><span class="p">,</span> <span class="n">eta</span> <span class="o">=</span> <span class="n">ephe2</span><span class="o">.</span><span class="n">get_ksi_eta</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">,</span> <span class="n">star</span><span class="o">=</span><span class="s1">&#39;19 21 18.63201 -21 44 25.3924&#39;</span><span class="p">)</span>

<span class="n">ephe2</span><span class="o">.</span><span class="n">get_pole_position_angle</span><span class="p">(</span><span class="n">pole</span><span class="o">=</span><span class="s1">&#39;10 05 12.000 +41 28 48.000&#39;</span><span class="p">,</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2019-08-08 21:41&#39;</span><span class="p">)</span>
</pre></div>
</div>
<ul>
<li><p><strong>EphemJPL</strong> – Class that controls the ephemeris querying in the JPL
Horizons website.</p>
<ul>
<li><p><strong>__init__()</strong> – query the JPL Horizons website</p>
<p><strong>INPUT</strong>: <em>name</em>: the name of the object to search. <em>id_type</em>:
the type of the name. For instance searching for ’Europa’, if the
id_type is ’smallbody’ it will search for the asteroid 52 Europa,
if the id_type is ’majorbody’ it will search for the Galilean
satellite Europa. Default: ’majorbody’</p>
</li>
<li><p><strong>get_position()</strong> – Calculates and return the geocentric position
of the target for the given time.</p>
<p><strong>INPUT</strong>: time (necessary).</p>
<p><strong>OUTPUT</strong>: Astropy SkyCoord Object with the geocentric coordinate
of the object for the given times.</p>
</li>
<li><p><strong>get_ksi_eta()</strong> – returns the calculated <span class="math notranslate nohighlight">\(\xi\)</span> and
<span class="math notranslate nohighlight">\(\eta\)</span> from input time, the star coordinate can be passed as
well to skip the call of fit_d2_ksi_eta().</p>
<p><strong>INPUT</strong>: time (necessary), star coordinate (not necessary).</p>
<p><strong>OUTPUT</strong>: pair of <span class="math notranslate nohighlight">\(\xi\)</span> and <span class="math notranslate nohighlight">\(\eta\)</span>. If the input
time is an array, two arrays for <span class="math notranslate nohighlight">\(\xi\)</span> and <span class="math notranslate nohighlight">\(\eta\)</span> will
be returned.</p>
</li>
<li><p><strong>get_pole_position_angle()</strong> – Calculates and return the position
and the aperture angle of the target’s pole for the given time.</p>
<p><strong>INPUT</strong>: pole: Pole coordinate (necessary); time: (necessary).</p>
<p><strong>OUTPUT</strong>: position angle of the pole in degrees; aperture angle
in degrees.</p>
</li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">EphemJPL</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>

<span class="n">ephe3</span> <span class="o">=</span> <span class="n">EphemJPL</span><span class="p">(</span><span class="s1">&#39;Phoebe&#39;</span><span class="p">)</span>

<span class="n">ephe3</span><span class="o">.</span><span class="n">get_position</span><span class="p">(</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">)</span>

<span class="n">ksi</span><span class="p">,</span> <span class="n">eta</span> <span class="o">=</span> <span class="n">ephe3</span><span class="o">.</span><span class="n">get_ksi_eta</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">,</span> <span class="n">star</span><span class="o">=</span><span class="s1">&#39;19 21 18.63201 -21 44 25.3924&#39;</span><span class="p">)</span>

<span class="n">ephe3</span><span class="o">.</span><span class="n">get_pole_position_angle</span><span class="p">(</span><span class="n">pole</span><span class="o">=</span><span class="s1">&#39;10 05 12.000 +41 28 48.000&#39;</span><span class="p">,</span><span class="n">time</span><span class="o">=</span><span class="s1">&#39;2019-08-08 21:41&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="module-lightcurve">
<span id="subsubsec-code-classes-lightcurve"></span><h3>Module: LightCurve<a class="headerlink" href="#module-lightcurve" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p><strong>set_exposure</strong> – Set the exposure time for the light curve as
furnish by the user in seconds.</p></li>
<li><p><strong>set_filter</strong> – Set the mean wavelength and width for the light
curve as furnish by the user in microns.</p></li>
<li><p><strong>sigma_noise</strong> – Set the <span class="math notranslate nohighlight">\(\sigma_{LC}\)</span> as furnish by the user
or calculat it based on the light curve flux.</p></li>
<li><p><strong>plot_lc</strong> – Plots the observed light curve, and the best-fitted
model if it was already determined.</p></li>
<li><p><strong>occ_detect</strong> – Automatically search for the occultation event in
the light curve using a BLS algorithm (Kovacs et al., 2002).</p>
<p><strong>INPUTS</strong>: <em>maximum_duration</em> (float, optional): Maximum duration of
the occultation event (default is 1/4th of the light curve’s time
span). <em>dur_step</em> (float, optional): Step size to sweep occultation
duration event (default value is 1/2 of sampling). <em>snr_limit</em>
(float,optional): Minimum occultation SNR. <em>n_detections</em> (int,
optional): N best detections regardless from SNR. <em>n_detections</em> is
superseded by <em>snr_limit</em>. <strong>OUTPUT</strong>: An ordered dictionary of
:attr:‘name’::attr:‘value’ pairs for each Parameter.
<em>occultation_duration</em>: time span of the occultation event.
<em>central_time</em>: time of central instant of the event.
<em>imersion_time</em>: instant of the begining of the event.
<em>emersion_time</em>: instant of the end of the event. <em>time_err</em>:
uncertainty of the event instants (from sampling). <em>depth</em>: depth
magnitude of the occultation. <em>depth_err</em>: 1<span class="math notranslate nohighlight">\(\sigma\)</span>
uncertainty of the occultation depth. <em>baseline</em>: average flux level
outside the occultation event. <em>baseline_err</em>: 1<span class="math notranslate nohighlight">\(\sigma\)</span>
uncertainty of baseline flux estimate. <em>snr</em>: Signal-to-noise ratio
of the deep in respect with the baseline. <em>occ_mask</em>: Boolean mask
with the lenght of the time series where data inside occultation is
‘True’. Note that when the multiple detection mode caution is
required since other occultations in the data will influence
statistic results.</p>
<p>Single detection example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">LightCurve</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nb">input</span> <span class="o">=</span> <span class="s1">&#39;LC_Chariklo_2017-04-09_Wabi.txt&#39;</span>
<span class="n">time</span><span class="p">,</span> <span class="n">arbtime</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">dflux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">flux</span><span class="p">)</span>
<span class="n">occ</span> <span class="o">=</span> <span class="n">lc</span><span class="o">.</span><span class="n">occ_detect</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">occ</span><span class="p">)</span>
<span class="c1">#{&#39;occultation_duration&#39;: 0.0004645648878067732,</span>
<span class="c1"># &#39;central_time&#39;: 2457852.5916293273,</span>
<span class="c1"># &#39;imersion_time&#39;: 2457852.5913970447,</span>
<span class="c1"># &#39;emersion_time&#39;: 2457852.59186161,</span>
<span class="c1"># &#39;time_err&#39;: 5.799811333417892e-07,</span>
<span class="c1"># &#39;depth&#39;: 0.8663887801707082,</span>
<span class="c1"># &#39;depth_err&#39;: 0.10972550419008305,</span>
<span class="c1"># &#39;baseline&#39;: 0.9110181732552853,</span>
<span class="c1"># &#39;baseline_err&#39;: 0.1904360360568157,</span>
<span class="c1"># &#39;snr&#39;: 91.21719495827487,</span>
<span class="c1"># &#39;occ_mask&#39;: array([False, False, False, ..., False, False, False])}</span>
</pre></div>
</div>
<p>Multiple detection using <em>snr_limit</em>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">LightCurve</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="nb">input</span> <span class="o">=</span> <span class="s1">&#39;LC_Chariklo_2017-04-09_Wabi.txt&#39;</span>
<span class="n">time</span><span class="p">,</span> <span class="n">arbtime</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">dflux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">),</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">time</span><span class="p">,</span><span class="n">flux</span><span class="p">)</span>
<span class="n">occ</span> <span class="o">=</span> <span class="n">lc</span><span class="o">.</span><span class="n">occ_detect</span><span class="p">(</span><span class="n">snr_limit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">occ</span><span class="p">[</span><span class="s1">&#39;snr&#39;</span><span class="p">])):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Detection number: </span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">occ</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
<span class="c1">#Detection number: 1</span>
<span class="c1">#occultation_duration:0.0004645648878067732</span>
<span class="c1">#central_time:2457852.5916293273</span>
<span class="c1">#imersion_time:2457852.5913970447</span>
<span class="c1">#emersion_time:2457852.59186161</span>
<span class="c1">#time_err:5.799811333417892e-07</span>
<span class="c1">#depth:0.8663887801707082</span>
<span class="c1">#depth_err:0.10972550419008305</span>
<span class="c1">#baseline:0.9110181732552853</span>
<span class="c1">#baseline_err:0.1904360360568157</span>
<span class="c1">#snr:91.21719495827487</span>
<span class="c1">#occ_mask:[False False False ... False False False]</span>
<span class="c1">#</span>
<span class="c1">#Detection number: 2</span>
<span class="c1">#occultation_duration:1.1599622666835785e-05</span>
<span class="c1">#central_time:2457852.592378953</span>
<span class="c1">#imersion_time:2457852.592373153</span>
<span class="c1">#emersion_time:2457852.592384753</span>
<span class="c1">#time_err:5.799811333417892e-07</span>
<span class="c1">#depth:0.472894269480926</span>
<span class="c1">#depth_err:0.12751327397424012</span>
<span class="c1">#baseline:0.8395567167536533</span>
<span class="c1">#baseline_err:0.302469636172243</span>
<span class="c1">#snr:5.185356378993047</span>
<span class="c1">#occ_mask:[False False False ... False False False]</span>
<span class="c1">#</span>
<span class="c1">#Detection number: 3</span>
<span class="c1">#occultation_duration:1.7399434000253677e-05</span>
<span class="c1">#central_time:2457852.5908193258</span>
<span class="c1">#imersion_time:2457852.590810626</span>
<span class="c1">#emersion_time:2457852.5908280257</span>
<span class="c1">#time_err:5.799811333417892e-07</span>
<span class="c1">#depth:0.34605982894043885</span>
<span class="c1">#depth_err:0.23829629773980976</span>
<span class="c1">#baseline:0.8396265189404388</span>
<span class="c1">#baseline_err:0.3025636864098951</span>
<span class="c1">#snr:4.575034539625721</span>
<span class="c1">#occ_mask:[False False False ... False False False]</span>
<span class="c1">#</span>
<span class="c1">#Detection number: 4</span>
<span class="c1">#occultation_duration:0.0008438725490123034</span>
<span class="c1">#central_time:2457852.591455855</span>
<span class="c1">#imersion_time:2457852.591033919</span>
<span class="c1">#emersion_time:2457852.591877791</span>
<span class="c1">#time_err:5.799811333417892e-07</span>
<span class="c1">#depth:0.49745658515149577</span>
<span class="c1">#depth_err:0.43834959442481086</span>
<span class="c1">#baseline:0.914112323959715</span>
<span class="c1">#baseline_err:0.19028874519627717</span>
<span class="c1">#snr:70.63232661080131</span>
<span class="c1">#occ_mask:[False False False ... False False False]</span>
</pre></div>
</div>
</li>
<li><p><strong>_runBLS</strong> – Private function used to find the best box fit
suitable to the data.</p></li>
<li><p><strong>_summarizeBLS</strong> – Private function used to merge dictionaries
returned by _runBLS and keep values of common keys in list.</p></li>
<li><p><strong>occ_model</strong> – Create a light curve occultation model considering
the geometric box model, fresnel difraction, stellar diameter and
exposure time.</p>
<p><strong>INPUTS</strong>: <em>self</em> (object): Object LightCurve. <em>t_ingress</em> (float):
Ingrees time, in seconds. <em>t_egress</em> (float): Egress time, in
seconds. <em>opa_ampli</em> (float) Opacity, opaque = 1.0, transparent =
0.0. <em>mask</em> (array) Boolean mask with the lenght of the time series
where data to be considered is ‘True’. <em>npt_star</em> (int) Number of
subdivisions for computing the star size’s effects, default equal to
12. <em>time_resolution_factor</em> (float) Steps for fresnel scale used for
modelling the light curve, default equals to 10 steps for fresnel
scale (or time exposure if smaller than fresnel scale). <strong>OUTPUT</strong>:
<em>flux_inst</em> (array): Modelled Instrumental light flux. <em>time_model</em>
(array): Modelled timing. <em>model_geometric</em> (array): Modelled light
flux considering a box model. <em>flux_star</em> (array): Modelled light
flux considering fresnel difraction and star’s diameter.
<em>flux_fresnel</em> (array): Modelled light flux considering fresnel
difraction.</p>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">LightCurve</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">pl</span>

<span class="n">inn</span> <span class="o">=</span> <span class="s1">&#39;LC_Chariklo_2017-06-22_Hakos.txt&#39;</span>

<span class="n">time</span><span class="p">,</span> <span class="n">arbtime</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">dflux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">arbtime</span><span class="p">,</span><span class="n">flux</span><span class="p">)</span>

<span class="n">lc</span><span class="o">.</span><span class="n">exptime</span> <span class="o">=</span> <span class="mf">0.050</span>                  <span class="c1"># Exposure time in s</span>
<span class="n">lc</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="mf">14.65925396</span>               <span class="c1"># Object distance in AU</span>
<span class="n">lc</span><span class="o">.</span><span class="n">vel</span>  <span class="o">=</span> <span class="mf">22.3572</span>                   <span class="c1"># Event velocity in km/s</span>
<span class="n">lc</span><span class="o">.</span><span class="n">d_star</span> <span class="o">=</span>  <span class="mf">0.2104</span>                 <span class="c1"># Stelar radius in km</span>

<span class="n">t_ingress</span> <span class="o">=</span> <span class="mf">1270.4481</span>
<span class="n">t_egress</span> <span class="o">=</span> <span class="mf">1270.5985</span>
<span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.435</span>
<span class="n">mask</span> <span class="o">=</span> <span class="p">(</span><span class="n">lc</span><span class="o">.</span><span class="n">time</span> <span class="o">&gt;</span> <span class="n">t_ingress</span> <span class="o">-</span> <span class="mi">5</span><span class="p">)</span> <span class="o">&amp;</span> <span class="p">(</span><span class="n">lc</span><span class="o">.</span><span class="n">time</span> <span class="o">&lt;</span> <span class="n">t_egress</span> <span class="o">+</span> <span class="mi">5</span><span class="p">)</span>

<span class="n">lc</span><span class="o">.</span><span class="n">occ_model</span><span class="p">(</span><span class="n">t_ingress</span><span class="p">,</span><span class="n">t_egress</span><span class="p">,</span><span class="n">opacity</span><span class="p">)</span>

<span class="c1">##Plotting the observed and the modelled light curves, Figure 2a.</span>
<span class="c1">##Plotting the observed light curve, the box model, and the light curve affected by Fresnel diffraction, Figure 2b.</span>
</pre></div>
</div>
<p><img alt="image" src="_images/exemplo_lcmodel_1.png" /> <img alt="image1" src="_images/exemplo_lcmodel_2.png" /></p>
</li>
<li><p><strong>__bar_fresnel</strong> – Private function used to create the light curve
affected by fresnel difraction.</p></li>
<li><p><strong>__occ_model</strong> – Private function used to create the light curve
model during the fitting.</p></li>
<li><p><strong>occ_lcfit</strong> – Function that fits the light curve parameters
(ingress time, egress time and opacity) using a brute force
minimisation of <span class="math notranslate nohighlight">\(\chi^2\)</span>.</p>
<p><strong>INPUTS</strong>: <em>self</em> (object): Object LightCurve. <em>mask</em> (array)
Boolean mask with the lenght of the time series where data to be
considered is ‘True’. <em>t_ingress</em> (float): Initial guess for ingrees
time, in seconds. <em>t_egress</em> (float): Initial guess for egress time,
in seconds. <em>opa_ampli</em> (float) Initial guess for opacity, opaque =
1.0, transparent = 0.0. <em>dt_ingress</em> (float): Bondary region for
<span class="math notranslate nohighlight">\(\chi^2\)</span> test, relative to the ingress time, in seconds.
Default equals to zero means no variation <em>dt_egress</em> (float):
Bondary region for <span class="math notranslate nohighlight">\(\chi^2\)</span> test, relative to the egress time,
in seconds. Default equals to zero means no variation <em>dopacity</em>
(float) Bondary region for <span class="math notranslate nohighlight">\(\chi^2\)</span> test, relative to the
opacity. Default equals to zero means no variation</p>
<p><strong>OUTPUT</strong>: <em>chi2</em> (array): Tested chi squared values. <em>t_i</em> (array):
Tested ingress values. <em>t_e</em> (array): Tested egress values. <em>opa</em>
(array): Tested opacity values.</p>
<p>Example only fitting Ingress time:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">LightCurve</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">pl</span>

<span class="n">inn</span> <span class="o">=</span> <span class="s1">&#39;LC_Chariklo_2017-04-09_Weaver.txt&#39;</span>

<span class="n">time</span><span class="p">,</span> <span class="n">arbtime</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">dflux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">arbtime</span><span class="p">,</span><span class="n">flux</span><span class="p">)</span>

<span class="n">lc</span><span class="o">.</span><span class="n">exptime</span> <span class="o">=</span> <span class="mf">0.080</span>                  <span class="c1"># Exposure time in s</span>
<span class="n">lc</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="mf">4.779391622236</span>            <span class="c1"># Object distance in AU</span>
<span class="n">lc</span><span class="o">.</span><span class="n">vel</span>  <span class="o">=</span> <span class="mf">15.4676223706</span>             <span class="c1"># Event velocity in km/s</span>
<span class="n">lc</span><span class="o">.</span><span class="n">d_star</span> <span class="o">=</span>  <span class="mf">0.735</span>                  <span class="c1"># Stelar radius in km</span>
<span class="n">lc</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.108</span>

<span class="c1">#Only one side</span>
<span class="n">tmin</span> <span class="o">=</span> <span class="mi">7870</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="mi">7890</span>

<span class="n">t_ingress</span> <span class="o">=</span> <span class="mf">7880.4792</span>
<span class="n">delta_t</span> <span class="o">=</span> <span class="mf">0.20</span>

<span class="n">chi2_ing</span> <span class="o">=</span>  <span class="n">lc</span><span class="o">.</span><span class="n">occ_lcfit</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span> <span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span> <span class="n">t_ingress</span><span class="o">=</span><span class="n">t_ingress</span><span class="p">,</span> <span class="n">delta_t</span><span class="o">=</span><span class="n">delta_t</span><span class="p">)</span>

<span class="c1">##Plotting the Light Curve, Figure 3a</span>
<span class="c1">##Plotting the Chi squared curve for ingress time, Figure 3b</span>
</pre></div>
</div>
<p><img alt="image2" src="_images/exemplo_lcfit_1a.png" /> <img alt="image3" src="_images/exemplo_lcfit_1b.png" /></p>
<p>Example of fitting all three parameters (Ingress time, egress time,
and opacity):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">LightCurve</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pylab</span> <span class="k">as</span> <span class="nn">pl</span>

<span class="n">inn</span> <span class="o">=</span> <span class="s1">&#39;LC_Chariklo_2017-04-09_Weaver.txt&#39;</span>

<span class="n">time</span><span class="p">,</span> <span class="n">arbtime</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">dflux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">loadtxt</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span> <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="n">unpack</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">arbtime</span><span class="p">,</span><span class="n">flux</span><span class="p">)</span>

<span class="n">lc</span><span class="o">.</span><span class="n">exptime</span> <span class="o">=</span> <span class="mf">0.080</span>                  <span class="c1"># Exposure time in s</span>
<span class="n">lc</span><span class="o">.</span><span class="n">dist</span> <span class="o">=</span> <span class="mf">4.779391622236</span>            <span class="c1"># Object distance in AU</span>
<span class="n">lc</span><span class="o">.</span><span class="n">vel</span>  <span class="o">=</span> <span class="mf">15.4676223706</span>             <span class="c1"># Event velocity in km/s</span>
<span class="n">lc</span><span class="o">.</span><span class="n">d_star</span> <span class="o">=</span>  <span class="mf">0.735</span>                  <span class="c1"># Stelar radius in km</span>
<span class="n">lc</span><span class="o">.</span><span class="n">sigma</span> <span class="o">=</span> <span class="mf">0.108</span>

<span class="n">tmin</span> <span class="o">=</span> <span class="mi">7833</span>
<span class="n">tmax</span> <span class="o">=</span> <span class="mi">7845</span>
<span class="n">t_ingress</span> <span class="o">=</span> <span class="mf">7838.7</span>
<span class="n">t_egress</span> <span class="o">=</span> <span class="mf">7839.9</span>
<span class="n">opacity</span> <span class="o">=</span> <span class="mf">0.35</span>

<span class="n">delta_t</span>  <span class="o">=</span> <span class="mf">0.20</span>
<span class="n">dopacity</span> <span class="o">=</span> <span class="mf">0.30</span>

<span class="n">chi2_ring1</span> <span class="o">=</span>  <span class="n">lc</span><span class="o">.</span><span class="n">occ_lcfit</span><span class="p">(</span><span class="n">tmin</span><span class="o">=</span><span class="n">tmin</span><span class="p">,</span><span class="n">tmax</span><span class="o">=</span><span class="n">tmax</span><span class="p">,</span> <span class="n">t_ingress</span><span class="o">=</span><span class="n">t_ingress</span><span class="p">,</span> <span class="n">t_egress</span><span class="o">=</span><span class="n">t_egress</span><span class="p">,</span> <span class="n">opacity</span><span class="o">=</span><span class="n">opacity</span><span class="p">,</span> <span class="n">delta_t</span><span class="o">=</span><span class="n">delta_t</span><span class="p">,</span> <span class="n">dopacity</span><span class="o">=</span><span class="n">dopacity</span><span class="p">,</span><span class="n">loop</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>

<span class="c1">##Equivalent plots to the previous example</span>
<span class="c1">##Plotting the Light Curve, Figure 4a</span>
<span class="c1">##Plotting the Chi squared curve for ingress time, Figure 4b</span>
<span class="c1">##Plotting the Chi squared curve for egress time, Figure 4c</span>
<span class="c1">##Plotting the Chi squared curve for opacity, Figure 4d</span>
</pre></div>
</div>
<p><img alt="image4" src="_images/exemplo_lcfit_2a.png" /> <img alt="image5" src="_images/exemplo_lcfit_2b.png" /> <img alt="image6" src="_images/exemplo_lcfit_2c.png" /> <img alt="image7" src="_images/exemplo_lcfit_2d.png" /></p>
</li>
</ul>
</div>
<div class="section" id="module-prediction">
<span id="subsubsec-code-classes-prediction"></span><h3>Module: prediction<a class="headerlink" href="#module-prediction" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Set of independent functions that are used by <em>Prediction</em> but do not
depend on it.</p>
<ul>
<li><p><strong>occ_params()</strong> – Calculates the parameters of the occultation.</p>
<p><strong>INPUT</strong>: <em>star</em>: The coordinate of the star in the same frame as
the ephemeris. It must be a Star object. <em>ephem</em>: It must be an
Ephemeris object.</p>
<p><strong>OUTPUT</strong>: instant of occultation, Closest Approach, Position
Angle, geocentric relative velocity and object distance</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">occ_params</span><span class="p">(</span><span class="n">star</span><span class="p">,</span><span class="n">eph</span><span class="p">)</span>
<span class="c1">#(&lt;Time object: scale=&#39;utc&#39; format=&#39;jd&#39; value=2458641.6600943254&gt;,</span>
<span class="c1"># &lt;Quantity 0.16698067 arcsec&gt;,</span>
<span class="c1"># &lt;Quantity 171.85352157 deg&gt;,</span>
<span class="c1"># &lt;Quantity -16.85079849 km / s&gt;,</span>
<span class="c1"># &lt;Distance 9.24102797 AU&gt;)</span>
</pre></div>
</div>
</li>
<li><p><strong>prediction()</strong>: Predicts occultations for the given inputs.</p>
<p><strong>INPUT</strong>: <em>ephem</em>: Ephemeris. It must be an EphemKernel object.
<em>time_beg</em>: Initial time for prediction. <em>time_beg</em>: Final time
for prediction. <em>mag_lim</em>: Faintest Gmag for search. <em>interv</em>:
interval, in seconds, of ephem times for search. This is the step
to generate ephemeris for fast search. <em>divs</em>: interval, in deg,
for max search of stars. The ephemeris will be split in each “div”
degrees to search occultations. <em>sigma</em>:Increase the range of
distance for search based on sigma*ephem_error where ephem_error
is the error given to EphemKernel object.</p>
<p><strong>OUTPUT</strong>: An Prediction object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora.prediction</span> <span class="kn">import</span> <span class="n">prediction</span>
<span class="kn">from</span> <span class="nn">sora.ephem</span> <span class="kn">import</span> <span class="n">EphemKernel</span>

<span class="n">ephe2</span> <span class="o">=</span> <span class="n">EphemKernel</span><span class="p">(</span><span class="s1">&#39;Phoebe&#39;</span><span class="p">,</span> <span class="mi">609</span><span class="p">,</span> <span class="n">kernels</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;path/ph19a.bsp&#39;</span><span class="p">,</span> <span class="s1">&#39;path/de438.bsp&#39;</span><span class="p">])</span>

<span class="n">occs</span> <span class="o">=</span> <span class="n">prediction</span><span class="p">(</span><span class="n">ephe2</span><span class="p">,</span> <span class="n">time_beg</span><span class="o">=</span><span class="s1">&#39;2020-05-01 00:00:00.000&#39;</span><span class="p">,</span> <span class="n">time_end</span><span class="o">=</span><span class="s1">&#39;2020-10-01 00:00:00.000&#39;</span><span class="p">,</span> <span class="n">mag_lim</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span> <span class="n">divs</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">occs</span><span class="p">)</span>
<span class="c1">#         Epoch             ICRS Star Coord at Epoch      ca  ...   G*     dist</span>
<span class="c1">#----------------------- ------------------------------ ----- ... ------ -------</span>
<span class="c1">#2020-06-01 02:00:43.100 20 16 49.35703 -19 56 39.33936 0.054 ... 16.032   9.348</span>
<span class="c1">#2020-06-11 17:02:49.950 20 15 02.29688 -20 03 38.58596 0.605 ... 15.324   9.231</span>
<span class="c1">#2020-06-12 03:39:23.150 20 14 56.97040 -20 03 57.31622 0.670 ... 15.971   9.227</span>
<span class="c1">#2020-07-24 12:57:53.650 20 02 57.42683 -20 44 41.96963 0.263 ... 13.371   9.042</span>
<span class="c1">#2020-09-20 15:22:51.650 19 49 10.32921 -21 25 06.53792 0.154 ... 13.287   9.575</span>
</pre></div>
</div>
</li>
<li><p><strong>plot_occ_map()</strong> – Plots an occultation map given input
parameters.</p>
<p><strong>INPUT</strong>: <em>name</em>: Name of the object that is being plotted.
<em>radius</em>: radius of the object, in km, to calculate size of path.
<em>coord</em>: the GCRS coordinate of the star. <em>time</em>: The instant of
closest approach, in the ISO format. <em>ca</em>: the closest approach
distance, in arcsec. <em>pa</em>: the planet position angle with respect
to the star at C/A, in deg. <em>vel</em>: the occultation velocity, in
km/s. <em>dist</em>: the planet distance, in AU. <em>**kwargs</em>: other
parameters for plot control.</p>
<p>Please refer to to a full example of all kwargs present in
<em>plot_occ_map()</em></p>
</li>
</ul>
</li>
<li><p><strong>PredictionTable</strong></p>
<ul>
<li><p><strong>__init__()</strong> – Instantiate PredictionTable object.</p>
<p><strong>INPUT</strong>: <em>time</em>: the instant of geocentric closest approach;
<em>coord_star</em>: the coordinate of the star; <em>coord_obj</em>: the
geocentric coordinate of the object, <em>ca</em>: geocentric closest
approach distance; <em>pa</em>: position angle at ca; <em>vel</em>: occultation
geocentric velocity; <em>dist</em>: Object distance, in AU; <em>mag</em> and
<em>mag_20</em> for the magnitude and magnitude normalised to 20km/s. At
least one of these parameters are required; <em>long</em>: Longitude of
the sub-star point at ca (optional); <em>loct</em>: Local solar time at
long (optional). <em>**kwargs</em>: any other parameter will be parsed
directly by Astropy Table.</p>
<p><strong>The Prediction Table is not intended to be directly instantiated
by the user.</strong></p>
</li>
<li><p><strong>to_praia()</strong> – Saves the table in the PRAIA format</p>
<p><strong>INPUT</strong>: <em>filename</em>: Name of the file to save table</p>
</li>
<li><p><strong>from_praia()</strong> – Creates a Prediction table from PRAIA
prediction table.</p>
<p><strong>INPUT</strong>: <em>filename</em>: Name of the file in PRAIA format; <em>name</em>:
The name of the object predicted; <em>radius</em>: the radius of the
object (optional).</p>
<p><strong>OUTPUT</strong>: A Prediction table.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora.prediction</span> <span class="kn">import</span> <span class="n">PredictionTable</span>

<span class="n">occs</span> <span class="o">=</span> <span class="n">PredictionTable</span><span class="o">.</span><span class="n">from_praia</span><span class="p">(</span><span class="s1">&#39;g4_occ_datauc4_HIM_G2_table&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Himalia&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">85</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">occs</span><span class="p">)</span>
<span class="c1">#         Epoch             ICRS Star Coord at Epoch    ... long  loct</span>
<span class="c1">#----------------------- ------------------------------ ... ---- -----</span>
<span class="c1">#2020-04-06 02:05:35.000 19 46 15.30170 -21 40 23.57500 ...   70 06:46</span>
<span class="c1">#2020-04-08 06:19:54.000 19 47 25.29390 -21 38 18.27800 ...    5 06:39</span>
<span class="c1">#2020-04-14 07:46:30.000 19 50 24.76210 -21 32 46.42700 ...  338 06:18</span>
<span class="c1">#2020-04-27 13:53:34.000 19 55 30.85740 -21 22 31.22900 ...  234 05:31</span>
</pre></div>
</div>
</li>
<li><p><strong>to_ow()</strong> – Creates the files ‘tableOccult_update.txt‘ and
‘LOG.dat‘ to feed Occult Watcher.</p>
<p><strong>INPUT</strong>: <em>ow_des</em>: the OW designation of the object; <em>mode</em>:
“append” if the output must append existing files, “restart” to
overwrite existing files. Default: “append”.</p>
</li>
<li><p><strong>plot_occ_map()</strong> – Plots the maps for all the occultations. All
the parameters required by <em>plot_occ_map()</em> are automatically
filled. The user can pass the parameters for plot control. Please
refer to Section <a class="reference external" href="#SubSubSec:code_maps">5.5.8</a> to a full
example of all kwargs present in <em>plot_occ_map()</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora.prediction</span> <span class="kn">import</span> <span class="n">PredictionTable</span>

<span class="n">occs</span> <span class="o">=</span> <span class="n">PredictionTable</span><span class="o">.</span><span class="n">from_praia</span><span class="p">(</span><span class="s1">&#39;g4_occ_datauc4_HIM_G2_table&#39;</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;Himalia&#39;</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">85</span><span class="p">)</span>
<span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">()</span>
<span class="c1">## This will plot all the occultations in the occs.</span>

<span class="n">occs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">()</span>
<span class="c1">## This will plot only the first occultation in occ</span>

<span class="n">occs</span><span class="p">[</span><span class="s1">&#39;2020-04-06&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">()</span>
<span class="c1">## This will plot all the occultations predicted for April 06, 2020.</span>

<span class="n">occs</span><span class="p">[</span><span class="s1">&#39;2020-04&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">()</span>
<span class="c1">## This will plot all the occultations predicted for April 2020.</span>

<span class="n">occs</span><span class="p">[</span><span class="s1">&#39;2020-04-06 02&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">()</span>
<span class="c1">## This will plot all the occultations predicted for April 06, 2020 between 02 and 03 UT.</span>
</pre></div>
</div>
</li>
<li><p><strong>other methods</strong> – Prediction inherits all attributes and methods
from Astropy.table.Table. It is expected that all methods from
Table should work fine. This includes the function to write table
in other formats, such as <em>csv</em> and <em>latex</em> with <strong>write()</strong>,
pretty printing with <strong>pprint_all()</strong>, stacking Prediction tables
with <strong>vstack()</strong>, etc. Please refer to
<a class="reference external" href="https://docs.astropy.org/en/stable/table/">https://docs.astropy.org/en/stable/table/</a> for all Table
Documentation.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="module-occ-fit">
<span id="subsubsec-code-classes-occultation"></span><h3>Module: occ_fit<a class="headerlink" href="#module-occ-fit" title="Permalink to this headline">¶</a></h3>
<ul>
<li><p>Set of independent functions that are used by <em>Occultation</em> but do
not depend on it.</p>
<ul>
<li><p><strong>positionv()</strong> – Calculates the position and velocity of the
occultation shadow relative to the observer.</p>
<p><strong>INPUT</strong>: <em>star</em>: The coordinate of the star in the same frame as
the ephemeris. It must be a Star object. <em>ephem</em>: It must be an
Ephemeris object. <em>observer</em> (Observer): It must be an Observer
object. <em>time</em>: Instant to calculate position and velocity</p>
<p><strong>OUTPUT</strong>: The orthographic projection of the shadow relative to
the observer (f and g) and velocity in these directions.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">Observer</span><span class="p">,</span> <span class="n">Star</span><span class="p">,</span> <span class="n">Ephemeris</span><span class="p">,</span> <span class="n">positionv</span>

<span class="n">casleo</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="s1">&#39;Casleo&#39;</span><span class="p">,</span> <span class="s1">&#39;-69 17 44.9&#39;</span><span class="p">,</span> <span class="s1">&#39;-31 47 55.6&#39;</span><span class="p">,</span> <span class="mi">2492</span><span class="p">)</span>
<span class="n">star</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="s1">&#39;19 21 18.63201 -21 44 25.3924&#39;</span><span class="p">)</span>
<span class="n">eph</span> <span class="o">=</span> <span class="n">Ephemeris</span><span class="p">(</span><span class="s1">&#39;Phoebe&#39;</span><span class="p">,</span> <span class="s1">&#39;ephem_phoebe_ph15_jd.txt&#39;</span><span class="p">)</span>

<span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">vf</span><span class="p">,</span><span class="n">vg</span> <span class="o">=</span> <span class="n">positionv</span><span class="p">(</span><span class="n">star</span><span class="o">=</span><span class="n">star</span><span class="p">,</span><span class="n">ephem</span><span class="o">=</span><span class="n">eph</span><span class="p">,</span> <span class="n">observer</span><span class="o">=</span><span class="n">casleo</span><span class="p">,</span> <span class="n">time</span><span class="o">=</span><span class="s1">&#39;2019-06-07 03:54:22.60&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">g</span><span class="p">,</span><span class="n">vf</span><span class="p">,</span><span class="n">vg</span><span class="p">)</span>
<span class="c1">#-225.359 -48.573 16.957 2.487</span>
</pre></div>
</div>
</li>
<li><p><strong>fit_ellipse()</strong> – fit ellipse to given points.</p>
<p><strong>INPUT</strong>: list of Occultation objects. The position will be read
automaticaly from these objects.</p>
<p>Required parameters: <em>center_f</em>, <em>center_g</em>, <em>equatorial_radius</em>,
<em>oblateness</em>, <em>pos_angle</em> as initial parameters. For each of
theses parameters, the interval of values must be given by
<em>dcenter_f</em>, <em>dcenter_g</em>, <em>dequatorial_radius</em>, <em>doblateness</em>,
<em>dpos_angle</em>. If any delta is not given, it will be set to zero.</p>
<p><em>loop</em>: Number of different ellipses to try. Default: 10,000,000</p>
<p><em>dchi_min</em>: if a number is set to this parameter, fit_ellipse will
only saves values where
<span class="math notranslate nohighlight">\(\chi^2 &lt; \chi^2 + \textrm{dchi\_min}\)</span>. In this case, it
will repeatedly generate random ellipses until <em>number_chi</em> is
reached. <em>number_chi</em>: minimum number of ellipsis within
<em>dchi_min</em>. Default: 10,000.</p>
<p><em>log</em>: if True, it will print the steps of the fitting. Default:
False.</p>
<p><strong>OUTPUT</strong>: a <em>ChiSquare</em> object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora.occ_fit</span> <span class="kn">import</span> <span class="n">fit_ellipse</span><span class="p">,</span> <span class="n">Occultation</span>

<span class="n">occ1</span> <span class="o">=</span> <span class="n">Occultation</span><span class="p">(</span><span class="n">star1</span><span class="p">,</span> <span class="n">ephem1</span><span class="p">)</span>
<span class="c1"># add observations for occ1</span>
<span class="n">occ2</span> <span class="o">=</span> <span class="n">Occultation</span><span class="p">(</span><span class="n">star2</span><span class="p">,</span> <span class="n">ephem2</span><span class="p">)</span>
<span class="c1"># add observationn for occ2</span>

<span class="n">chi2</span>  <span class="o">=</span> <span class="n">fit_ellipse</span><span class="p">(</span><span class="n">occ1</span><span class="p">,</span> <span class="n">occ2</span><span class="p">,</span> <span class="n">center_f</span><span class="o">=</span><span class="mi">87</span><span class="p">,</span> <span class="n">center_g</span><span class="o">=-</span><span class="mi">60</span><span class="p">,</span> <span class="n">dcenter_f</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">dcenter_g</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">equatorial_radius</span><span class="o">=</span><span class="mi">84</span><span class="p">,</span> <span class="n">dequatorial_radius</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">oblateness</span><span class="o">=</span><span class="mf">0.23</span><span class="p">,</span> <span class="n">doblateness</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">pos_angle</span><span class="o">=-</span><span class="mi">5</span><span class="p">,</span> <span class="n">dpos_angle</span><span class="o">=</span><span class="mi">10</span> <span class="p">,</span><span class="n">loop</span><span class="o">=</span><span class="mi">10000000</span><span class="p">,</span> <span class="n">dchi_min</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>_PositionDict(dict)</strong> – A modified dict class to handle
positions. It should not be used by the user.</p></li>
</ul>
</li>
<li><p><strong>Occultation</strong></p>
<ul>
<li><p><strong>__init__()</strong> – instantiate the star object.</p>
<p><strong>INPUT</strong>: <em>star</em>: The coordinate of the star in the same frame as
the ephemeris. It must be a Star object. <em>ephem</em>: Ephemeris. It
must be one of the Ephemeris objects.</p>
</li>
<li><p><strong>add_observation()</strong> – Add Observers to the Occultation object.</p>
<p><strong>INPUT</strong>: <em>obs</em>: It must be an Observer object; <em>LightCurve</em>: It
must be an LightCurve object</p>
</li>
<li><p><strong>observations()</strong> – Shows all observations added to the
occultation. No input required.</p></li>
<li><p><strong>remove_observation()</strong> – Remove an observation from the
occultation list.</p>
<p><strong>INPUT</strong>: <em>key</em>: The name given to Observer or LightCurve to
remove from the list; <em>key_lc</em>: In the case where repeated names
are present for different observations, <em>key_lc</em> must be given for
the name of the LightCurve and <em>key</em> will be used for the name of
the Observer.</p>
</li>
<li><p><strong>fit_ellipse()</strong> – Calls the <em>fit_ellipse</em> function using only
this occultation. Any input parameter will be parsed directly by
<em>fit_ellipse</em>.</p></li>
<li><p><strong>new_astrometric_position()</strong> – Calculates and print new
astrometric position given the params fitted by <em>fit_ellipse</em>.</p>
<p><strong>INPUT</strong>: <em>time</em>: the time the user wants to the determine the
position. Default: Time at Closest Approach; <em>offset</em>: The offset
the user wants to give to the ephemeris. If not given, it will use
the offset calculated by <em>fit_ellipse</em>. If no fit have been made,
it uses zero. The offset param must be a list with 3 values and
can be in distance units for the offset in the projection, example
“offset=[f, g, ’km’]” where X and Y are in km in the direction f
(norte) and g (east). It can also be an angle value for angular
offsets, example “offset=[da_cos_dec, d_dec, ’mas’]”; <em>error</em>: the
error for the offset applied. Its use is similar to the <em>offset</em>
param.</p>
</li>
<li><p><strong>check_velocities()</strong> – Shows the radial velocities for the
immersion and emersion for each positive chord given the center
calculated by fit_ellipse.</p>
<p><strong>INPUT</strong>: None.</p>
</li>
<li><p><strong>plot_chords()</strong> – Makes the plot of the chords of the
observations added to the Occultation.</p>
<p><strong>INPUT</strong>: <em>all_chords</em>: Default=True, if it is to print all the
chords. If false, it does not plot the points or chords disabled
by the user; <em>positive_color</em>: The color to plot positive colors.
Default: ’blue’; <em>negative_color</em>: The color to plot negative
colors. Default: ’green’; <em>error_color</em>: The color to plot the
error bars of the points. Default: ’red’.</p>
</li>
<li><p><strong>positions</strong> – This is a function that works as dictionary. Once
called, it will calculated the position and velocity for all
immersions and emersions for the light curves added to the
Occultation. It uses the <em>_PositionDict</em> object. It is used to
able or disable points for the fitting process.</p></li>
</ul>
</li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sora</span> <span class="kn">import</span> <span class="n">Observer</span><span class="p">,</span> <span class="n">Star</span><span class="p">,</span> <span class="n">EphemPlanete</span><span class="p">,</span> <span class="n">Occultation</span><span class="p">,</span> <span class="n">LightCurve</span>

<span class="n">star</span> <span class="o">=</span> <span class="n">Star</span><span class="p">(</span><span class="n">coord</span><span class="o">=</span><span class="s1">&#39;19 21 18.63201 -21 44 25.3924&#39;</span><span class="p">)</span>
<span class="n">eph</span> <span class="o">=</span> <span class="n">Ephemeris</span><span class="p">(</span><span class="s1">&#39;Phoebe&#39;</span><span class="p">,</span> <span class="s1">&#39;ephem_phoebe_ph15_jd.txt&#39;</span><span class="p">)</span>

<span class="n">casleo</span> <span class="o">=</span> <span class="n">Observer</span><span class="p">(</span><span class="s1">&#39;Casleo&#39;</span><span class="p">,</span> <span class="s1">&#39;-69 17 44.9&#39;</span><span class="p">,</span> <span class="s1">&#39;-31 47 55.6&#39;</span><span class="p">,</span> <span class="mi">2492</span><span class="p">)</span>
<span class="n">casleo_lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="s1">&#39;Casleo&#39;</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">flux_input</span><span class="p">)</span>

<span class="n">occ</span> <span class="o">=</span> <span class="n">Occultation</span><span class="p">(</span><span class="n">star</span><span class="o">=</span><span class="n">star</span><span class="p">,</span> <span class="n">ephem</span><span class="o">=</span><span class="n">eph</span><span class="p">)</span>
<span class="n">occ</span><span class="o">.</span><span class="n">add_observation</span><span class="p">(</span><span class="n">casleo</span><span class="p">,</span> <span class="n">casleo_lc</span><span class="p">)</span>

<span class="c1"># to disable casleo observation to not use it in the fitting process.</span>
<span class="n">occ</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="s1">&#39;Casleo&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;off&#39;</span>
<span class="c1"># instead, to disable only the immersion of casleo observation.</span>
<span class="n">occ</span><span class="o">.</span><span class="n">positions</span><span class="p">[</span><span class="s1">&#39;Casleo&#39;</span><span class="p">][</span><span class="s1">&#39;immersion&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;off&#39;</span>
</pre></div>
</div>
</div>
<div class="section" id="map-documentation">
<span id="subsubsec-code-maps"></span><h3>Map documentation<a class="headerlink" href="#map-documentation" title="Permalink to this headline">¶</a></h3>
<p>To generate prediction or post-fit occultation maps, the function to be
used is <em>sora.prediction.plot_occ_map(</em>). This function receives many
required parameters that states the orientation and path of the
occultation. When using this function within sora.occ_fit.plot_occ_map()
or sora.Prediction.plot_occ_map() all the required parameters are
automatically send to the original function. But the user is still able
to pass many kwargs are used to configure the occultation map. Without
any configuration parameter, the map will have the plain view of the
Earth and path. For example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">### from a Prediction Table of Phoebe</span>
<span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">()</span>
<span class="c1">## Phoebe_2018-06-19T04:36:56.400.png generated</span>
</pre></div>
</div>
<p><img alt="image8" src="_images/Phoebe_plain.png" /></p>
<ul>
<li><p>nameimg: Change the name of the imaged saved.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">nameimg</span><span class="o">=</span><span class="s1">&#39;Phoebe_teste&#39;</span><span class="p">)</span>
<span class="c1">## Phoebe_teste.png generated</span>
</pre></div>
</div>
</li>
<li><p>resolution: Identify the type of cartopy feature resolution. “1”
means a resolution of “10m”, “2” a resolution of “50m” and “3” a
resolution of “100m”. The default is “2”. .</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="_images/Phoebe_res1.png"><img alt="image9" src="_images/Phoebe_res1.png" style="width: 49.0%;" /></a> <a class="reference internal" href="_images/Phoebe_res3.png"><img alt="image10" src="_images/Phoebe_res3.png" style="width: 49.0%;" /></a></p>
</li>
<li><p>states: Plots the state division of the countries. The states of some
countries will only be shown depending on the resolution. For
instance, USA states are shown for all resolutions, but Brazilian
states will be shown only for resolution equal to “1” or “2”. This is
a cartopy characteristics and cannot be changed. Default=True.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">states</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>zoom: Zooms in or out of the map. It must be a number. For the number
given in zoom, the dimensions of the map will be divided by that
number. For instance, if zoom=2, it will be shown the Earth divided
by 2 in X and Y. Default=1. .</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">zoom</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">zoom</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
<p><a class="reference internal" href="_images/Phoebe_zoom2.png"><img alt="image11" src="_images/Phoebe_zoom2.png" style="width: 49.0%;" /></a> <a class="reference internal" href="_images/Phoebe_zoom05.png"><img alt="image12" src="_images/Phoebe_zoom05.png" style="width: 49.0%;" /></a></p>
</li>
<li><p>centermap_geo: Center the map given coordinates in longitude and
latitude. It must be a list with two numbers. Default=None. If
coordinate is on the other side of the map, it gives an error.
(left).</p></li>
<li><p>centermap_delta: Displace the center of the map given displacement in
X and Y, in km. It must be a list with two numbers. Default=None.
(right).</p>
<p>centermap_geo and centermap_delta are only a displacement on original
projection. If Earth rotation is needed, please see centerproj.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">centermap_geo</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">40</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Center the map on longitude=0.0 deg and latitude=-40 deg.</span>
<span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">centermap_delta</span><span class="o">=</span><span class="p">[</span><span class="mi">5000</span><span class="p">,</span><span class="o">-</span><span class="mi">1000</span><span class="p">],</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Displace the center of the map 5000 km East and 1000 km South</span>
</pre></div>
</div>
<p><a class="reference internal" href="_images/Phoebe_center_geo.png"><img alt="image13" src="_images/Phoebe_center_geo.png" style="width: 49.0%;" /></a> <a class="reference internal" href="_images/Phoebe_center_delta.png"><img alt="image14" src="_images/Phoebe_center_delta.png" style="width: 49.0%;" /></a></p>
</li>
<li><p>centerproj: Rotates the Earth to show occultation with the center
projected at a given longitude and latitude. (left).</p></li>
<li><p>labels: Plots text above and below the map with the occultation
parameters. Default=True. (right).</p></li>
<li><p>meridians and parallels: Plots lines representing the meridians and
parallels given such interval. Default=30 for both parameters. So it
will plot lines representing these values each 30º. (right).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">centerproj</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="o">-</span><span class="mi">40</span><span class="p">])</span>
<span class="c1"># Rotate to center the map projection on longitude=0.0 deg and latitude=-40 deg.</span>
<span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">meridian</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">parallels</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">zoom</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Displace the center of the map 5000 km East and 1000 km South</span>
</pre></div>
</div>
<p><a class="reference internal" href="_images/Phoebe_centerproj.png"><img alt="image15" src="_images/Phoebe_centerproj.png" style="width: 49.0%;" /></a> <a class="reference internal" href="_images/Phoebe_merpar.png"><img alt="image16" src="_images/Phoebe_merpar.png" style="width: 49.0%;" /></a></p>
</li>
<li><p>sites: Plots site positions in map. It must be a python dictionary
where the key is the name of the site, and the value is a list with
longitude, latitude, delta_x, delta_y and color. <em>delta_x</em> and
<em>delta_y</em> are displacement, in km, from the point of the site in the
map and the name. <em>color</em> is the color of the point. (left).</p></li>
<li><p>countries: Plots the names of countries. It must be a python
dictionary where the key is the name of the country and the value is
a list with longitude and latitude of the lower left part of the
text. (right).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">sites</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">sites</span><span class="p">[</span><span class="s1">&#39;Foz&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="o">-</span><span class="mf">54.5936</span><span class="p">,</span> <span class="o">-</span><span class="mf">25.4347</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;blue&#39;</span><span class="p">]</span>
<span class="n">sites</span><span class="p">[</span><span class="s1">&#39;SOAR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="o">-</span><span class="mf">70.73919</span><span class="p">,</span> <span class="o">-</span><span class="mf">30.238027</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39;green&#39;</span><span class="p">]</span>
<span class="n">sites</span><span class="p">[</span><span class="s1">&#39;La Silla&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">70.7393888</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.254611</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span><span class="s1">&#39;blue&#39;</span><span class="p">]</span>
<span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">zoom</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">sites</span><span class="o">=</span><span class="n">sites</span><span class="p">)</span>

<span class="n">countries</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">countries</span><span class="p">[</span><span class="s1">&#39;Brazil&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">52.5983973</span><span class="p">,</span> <span class="o">-</span><span class="mf">23.5570511</span><span class="p">]</span>
<span class="n">countries</span><span class="p">[</span><span class="s1">&#39;Argentina&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mf">67.2088692</span><span class="p">,</span> <span class="o">-</span><span class="mf">35.1237852</span><span class="p">]</span>
<span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">countries</span><span class="o">=</span><span class="n">countries</span><span class="p">,</span> <span class="n">states</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p><a href="#id11"><span class="problematic" id="id12">|image17|</span></a> <a class="reference internal" href="_images/Phoebe_country.png"><img alt="image18" src="_images/Phoebe_country.png" style="width: 49.0%;" /></a></p>
</li>
<li><p>offset: applies an offset to the ephemeris, calculating new CA and
instant of CA. It is a pair of delta_RA*cosDEC and delta_DEC. (left).</p></li>
<li><p>mapstyle: Define the color style of the map. 1 is the default black
and white scale. 2 is a colored map. (right).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">offset</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mi">40</span><span class="p">,</span><span class="mi">50</span><span class="p">])</span>
<span class="c1"># Applies offsets of -40 mas in Delta_alpha_cos_delta and 50 mas in Delta_delta</span>
<span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">mapstyle</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># Plots a colored map, without offset</span>
</pre></div>
</div>
<p><a class="reference internal" href="_images/Phoebe_offset.png"><img alt="image19" src="_images/Phoebe_offset.png" style="width: 49.0%;" /></a> <a class="reference internal" href="_images/Phoebe_mapstyle.png"><img alt="image20" src="_images/Phoebe_mapstyle.png" style="width: 49.0%;" /></a></p>
</li>
<li><p>error: Ephemeris error in mas. It plots a dashed line representing
radius + error. To change the color of these lines, the name of the
color must be given to lncolor. (left).</p></li>
<li><p>ring: Similarly to error, it plots a dashed line representing the
location of a ring. It is given in km, from the center. To change the
color of these lines, the name of the color must be given to rncolor.</p></li>
<li><p>atm: Similarly to error, it plots a dashed line representing the
limit of an atmosphere. It is given in km, from the center. To change
the color of these lines, the name of the color must be given to
atmcolor.</p></li>
<li><p>heights: It plots a circular dashed line showing the locations where
the observer would observe the occultation at a given height above
the horizons. This must be a list. To change the color of these
lines, the name of the color must be given to hcolor. (right).</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">zoom</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">labels</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">error</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="c1"># Shows an error bar of 15 mas</span>
<span class="n">occs</span><span class="o">.</span><span class="n">plot_occ_map</span><span class="p">(</span><span class="n">heights</span><span class="o">=</span><span class="p">[</span><span class="mi">30</span><span class="p">])</span>
<span class="c1"># Shows where the observer will see the occultation with a 30deg height above the horizons.</span>
</pre></div>
</div>
<p><a class="reference internal" href="_images/Phoebe_error.png"><img alt="image21" src="_images/Phoebe_error.png" style="width: 49.0%;" /></a> <a class="reference internal" href="_images/Phoebe_height.png"><img alt="image22" src="_images/Phoebe_height.png" style="width: 49.0%;" /></a></p>
</li>
<li><p>mapsize: The size of figure, in cm. It must be a list with two
values. Default = [46.0, 38.0].</p></li>
<li><p>cpoints: Interval for the small points marking the center of shadow,
in seconds. Default=60. To change the color of these points, the name
of the color must be given to ptcolor.</p></li>
<li><p>alpha: The transparency of the night shade, where 0.0 is full
transparency and 1.0 is full black. Default = 0.2.</p></li>
<li><p>fmt: The format to save the image. It is parsed directly by
matplotlib.pyplot. Default = ’png’.</p></li>
<li><p>dpi: “Dots per inch”. It defines the quality of the image. Default =
100.</p></li>
<li><p>nscale, cscale, sscale and pscale: Arbitrary scale for the size for
the name of the site, for the name of the country, for the size of
point of the site, and the size of the points that represent the
center of the shadow, respectively. This scale is arbitrary and is
proportional to the size of the image.</p></li>
<li><p>lncolor, outcolor: To change the color of the line that represents
the limits of the shadow over Earth and the color of the lines that
represents the limits of the shadow outside Earth, respectively.</p></li>
</ul>
</div>
</div>
</div>
<div class="section" id="python-hints-tips-and-tools-for-users-sec-python-hints">
<h1>Python hints, tips and tools (for users) [Sec:Python_hints]<a class="headerlink" href="#python-hints-tips-and-tools-for-users-sec-python-hints" title="Permalink to this headline">¶</a></h1>
<p>Here we will describe some hints ant tips for python usage with SORA.
Please feel free to send us any T&amp;H you thing it is usefull.</p>
<div class="section" id="reporting-a-bur-or-issue-subsec-tips-report-bug">
<h2>Reporting a bur or issue [SubSec:tips_report_bug]<a class="headerlink" href="#reporting-a-bur-or-issue-subsec-tips-report-bug" title="Permalink to this headline">¶</a></h2>
<p>The user has a few different ways to report problems and bugs in the
code. Preferably using GITm but one can either report via email to the
developers or via SLACK (for LIneA members) on channel #sora. Using GIT
follow the steps:</p>
<ol class="arabic simple">
<li><p>Login into your GIT account on <a class="reference external" href="https://github.com/">https://github.com/</a></p></li>
<li><p>Change to the SORA repository</p></li>
<li><p>Click on “Issues” and then on the button “New Issue”.</p></li>
<li><p>Put a title and a description of a problem, bug or error you are
facing with SORA and submit.</p></li>
<li><p>The developers team will work on a solution and the fix will be
available in a future release.</p></li>
</ol>
</div>
<div class="section" id="jupyter-notebooks-subsec-tips-jupyter-notebooks">
<h2>Jupyter Notebooks [SubSec:tips_jupyter_notebooks]<a class="headerlink" href="#jupyter-notebooks-subsec-tips-jupyter-notebooks" title="Permalink to this headline">¶</a></h2>
<p>Jupyter Notebook is a web-based interactive computational environment.
They are made of an ordered list of input/output cells which can contain
code, text (using Markdown), plots etc.</p>
<p>Jupyter Notebook is installed by default if you use Anaconda. However,
JupyterLab may not.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>$ conda install -c conda-forge jupyterlab
</pre></div>
</div>
<p>Alternatively, using pip:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>$ pip install jupyterlab
</pre></div>
</div>
<p>Once you have it installed it can be launched as follows</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span># Jupyter Notebook:
$ jupyter notebook
# or lauching a specific file locally:
$ jupyter notebook file.ipynb

# JupyterLab:
$ jupyter lab
</pre></div>
</div>
<p>JupyterLab provides flexible building blocks for interactive,
exploratory computing, compared to the jupyter notebook interface:
<a class="reference external" href="https://jupyterlab.readthedocs.io/en/stable/user/interface.html">https://jupyterlab.readthedocs.io/en/stable/user/interface.html</a></p>
<p>Some shortcuts:</p>
<ul class="simple">
<li><p>Run cell: shift + enter</p></li>
<li><p>Run cell and create a new below: ctrl + enter</p></li>
<li><p>Change to Markdown: m</p></li>
<li><p>Add cell above: a</p></li>
<li><p>Delete cell: d + d</p></li>
<li><p>Add cell below: b</p></li>
</ul>
<dl class="footnote brackets">
<dt class="label" id="id3"><span class="brackets">1</span></dt>
<dd><p>References given here are the ones up to the first version of SORA on
May/2020. The international collaboration published many other works
after that.</p>
</dd>
<dt class="label" id="id4"><span class="brackets">2</span></dt>
<dd><p>Born &amp; Wolf 1980 -
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1980poet.book.....B/abstract">https://ui.adsabs.harvard.edu/abs/1980poet.book…..B/abstract</a></p>
</dd>
<dt class="label" id="id5"><span class="brackets">3</span></dt>
<dd><p>Gaia Collaboration 2016, 2016a and 2018. Mission:
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2016A%26A...595A...1G/abstract">https://ui.adsabs.harvard.edu/abs/2016A%26A…595A…1G/abstract</a>;
DR1:
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2016A%26A...595A...2G/abstract">https://ui.adsabs.harvard.edu/abs/2016A%26A…595A…2G/abstract</a>;
DR2: <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2018A%26A...616A...1G/abstract">https://ui.adsabs.harvard.edu/abs/2018A%26A…616A…1G/abstract</a></p>
</dd>
<dt class="label" id="id6"><span class="brackets">4</span></dt>
<dd><p>Zacharias et al. 2004 -
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2004AAS...205.4815Z/abstract">https://ui.adsabs.harvard.edu/abs/2004AAS…205.4815Z/abstract</a></p>
</dd>
<dt class="label" id="id7"><span class="brackets">5</span></dt>
<dd><p>van Belle 1999 -
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1999PASP..111.1515V/abstract">https://ui.adsabs.harvard.edu/abs/1999PASP..111.1515V/abstract</a></p>
</dd>
<dt class="label" id="id8"><span class="brackets">6</span></dt>
<dd><p>Kervella et al. 2004 -
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2004A%26A...426..297K/abstract">https://ui.adsabs.harvard.edu/abs/2004A%26A…426..297K/abstract</a></p>
</dd>
<dt class="label" id="id9"><span class="brackets"><a class="fn-backref" href="#id1">7</a></span></dt>
<dd><p>In Windows systems, once the user installs Anaconda, it is possible
to access a unix-like terminal and do this procedure.</p>
</dd>
<dt class="label" id="id10"><span class="brackets"><a class="fn-backref" href="#id2">8</a></span></dt>
<dd><p>When facing any issue, the user can try installing each package
individually, instead of all packages in the same command line.</p>
</dd>
</dl>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="examples/Tutorial_SORAv0.1_ChiSquare.html" class="btn btn-neutral float-right" title="ChiSquare Object Class" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="input_output.html" class="btn btn-neutral float-left" title="Input and Outputs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, SORA Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>