

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Modules &mdash; Stellar Occultation Reduction Analysis develop documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="SORA Getting Started" href="examples/Tutorial_SORAv0.2_GettingStarted.html" />
    <link rel="prev" title="About Us" href="team.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> Stellar Occultation Reduction Analysis
          

          
          </a>

          
            
            
              <div class="version">
                0.2.dev0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Details:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="overview.html">SORA Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="license.html">Using and Citing SORA</a></li>
<li class="toctree-l1"><a class="reference internal" href="install.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="releases.html">Releases</a></li>
<li class="toctree-l1"><a class="reference internal" href="team.html">About Us</a></li>
</ul>
<p class="caption"><span class="caption-text">Code:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Modules</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#body">Body</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-body-class">The Body Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#physicaldata-class">PhysicalData Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sora.body.utils">Module <cite>utils</cite></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#ephem">Ephem</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-ephemplanete-class">The EphemPlanete Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-ephemhorizons-class">The EphemHorizons Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-ephemkernel-class">The EphemKernel Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Module <cite>utils</cite></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#star">Star</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-star-class">The Star Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Module <cite>utils</cite></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#prediction">Prediction</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-sora.prediction.core">Prediction Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sora.prediction.occmap">Plot Occultation Map</a></li>
<li class="toctree-l3"><a class="reference internal" href="#predictiontable-cbject">PredictionTable Cbject</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#observer">Observer</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-observer-class">The Observer Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Module <cite>utils</cite></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lightcurve">LightCurve</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-lightcurve-class">The LightCurve Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sora.lightcurve.occdetect">Occutation Detection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sora.lightcurve.utils">Module’s <cite>utils</cite></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#occultation">Occultation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#the-occultation-class">The Occultation Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-chord-class">The Chord Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#the-chordlist-class">The Chordlist Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fit-ellipse">Fit Ellipse</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id4">Module <cite>utils</cite></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#extra">Extra</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#chisquare-class">ChiSquare Class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-sora.extra.plots">Plot ellipse</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id5">Module <cite>utils</cite></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples/Tutorial_SORAv0.2_GettingStarted.html">SORA Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="jupyters.html">Jupyter-Notebook Guidelines</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Stellar Occultation Reduction Analysis</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Modules</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/sora.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<a class="reference internal image-reference" href="_images/SORA_logo.png" id="sec-install"><img alt="SORA: Stellar Occultation Reduction and Analysis" class="align-center" id="sec-install" src="_images/SORA_logo.png" style="width: 500px;" /></a>
<div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
<div class="section" id="modules">
<h1>Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h1>
<p>SORA is a Python-based, object-oriented package for optimal analysis of
stellar occultation data. The user can use this package to build pipelines
to analyse their stellar occultation’s data. Here t follows the details for
each object class: <strong>Body</strong>, <strong>Ephem</strong>, <strong>Star</strong>, <strong>PredictionTable</strong>,
<strong>Observer</strong>, <strong>LightCurve</strong>, <strong>Occultation</strong> and <strong>ChiSquare</strong>.</p>
<div class="section" id="body">
<h2>Body<a class="headerlink" href="#body" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-body-class">
<h3>The Body Class<a class="headerlink" href="#the-body-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.Body">
<em class="property">class </em><code class="sig-prename descclassname">sora.</code><code class="sig-name descname">Body</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">database</span><span class="o">=</span><span class="default_value">'auto'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/body/core.html#Body"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Body" title="Permalink to this definition">¶</a></dt>
<dd><p>Class that contains and manages the information of the body.</p>
<dl class="py attribute">
<dt id="sora.Body.name">
<code class="sig-name descname">name</code><a class="headerlink" href="#sora.Body.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the object. It can be the used <cite>spkid</cite> or <cite>designation
number</cite> to query the SBDB (Small-Body DataBase). In this case, the name
is case insensitive.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite>, required</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.database">
<code class="sig-name descname">database</code><a class="headerlink" href="#sora.Body.database" title="Permalink to this definition">¶</a></dt>
<dd><p>The database to query the object. It can be <code class="docutils literal notranslate"><span class="pre">satdb</span></code> for our temporary
hardcoded satellite database, or <code class="docutils literal notranslate"><span class="pre">'sbdb'</span></code> to query on the SBDB. If
database is set as <code class="docutils literal notranslate"><span class="pre">auto</span></code> it will try first with <code class="docutils literal notranslate"><span class="pre">satdb</span></code>,
then <code class="docutils literal notranslate"><span class="pre">sbdb</span></code>. If the user wants to use their own information,
database must be given as <code class="docutils literal notranslate"><span class="pre">None</span></code>. In this case, <cite>spkid</cite> parameter
must be given.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite>, optional, default=’auto’</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.ephem">
<code class="sig-name descname">ephem</code><a class="headerlink" href="#sora.Body.ephem" title="Permalink to this definition">¶</a></dt>
<dd><p>An Ephem Class that contains information about the ephemeris. It can be
“horizons” to automatically defined an EphemHorizons object or a list of
kernels to automatically define an EphemKernel object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>sora.EphemKernel</cite>, <cite>sora.EphemHorizons</cite>, <cite>sora.EphemJPL</cite>, <cite>sora.EphemPlanete</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.orbit_class">
<code class="sig-name descname">orbit_class</code><a class="headerlink" href="#sora.Body.orbit_class" title="Permalink to this definition">¶</a></dt>
<dd><p>It defines the Orbital class of the body. It can be <code class="docutils literal notranslate"><span class="pre">TNO</span></code>,
<code class="docutils literal notranslate"><span class="pre">Satellite</span></code>, <code class="docutils literal notranslate"><span class="pre">Centaur</span></code>, <code class="docutils literal notranslate"><span class="pre">comet</span></code>, <code class="docutils literal notranslate"><span class="pre">asteroid</span></code>, <code class="docutils literal notranslate"><span class="pre">trojan</span></code>, <code class="docutils literal notranslate"><span class="pre">neo</span></code>,
and <code class="docutils literal notranslate"><span class="pre">planet</span></code>. It is important for a better characterization of the
object. If a different value is given, it will be defined as
<code class="docutils literal notranslate"><span class="pre">unclassified</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.spkid">
<code class="sig-name descname">spkid</code><a class="headerlink" href="#sora.Body.spkid" title="Permalink to this definition">¶</a></dt>
<dd><p>If <code class="docutils literal notranslate"><span class="pre">database=None</span></code>, the user must give a <cite>spkid</cite> or an <cite>ephem</cite>
which has the <cite>spkid</cite> parameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite>, <cite>int</cite>, <cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.albedo">
<code class="sig-name descname">albedo</code><a class="headerlink" href="#sora.Body.albedo" title="Permalink to this definition">¶</a></dt>
<dd><p>The albedo of the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>float</cite>, <cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.H">
<code class="sig-name descname">H</code><a class="headerlink" href="#sora.Body.H" title="Permalink to this definition">¶</a></dt>
<dd><p>The absolute magnitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>float</cite>, <cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.G">
<code class="sig-name descname">G</code><a class="headerlink" href="#sora.Body.G" title="Permalink to this definition">¶</a></dt>
<dd><p>The phase slope.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>float</cite>, <cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.diameter">
<code class="sig-name descname">diameter</code><a class="headerlink" href="#sora.Body.diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>The diameter of the object, in km.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>float</cite>, <cite>int</cite>, <cite>astropy.quantity.Quantity</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.density">
<code class="sig-name descname">density</code><a class="headerlink" href="#sora.Body.density" title="Permalink to this definition">¶</a></dt>
<dd><p>The density of the object, in g/cm³.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>float</cite>, <cite>int</cite>, <cite>astropy.quantity.Quantity</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.GM">
<code class="sig-name descname">GM</code><a class="headerlink" href="#sora.Body.GM" title="Permalink to this definition">¶</a></dt>
<dd><p>The Standard Gravitational Parameter, in km³/s².</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>float</cite>, <cite>int</cite>, <cite>astropy.quantity.Quantity</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.rotation">
<code class="sig-name descname">rotation</code><a class="headerlink" href="#sora.Body.rotation" title="Permalink to this definition">¶</a></dt>
<dd><p>The Rotation of the object, in hours.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>float</cite>, <cite>int</cite>, <cite>astropy.quantity.Quantity</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.pole">
<code class="sig-name descname">pole</code><a class="headerlink" href="#sora.Body.pole" title="Permalink to this definition">¶</a></dt>
<dd><p>The Pole coordinates of the object. It can be a <cite>SkyCoord object</cite> or a
string in the format <code class="docutils literal notranslate"><span class="pre">'hh</span> <span class="pre">mm</span> <span class="pre">ss.ss</span> <span class="pre">+dd</span> <span class="pre">mm</span> <span class="pre">ss.ss'</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite>, <cite>astropy.coordinates.SkyCoord</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.BV">
<code class="sig-name descname">BV</code><a class="headerlink" href="#sora.Body.BV" title="Permalink to this definition">¶</a></dt>
<dd><p>The B-V color.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>float</cite>, <cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.UB">
<code class="sig-name descname">UB</code><a class="headerlink" href="#sora.Body.UB" title="Permalink to this definition">¶</a></dt>
<dd><p>The U-B color.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>float</cite>, <cite>int</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.smass">
<code class="sig-name descname">smass</code><a class="headerlink" href="#sora.Body.smass" title="Permalink to this definition">¶</a></dt>
<dd><p>The spectral type in SMASS classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Body.tholen">
<code class="sig-name descname">tholen</code><a class="headerlink" href="#sora.Body.tholen" title="Permalink to this definition">¶</a></dt>
<dd><p>The spectral type in Tholen classification.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The following attributes are are returned from the Small-Body DataBase when
<code class="docutils literal notranslate"><span class="pre">database='sbdb'</span></code> or from our temporary hardcoded Satellite DataBase when
<code class="docutils literal notranslate"><span class="pre">database='satdb'</span></code>:</p>
<p><cite>orbit_class</cite>, <cite>spkid</cite>, <cite>albedo</cite>, <cite>H</cite>, <cite>G</cite>, <cite>diameter</cite>, <cite>density</cite>, <cite>GM</cite>,
<cite>rotation</cite>, <cite>pole</cite>, <cite>BV</cite>, <cite>UB</cite>, <cite>smass</cite>, and <cite>tholen</cite>.</p>
<p>These are physical parameters the user can give to the object. If a query is
made and user gives a parameter, the parameter given by the user is defined
in the <em>Body</em> object.</p>
</div>
<dl class="py method">
<dt id="sora.Body.__from_local">
<code class="sig-name descname">__from_local</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">spkid</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sora.Body.__from_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines Body object with default values for mode=’local’.</p>
</dd></dl>

<dl class="py method">
<dt id="sora.Body.__from_sbdb">
<code class="sig-name descname">__from_sbdb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="headerlink" href="#sora.Body.__from_sbdb" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches the object in the SBDB and defines its physical parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<cite>str</cite>) – The <cite>name</cite>, <cite>spkid</cite> or <cite>designation number</cite> of the Small Body.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Body.apparent_magnitude">
<code class="sig-name descname">apparent_magnitude</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/body/core.html#Body.apparent_magnitude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Body.apparent_magnitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the object’s apparent magnitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Reference time to calculate the object’s apparent magnitude.
It can be a string in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ap_mag</strong> – Object apparent magnitude.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Body.get_pole_position_angle">
<code class="sig-name descname">get_pole_position_angle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/body/core.html#Body.get_pole_position_angle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Body.get_pole_position_angle" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the pole position angle and the aperture angle relative to
the geocenter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Time from which to calculate the position.
It can be a string in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>position_angle, aperture_angle</strong> – Position angle and aperture angle of the object’s pole, in degrees.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>float</cite> array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="physicaldata-class">
<h3>PhysicalData Class<a class="headerlink" href="#physicaldata-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.body.PhysicalData">
<em class="property">class </em><code class="sig-prename descclassname">sora.body.</code><code class="sig-name descname">PhysicalData</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">value</span></em>, <em class="sig-param"><span class="n">uncertainty</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">reference</span><span class="o">=</span><span class="default_value">'User'</span></em>, <em class="sig-param"><span class="n">notes</span><span class="o">=</span><span class="default_value">''</span></em>, <em class="sig-param"><span class="n">unit</span><span class="o">=</span><span class="default_value">Unit(dimensionless)</span></em>, <em class="sig-param"><span class="n">raise_error</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/body/meta.html#PhysicalData"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.body.PhysicalData" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines PhysicalData with uncertainty, reference and notes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It inherits from astropy.units.quantity.Quantity().</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<cite>str</cite>) – The name representing the corresponding physical parameter.</p></li>
<li><p><strong>value</strong> (<cite>int</cite>, <cite>float</cite>, <cite>str</cite>, <cite>~numpy.ndarray</cite>, <cite>astropy.quantity.Quantity</cite>) – The numerical value of this quantity in the units given by unit.  If
a <cite>Quantity</cite>  (or any other valid object with a <code class="docutils literal notranslate"><span class="pre">unit</span></code> attribute),
creates a new <cite>Quantity</cite> object, converting to <cite>unit</cite> units as needed.
If a string, it is converted to a number or <cite>Quantity</cite>, depending on
whether a unit is present.</p></li>
<li><p><strong>uncertainty</strong> (<cite>int</cite>, <cite>float</cite>, <cite>str</cite>, <cite>~numpy.ndarray</cite>, <cite>astropy.quantity.Quantity</cite>, default=0) – The numerical value of this quantity in the units given by unit.  If
a <cite>Quantity</cite> (or any other valid object with a <code class="docutils literal notranslate"><span class="pre">unit</span></code> attribute),
creates a new <cite>Quantity</cite> object, converting to <cite>unit</cite> units as needed.
If a string, it is converted to a number or <cite>Quantity</cite>, depending on
whether a unit is present.</p></li>
<li><p><strong>reference</strong> (<cite>str</cite>, default=’User’) – A string stating the reference for the parameter value.</p></li>
<li><p><strong>notes</strong> (<cite>str</cite>, default=’’) – Any other important information about the physical parameter.</p></li>
<li><p><strong>unit</strong> (<cite>str</cite>, <cite>~astropy.units.UnitBase</cite> instance, default=’dimensionless’) – An object that represents the unit associated with the input value. Must
be an <cite>~astropy.units.UnitBase</cite> object or a string parsable by the
<code class="xref py py-mod docutils literal notranslate"><span class="pre">units</span></code> package.</p></li>
<li><p><strong>raise_error</strong> (<cite>bool</cite>, default=False) – If <code class="docutils literal notranslate"><span class="pre">value=None</span></code> or <code class="docutils literal notranslate"><span class="pre">raise_error=True</span></code> the function raises an error,
else <cite>value</cite> is redefined to <code class="docutils literal notranslate"><span class="pre">NaN</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-sora.body.utils">
<span id="module-utils"></span><h3>Module <cite>utils</cite><a class="headerlink" href="#module-sora.body.utils" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="sora.body.utils.apparent_magnitude">
<code class="sig-prename descclassname">sora.body.utils.</code><code class="sig-name descname">apparent_magnitude</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">H</span></em>, <em class="sig-param"><span class="n">G</span></em>, <em class="sig-param"><span class="n">dist</span></em>, <em class="sig-param"><span class="n">sundist</span></em>, <em class="sig-param"><span class="n">phase</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/body/utils.html#apparent_magnitude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.body.utils.apparent_magnitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the object’s apparent magnitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>H</strong> (<cite>int</cite>, <cite>float</cite>) – Absolute magnitude.</p></li>
<li><p><strong>G</strong> (<cite>int</cite>, <cite>float</cite>) – Slope parameter.</p></li>
<li><p><strong>dist</strong> (<cite>int</cite>, <cite>float</cite>) – Observer-object distance, in AU.</p></li>
<li><p><strong>sundist</strong> (<cite>int</cite>, <cite>float</cite>) – Sun-object distance, in AU.</p></li>
<li><p><strong>phase</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – Phase angle (Sun-Target-Observer), in degrees.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ap_mag</strong> – Apparent magnitude.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sora.body.utils.search_sbdb">
<code class="sig-prename descclassname">sora.body.utils.</code><code class="sig-name descname">search_sbdb</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/body/utils.html#search_sbdb"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.body.utils.search_sbdb" title="Permalink to this definition">¶</a></dt>
<dd><p>Searches JPL Small-Body DataBase to search for object information.</p>
<p>As the name implies, it searches only for Small Bodies. Planets and
satellites information are not retrieved by this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<cite>str</cite>) – The name of the object for the search. It can be the attributed <cite>spkid</cite>
or <cite>designation number</cite>. The name is case insensitive.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>sbdb</strong> – An ordered dictionary with the object information.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>The query is not an autocomplete search, so <code class="docutils literal notranslate"><span class="pre">name='Charikl'</span></code> will not find
Chariklo. If more than 1 object is found, the user is asked to select the
correct one (e.g: <code class="docutils literal notranslate"><span class="pre">name='neowise'</span></code>).</p>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="ephem">
<h2>Ephem<a class="headerlink" href="#ephem" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-ephemplanete-class">
<h3>The EphemPlanete Class<a class="headerlink" href="#the-ephemplanete-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.EphemPlanete">
<em class="property">class </em><code class="sig-prename descclassname">sora.</code><code class="sig-name descname">EphemPlanete</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ephem</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">spkid</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/ephem/core.html#EphemPlanete"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.EphemPlanete" title="Permalink to this definition">¶</a></dt>
<dd><p>Class used to simulate former Fortran programs <cite>ephem_planete</cite> and
<cite>fit_d2_ksi_eta</cite>.</p>
<dl class="py attribute">
<dt id="sora.EphemPlanete.ephem">
<code class="sig-name descname">ephem</code><a class="headerlink" href="#sora.EphemPlanete.ephem" title="Permalink to this definition">¶</a></dt>
<dd><p>Input file with JD (UTC), geocentric RA (deg), DEC (deg), and
distance (AU).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>file</cite>, required</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemPlanete.name">
<code class="sig-name descname">name</code><a class="headerlink" href="#sora.EphemPlanete.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the object to search in the JPL database.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite>, optional, default=None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemPlanete.radius">
<code class="sig-name descname">radius</code><a class="headerlink" href="#sora.EphemPlanete.radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Object radius, in km.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite>, optional, default: online database</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemPlanete.error_ra">
<code class="sig-name descname">error_ra</code><a class="headerlink" href="#sora.EphemPlanete.error_ra" title="Permalink to this definition">¶</a></dt>
<dd><p>Ephemeris RA*cosDEC error, in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite>, optional, default: online database</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemPlanete.error_dec">
<code class="sig-name descname">error_dec</code><a class="headerlink" href="#sora.EphemPlanete.error_dec" title="Permalink to this definition">¶</a></dt>
<dd><p>Ephemeris DEC error, in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite>, optional, default: online database</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemPlanete.mass">
<code class="sig-name descname">mass</code><a class="headerlink" href="#sora.EphemPlanete.mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Object mass, in kg.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite>, optional. default=0</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemPlanete.H">
<code class="sig-name descname">H</code><a class="headerlink" href="#sora.EphemPlanete.H" title="Permalink to this definition">¶</a></dt>
<dd><p>Object absolute magnitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite>, optional, default=NaN</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemPlanete.G">
<code class="sig-name descname">G</code><a class="headerlink" href="#sora.EphemPlanete.G" title="Permalink to this definition">¶</a></dt>
<dd><p>Object phase slope.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite>, optional, default=NaN</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.EphemPlanete.fit_d2_ksi_eta">
<code class="sig-name descname">fit_d2_ksi_eta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">star</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/ephem/core.html#EphemPlanete.fit_d2_ksi_eta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.EphemPlanete.fit_d2_ksi_eta" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits the projected position (orthographic projection) of the object in
the tangent sky plane relative to a star.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star</strong> (<cite>str</cite>, <cite>astropy.coordinates.SkyCoord</cite>) – The coordinate of the star in the same reference frame as the ephemeris.</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, optional, default=True) – Enable log printing.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.EphemPlanete.get_ksi_eta">
<code class="sig-name descname">get_ksi_eta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">star</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/ephem/core.html#EphemPlanete.get_ksi_eta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.EphemPlanete.get_ksi_eta" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the projected position (orthographic projection) of the object
in the tangent sky plane relative to a star.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>, required) – Reference time to calculate the position. It can be a string
in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p></li>
<li><p><strong>star</strong> (<cite>str</cite>, <cite>astropy.coordinates.SkyCoord</cite>, optional, default=None) – The coordinate of the star in the same reference frame as the ephemeris.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ksi, eta</strong> – Projected position (orthographic projection) of the object in the
tangent sky plane relative to a star.
<code class="docutils literal notranslate"><span class="pre">ksi</span></code> is in the North-South direction (North positive).
<code class="docutils literal notranslate"><span class="pre">eta</span></code> is in the East-West direction (East positive).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>float</cite> array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.EphemPlanete.get_position">
<code class="sig-name descname">get_position</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/ephem/core.html#EphemPlanete.get_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.EphemPlanete.get_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the object’s geocentric position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Time from which to calculate the position. It can be a string
in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coord</strong> – Astropy SkyCoord object with the coordinate at given time.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>astropy.coordinates.SkyCoord</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-ephemhorizons-class">
<h3>The EphemHorizons Class<a class="headerlink" href="#the-ephemhorizons-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.EphemHorizons">
<em class="property">class </em><code class="sig-prename descclassname">sora.</code><code class="sig-name descname">EphemHorizons</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">id_type</span><span class="o">=</span><span class="default_value">'smallbody'</span></em>, <em class="sig-param"><span class="n">spkid</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/ephem/core.html#EphemHorizons"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.EphemHorizons" title="Permalink to this definition">¶</a></dt>
<dd><p>Obtains the ephemeris from Horizons/JPL service.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Web tool URL: <a class="reference external" href="https://ssd.jpl.nasa.gov/horizons.cgi">https://ssd.jpl.nasa.gov/horizons.cgi</a></p>
</div>
<dl class="py attribute">
<dt id="sora.EphemHorizons.name">
<code class="sig-name descname">name</code><a class="headerlink" href="#sora.EphemHorizons.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name of the object to search in the JPL database.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite>, required</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemHorizons.id_type">
<code class="sig-name descname">id_type</code><a class="headerlink" href="#sora.EphemHorizons.id_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Type of object options: <code class="docutils literal notranslate"><span class="pre">smallbody</span></code>, <code class="docutils literal notranslate"><span class="pre">majorbody</span></code> (planets but
also anything that is not a small body), <code class="docutils literal notranslate"><span class="pre">designation</span></code>, <code class="docutils literal notranslate"><span class="pre">name</span></code>,
<code class="docutils literal notranslate"><span class="pre">asteroid_name</span></code>, <code class="docutils literal notranslate"><span class="pre">comet_name</span></code>, <code class="docutils literal notranslate"><span class="pre">id</span></code> (Horizons id number), or
<code class="docutils literal notranslate"><span class="pre">smallbody</span></code> (find the closest match under any id_type).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite>, default=’smallbody’</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemHorizons.radius">
<code class="sig-name descname">radius</code><a class="headerlink" href="#sora.EphemHorizons.radius" title="Permalink to this definition">¶</a></dt>
<dd><p>Object radius, in km.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite>, default: online database</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemHorizons.error_ra">
<code class="sig-name descname">error_ra</code><a class="headerlink" href="#sora.EphemHorizons.error_ra" title="Permalink to this definition">¶</a></dt>
<dd><p>Ephemeris RA*cosDEC error, in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite>, default: online database</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemHorizons.error_dec">
<code class="sig-name descname">error_dec</code><a class="headerlink" href="#sora.EphemHorizons.error_dec" title="Permalink to this definition">¶</a></dt>
<dd><p>Ephemeris DEC error, in arcsec.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite>, default: online database</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemHorizons.mass">
<code class="sig-name descname">mass</code><a class="headerlink" href="#sora.EphemHorizons.mass" title="Permalink to this definition">¶</a></dt>
<dd><p>Object mass, in kg.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite>, default=0</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemHorizons.H">
<code class="sig-name descname">H</code><a class="headerlink" href="#sora.EphemHorizons.H" title="Permalink to this definition">¶</a></dt>
<dd><p>Object absolute magnitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite>, default=NaN</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.EphemHorizons.G">
<code class="sig-name descname">G</code><a class="headerlink" href="#sora.EphemHorizons.G" title="Permalink to this definition">¶</a></dt>
<dd><p>Object phase slope.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite>, default=NaN</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.EphemHorizons.get_position">
<code class="sig-name descname">get_position</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/ephem/core.html#EphemHorizons.get_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.EphemHorizons.get_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the geocentric position of the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Reference time to calculate the position. It can be a string
in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coord</strong> – Astropy SkyCoord object with the object coordinates at the given time.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>astropy.coordinates.SkyCoord</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-ephemkernel-class">
<h3>The EphemKernel Class<a class="headerlink" href="#the-ephemkernel-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.EphemKernel">
<em class="property">class </em><code class="sig-prename descclassname">sora.</code><code class="sig-name descname">EphemKernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/ephem/core.html#EphemKernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.EphemKernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the ephemeris from BSP kernels.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<cite>str</cite>,  optional, default=None) – Name of the object to search in the JPL database.</p></li>
<li><p><strong>spkid</strong> (<cite>str</cite>, required) – <cite>spkid</cite> of the targeting object. Former ‘code’ (v0.1).</p></li>
<li><p><strong>kernels</strong> (<cite>list</cite>, required) – List of paths for kernels files.</p></li>
<li><p><strong>radius</strong> (<cite>int</cite>, <cite>float</cite>, optional, default: online database) – Object radius, in km.</p></li>
<li><p><strong>error_ra</strong> (<cite>int</cite>, <cite>float</cite>, optional, default: online database) – Ephemeris RA*cosDEC error, in arcsec .</p></li>
<li><p><strong>error_dec</strong> (<cite>int</cite>, <cite>float</cite>, optional, default: online database) – Ephemeris DEC error, in arcsec.</p></li>
<li><p><strong>mass</strong> (<cite>int</cite>, <cite>float</cite>, optional, default=0) – Object Mass, in kg.</p></li>
<li><p><strong>H</strong> (<cite>int</cite>, <cite>float</cite>, optional, default=NaN) – Object Absolute Magnitude.</p></li>
<li><p><strong>G</strong> (<cite>int</cite>, <cite>float</cite>, optional, default=NaN) – Object Phase slope.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt id="sora.EphemKernel.get_position">
<code class="sig-name descname">get_position</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/ephem/core.html#EphemKernel.get_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.EphemKernel.get_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the object geocentric position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Reference time to calculate the object position. It can be a string
in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coord</strong> – Astropy SkyCoord object with the object coordinates at the given time.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>astropy.coordinates.SkyCoord</cite></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="id1">
<h3>Module <cite>utils</cite><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-sora.ephem.utils"></span><dl class="py function">
<dt id="sora.ephem.utils.ephem_kernel">
<code class="sig-prename descclassname">sora.ephem.utils.</code><code class="sig-name descname">ephem_kernel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">target</span></em>, <em class="sig-param"><span class="n">observer</span></em>, <em class="sig-param"><span class="n">kernels</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/ephem/utils.html#ephem_kernel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.ephem.utils.ephem_kernel" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the ephemeris from kernel files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Reference instant to calculate ephemeris. It can be a string
in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p></li>
<li><p><strong>target</strong> (<cite>str</cite>) – IAU (kernel) code of the target.</p></li>
<li><p><strong>observer</strong> (<cite>str</cite>) – IAU (kernel) code of the observer.</p></li>
<li><p><strong>kernels</strong> (<cite>list</cite>, <cite>str</cite>) – List of paths for all the kernels.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>coord</strong> – ICRS coordinate of the target.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>astropy.coordinates.SkyCoord</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sora.ephem.utils.getBSPfromJPL">
<code class="sig-prename descclassname">sora.ephem.utils.</code><code class="sig-name descname">getBSPfromJPL</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">identifier</span></em>, <em class="sig-param"><span class="n">initial_date</span></em>, <em class="sig-param"><span class="n">final_date</span></em>, <em class="sig-param"><span class="n">email</span></em>, <em class="sig-param"><span class="n">directory</span><span class="o">=</span><span class="default_value">'./'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/ephem/utils.html#getBSPfromJPL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.ephem.utils.getBSPfromJPL" title="Permalink to this definition">¶</a></dt>
<dd><p>Downloads BSP files from JPL database.</p>
<p>BSP files, which have information to generate the ephemeris of the objects,
will be downloaded and named as (without spaces): ‘[identifier].bsp’.</p>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>It is not possible to download BSP files for Planets or Satellites.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>identifier</strong> (<cite>str</cite>, <cite>list</cite>) – <p>Identifier of the object(s).
It can be the <cite>name</cite>, <cite>number</cite> or <cite>SPK ID</cite>.
It can also be a list of objects.</p>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">'2137295'</span></code>, <code class="docutils literal notranslate"><span class="pre">'1999</span> <span class="pre">RB216'</span></code>, <code class="docutils literal notranslate"><span class="pre">'137295'</span></code>,
<code class="docutils literal notranslate"><span class="pre">['2137295',</span> <span class="pre">'136199',</span> <span class="pre">'1999</span> <span class="pre">RC216',</span> <span class="pre">'Chariklo']</span></code>.</p>
</p></li>
<li><p><strong>initial_date</strong> (<cite>str</cite>) – <p>Date the bsp file is to begin, within span <cite>1900-2100</cite>.</p>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">'2003-02-01'</span></code>, <code class="docutils literal notranslate"><span class="pre">'2003-3-5'</span></code>.</p>
</p></li>
<li><p><strong>final_date</strong> (<cite>str</cite>) – <p>Date the bsp file is to end, within span [1900-2100].
Must be more than 32 days later than <cite>initial_date</cite>.</p>
<p>Examples: <code class="docutils literal notranslate"><span class="pre">'2006-01-12'</span></code>, <code class="docutils literal notranslate"><span class="pre">'2006-1-12'</span></code>.</p>
</p></li>
<li><p><strong>email</strong> (<cite>str</cite>) – <p>User’s e-mail contact address.
Required by JPL web service.</p>
<p>Example: <code class="docutils literal notranslate"><span class="pre">username&#64;user.domain.name</span></code>.</p>
</p></li>
<li><p><strong>directory</strong> (<cite>str</cite>) – Directory path to save the bsp files.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="star">
<h2>Star<a class="headerlink" href="#star" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-star-class">
<h3>The Star Class<a class="headerlink" href="#the-star-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.Star">
<em class="property">class </em><code class="sig-prename descclassname">sora.</code><code class="sig-name descname">Star</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/star/core.html#Star"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Star" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a star.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>catalogue</strong> (<cite>str</cite>) – The catalogue to download data. It can be <code class="docutils literal notranslate"><span class="pre">'gaiadr2'</span></code> or <code class="docutils literal notranslate"><span class="pre">'gaiaedr3'</span></code>.</p></li>
<li><p><strong>code</strong> (<cite>str</cite>) – Gaia Source code for searching in VizieR.</p></li>
<li><p><strong>coord</strong> (<cite>str</cite>, <cite>astropy.coordinates.SkyCoord</cite>) – If code is not given, coord nust have the coordinates RA and DEC of the
star to search in VizieR: <code class="docutils literal notranslate"><span class="pre">'hh</span> <span class="pre">mm</span> <span class="pre">ss.ss</span> <span class="pre">+dd</span> <span class="pre">mm</span> <span class="pre">ss.ss'</span></code>.</p></li>
<li><p><strong>ra</strong> (<cite>int</cite>, <cite>float</cite>) – Right Ascension, in deg.</p></li>
<li><p><strong>dec</strong> (<cite>int</cite>, <cite>float</cite>) – Declination, in deg.</p></li>
<li><p><strong>parallax</strong> (<cite>int</cite>, <cite>float</cite>. default=0) – Parallax, in mas.</p></li>
<li><p><strong>pmra</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – Proper Motion in RA*, in mas/year.</p></li>
<li><p><strong>pmdec</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – Proper Motion in DEC, in mas/year.</p></li>
<li><p><strong>rad_vel</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – Radial Velocity, in km/s.</p></li>
<li><p><strong>epoch</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>, default=’J2000’) – Epoch of the coordinates.</p></li>
<li><p><strong>nomad</strong> (<cite>bool</cite>) – If True, it tries to download the magnitudes from NOMAD catalogue.</p></li>
<li><p><strong>bjones</strong> (<cite>bool</cite>, default=True) – If True, it uses de star distance from Bailer-Jones et al. (2018).</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, default=True) – If True, it prints the downloaded information</p></li>
<li><p><strong>local</strong> (<cite>bool</cite>, default=False) – If True, it uses the given coordinate in ‘coord’ as final coordinate.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The user can give either ‘coord’ or ‘ra’ and ‘dec’, but not both.</p>
<p>To download the coordinates from Gaia, “local” must be set as False
and the (“code”) or (“coord”) or (“ra” and “dec”) must be given.</p>
<p>All values downloaded from Gaia will replace the ones given by the user.</p>
</div>
<dl class="py method">
<dt id="sora.Star.add_offset">
<code class="sig-name descname">add_offset</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">da_cosdec</span></em>, <em class="sig-param"><span class="n">ddec</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/star/core.html#Star.add_offset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Star.add_offset" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds an offset to the star position.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>da_cosdec</strong> (<cite>int</cite>, <cite>float</cite>) – Offset in Delta_alpha_cos_delta, in mas.</p></li>
<li><p><strong>ddec</strong> (<cite>int</cite>, <cite>float</cite>) – Offset in Delta_delta, in mas.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Star.apparent_diameter">
<code class="sig-name descname">apparent_diameter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">distance</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'auto'</span></em>, <em class="sig-param"><span class="n">band</span><span class="o">=</span><span class="default_value">'V'</span></em>, <em class="sig-param"><span class="n">star_type</span><span class="o">=</span><span class="default_value">'sg'</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/star/core.html#Star.apparent_diameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Star.apparent_diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the apparent diameter of the star at a given distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distance</strong> (<cite>int</cite>, <cite>float</cite>) – Object geocentric distance, in AU.</p></li>
<li><p><strong>mode</strong> (<cite>str</cite>, default=’auto’) – <p>The mode to calculate the apparent diameter.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'user'</span></code>: calculates using user given diameter.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'gaia'</span></code>: calculates using diameter obtained from Gaia.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'kervella'</span></code>: calculates using Kervella equations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'van_belle'</span></code>: calculates using van Belle equations.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'auto'</span></code>: tries all the above methods until it is able to calculate diameter.</p></li>
</ul>
<p>The order of try is the same as shown above (user, Gaia, Kervella, Van Belle).</p>
</p></li>
<li><p><strong>band</strong> (<cite>str</cite>) – The band filter to calculate the diameter. If mode is <cite>kervella</cite>
or <cite>van_belle</cite>, the filter must be given, <code class="docutils literal notranslate"><span class="pre">'B'</span></code> or <code class="docutils literal notranslate"><span class="pre">'V'</span></code>.
If mode <cite>auto</cite>, <code class="docutils literal notranslate"><span class="pre">'V'</span></code> is selected.</p></li>
<li><p><strong>star_type</strong> (<cite>str</cite>) – <p>Type of star to calculate the diameter. If mode is <cite>van_belle</cite>,
the star type must be given. If mode is <cite>auto</cite>, <code class="docutils literal notranslate"><span class="pre">star_type='sg'</span></code>.</p>
<p>Accepted types:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">'sg'</span></code> for ‘Super Giant’.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'ms'</span></code> for ‘Main Sequence’.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'vs'</span></code> for ‘Variable Star’.</p></li>
</ul>
</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – If True, it prints the mode used by <cite>auto</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Star.barycentric">
<code class="sig-name descname">barycentric</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/star/core.html#Star.barycentric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Star.barycentric" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the position of the star using proper motion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Reference time to apply proper motion. It can be a string
in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Star.error_at">
<code class="sig-name descname">error_at</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/star/core.html#Star.error_at"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Star.error_at" title="Permalink to this definition">¶</a></dt>
<dd><p>Estimates the star position error at a given time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Reference time to project star error. It can be a string
in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>errors</strong> – In RA* and DEC.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Star.geocentric">
<code class="sig-name descname">geocentric</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/star/core.html#Star.geocentric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Star.geocentric" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the position of the star, propagating the position using
parallax and proper motion.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<cite>float, `astropy.time.Time</cite>) – Reference time to apply proper motion and calculate parallax. It can be a string
in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Star.kervella">
<code class="sig-name descname">kervella</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/star/core.html#Star.kervella"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Star.kervella" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the diameter of a star in mas using equations from Kervella et. al (2004).</p>
<p>See: A&amp;A Vol.  426, No.  1:.</p>
</dd></dl>

<dl class="py method">
<dt id="sora.Star.set_diameter">
<code class="sig-name descname">set_diameter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">diameter</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/star/core.html#Star.set_diameter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Star.set_diameter" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets an user diameter for the star, in mas.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>diameter</strong> (<cite>int</cite>, <cite>float</cite>) – Sets the user diameter of the star, in mas.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Star.set_magnitude">
<code class="sig-name descname">set_magnitude</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/star/core.html#Star.set_magnitude"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Star.set_magnitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the magnitudes of a star.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>band=value</strong> (<cite>str</cite>) – The star magnitude for given band. The band name can be any string
the user wants.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>To set the stars magnitude in the band G:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">set_magnitude</span><span class="p">(</span><span class="n">G</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>To set the star’s magnitude in the band K:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">set_magnitude</span><span class="p">(</span><span class="n">K</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
</pre></div>
</div>
<p>To set the star’s magnitude in a customized band:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">set_magnitude</span><span class="p">(</span><span class="n">newband</span><span class="o">=</span><span class="mi">6</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sora.Star.van_belle">
<code class="sig-name descname">van_belle</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/star/core.html#Star.van_belle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Star.van_belle" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the diameter of a star in mas using equations from van Belle (1999).</p>
<p>See: Publi. Astron. Soc. Pacific 111, 1515-1523:.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="id2">
<h3>Module <cite>utils</cite><a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-sora.star.utils"></span><dl class="py function">
<dt id="sora.star.utils.kervella">
<code class="sig-prename descclassname">sora.star.utils.</code><code class="sig-name descname">kervella</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">magB</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">magV</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">magK</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/star/utils.html#kervella"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.star.utils.kervella" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the diameter of a star in mas using equations from Kervella et. al (2004).</p>
<p>See: A&amp;A Vol. 426, No.  1:.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>magB</strong> (<cite>float</cite>, default=None) – The magnitude B of the star.</p></li>
<li><p><strong>magV</strong> (<cite>float</cite>, default=None) – The magnitude V of the star.</p></li>
<li><p><strong>magK</strong> (<cite>float</cite>, default=None) – The magnitudes K of the star.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If any of those values is ‘None’, ‘nan’ or higher than 49, it is not considered.</p>
</div>
</dd></dl>

<dl class="py function">
<dt id="sora.star.utils.van_belle">
<code class="sig-prename descclassname">sora.star.utils.</code><code class="sig-name descname">van_belle</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">magB</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">magV</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">magK</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/star/utils.html#van_belle"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.star.utils.van_belle" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the diameter of a star in mas using equations from van Belle (1999).</p>
<p>See: Publi. Astron. Soc. Pacific 111, 1515-1523:.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>magB</strong> (<cite>float</cite>, default=None) – The magnitude B of the star.</p></li>
<li><p><strong>magV</strong> (<cite>float</cite>, default=None) – The magnitude V of the star.</p></li>
<li><p><strong>magK</strong> (<cite>float</cite>, default=None) – The magnitude K of the star.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If any of those values is ‘None’, ‘nan’ or higher than 49, it is not considered.</p>
</div>
</dd></dl>

</div>
</div>
<div class="section" id="prediction">
<h2>Prediction<a class="headerlink" href="#prediction" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-sora.prediction.core">
<span id="prediction-functions"></span><h3>Prediction Functions<a class="headerlink" href="#module-sora.prediction.core" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="sora.prediction.core.occ_params">
<code class="sig-prename descclassname">sora.prediction.core.</code><code class="sig-name descname">occ_params</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">star</span></em>, <em class="sig-param"><span class="n">ephem</span></em>, <em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">n_recursions</span><span class="o">=</span><span class="default_value">5</span></em>, <em class="sig-param"><span class="n">max_tdiff</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/prediction/core.html#occ_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.prediction.core.occ_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the parameters of the occultation, as instant, CA, PA.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star</strong> (<cite>sora.Star</cite>) – The coordinate of the star in the same reference frame as the ephemeris.
It must be a Star object.</p></li>
<li><p><strong>ephem</strong> (<cite>sora.Ephem*</cite>) – Object ephemeris. It must be an Ephemeris object.</p></li>
<li><p><strong>time</strong> (<cite>astropy.time.Time</cite>) – Time close to occultation epoch to calculate occultation parameters.</p></li>
<li><p><strong>n_recursions</strong> (<cite>int</cite>, default=5) – The number of attempts to try obtain prediction parameters in case the
event is outside the previous range of time.</p></li>
<li><p><strong>max_tdiff</strong> (<cite>int</cite>, default=None) – Maximum difference from given time it will attempt to identify the
occultation, in minutes. If given, ‘n_recursions’ is ignored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p><strong>Oredered list</strong> –</p>
<ul class="simple">
<li><p>Instant of CA (Time): Instant of Closest Approach.</p></li>
<li><p>CA (arcsec): Distance of Closest Approach.</p></li>
<li><p>PA (deg): Position Angle at Closest Approach.</p></li>
<li><p>vel (km/s): Velocity of the occultation.</p></li>
<li><p>dist (AU): the object geocentric distance.</p></li>
</ul>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sora.prediction.core.prediction">
<code class="sig-prename descclassname">sora.prediction.core.</code><code class="sig-name descname">prediction</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_beg</span></em>, <em class="sig-param"><span class="n">time_end</span></em>, <em class="sig-param"><span class="n">body</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ephem</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mag_lim</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">catalogue</span><span class="o">=</span><span class="default_value">'gaiaedr3'</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">60</span></em>, <em class="sig-param"><span class="n">divs</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">sigma</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">radius</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/prediction/core.html#prediction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.prediction.core.prediction" title="Permalink to this definition">¶</a></dt>
<dd><p>Predicts stellar occultations.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_beg</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>, required) – Initial time for prediction.</p></li>
<li><p><strong>time_end</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>, required) – Final time for prediction.</p></li>
<li><p><strong>body</strong> (<cite>sora.Body</cite>, <cite>str</cite>, default=None) – Object that will occult the stars. It must be a Body object or its name
to search in the Small Body Database.</p></li>
<li><p><strong>ephem</strong> (<cite>sora.Ephem</cite>, default=None) – object ephemeris. It must be an Ephemeris object.</p></li>
<li><p><strong>mag_lim</strong> (<cite>int</cite>, <cite>float</cite>, default=None) – Faintest Gmag allowed in the search.</p></li>
<li><p><strong>catalogue</strong> (<cite>str</cite>, default=’gaiaedr3’) – The catalogue to download data. It can be <code class="docutils literal notranslate"><span class="pre">'gaiadr2'</span></code> or <code class="docutils literal notranslate"><span class="pre">'gaiaedr3'</span></code>.</p></li>
<li><p><strong>step</strong> (<cite>int</cite>, <cite>float</cite>, default=60) – Step, in seconds, of ephem times for search</p></li>
<li><p><strong>divs</strong> (<cite>int</cite>, default=1) – Number of regions the ephemeris will be split for better search of
occultations.</p></li>
<li><p><strong>sigma</strong> (<cite>int</cite>, <cite>float</cite>, default=1) – Ephemeris error sigma for search off-Earth.</p></li>
<li><p><strong>radius</strong> (<cite>int</cite>, <cite>float</cite>, default=None) – The radius of the body. It is important if not defined in body or ephem.</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, default=True) – To show what is being done at the moment.</p></li>
</ul>
</dd>
</dl>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When instantiating with “body” and “ephem”, the user may call the function
in 3 ways:</p>
<p>1 - With “body” and “ephem”.</p>
<p>2 - With only “body”. In this case, the “body” parameter must be a Body
object and have an ephemeris associated (see Body documentation).</p>
<p>3 - With only “ephem”. In this case, the “ephem” parameter must be one of
the Ephem Classes and have a name (see Ephem documentation) to search
for the body in the Small Body Database.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>PredictionTable with the occultation params for each event.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>sora.prediction.PredictionTable</cite></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-sora.prediction.occmap">
<span id="plot-occultation-map"></span><h3>Plot Occultation Map<a class="headerlink" href="#module-sora.prediction.occmap" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="sora.prediction.occmap.plot_occ_map">
<code class="sig-prename descclassname">sora.prediction.occmap.</code><code class="sig-name descname">plot_occ_map</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">radius</span></em>, <em class="sig-param"><span class="n">coord</span></em>, <em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">ca</span></em>, <em class="sig-param"><span class="n">pa</span></em>, <em class="sig-param"><span class="n">vel</span></em>, <em class="sig-param"><span class="n">dist</span></em>, <em class="sig-param"><span class="n">mag</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">longi</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/prediction/occmap.html#plot_occ_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.prediction.occmap.plot_occ_map" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the map of the occultation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<cite>str</cite>) – Name of the object.</p></li>
<li><p><strong>radius</strong> (<cite>int</cite>, <cite>float</cite>) – Radius of the object, in km.</p></li>
<li><p><strong>coord</strong> (<cite>str</cite>, <cite>astropy.coordinates.SkyCoord</cite>) – Coordinates of the star (<code class="docutils literal notranslate"><span class="pre">&quot;hh</span> <span class="pre">mm</span> <span class="pre">ss.sss</span> <span class="pre">dd</span> <span class="pre">mm</span> <span class="pre">ss.sss&quot;</span></code> or
<code class="docutils literal notranslate"><span class="pre">&quot;hh.hhhhhhhh</span> <span class="pre">dd.dddddddd&quot;</span></code>).</p></li>
<li><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Instant of Closest Approach (iso or isot format).</p></li>
<li><p><strong>ca</strong> (<cite>int</cite>, <cite>float</cite>) – Closest Approach Distance, in arcsec.</p></li>
<li><p><strong>pa</strong> (<cite>int</cite>, <cite>float</cite>) – Position Angle at C/A, in degrees.</p></li>
<li><p><strong>vel</strong> (<cite>int</cite>, <cite>float</cite>) – Velocity of the event, in km/s.</p></li>
<li><p><strong>dist</strong> (<cite>int</cite>, <cite>float</cite>) – Object distance at C/A, in AU.</p></li>
<li><p><strong>mag</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – Mag* = Normalized magnitude to vel=20km/s.</p></li>
<li><p><strong>longi</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – East longitude of sub-planet point, deg, positive towards East.</p></li>
<li><p><strong>nameimg</strong> (<cite>str</cite>) – Change the name of the imaged saved.</p></li>
<li><p><strong>path</strong> (<cite>str</cite>) – Path to a directory where to save map.</p></li>
<li><p><strong>resolution</strong> (<cite>int</cite>, default=2) – <p>Cartopy feature resolution.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> means a resolution of “10m”;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> a resolution of “50m”;</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> a resolution of “100m”.</p></li>
</ul>
</p></li>
<li><p><strong>states</strong> (<cite>bool</cite>) – If True, plots the states borders of the countries. The states
of some countries will only be shown depending on the resolution.</p></li>
<li><p><strong>zoom</strong> (<cite>int</cite>, <cite>float</cite>) – Zooms in or out of the map.</p></li>
<li><p><strong>centermap_geo</strong> (<cite>list</cite>, default=None) – Center the map given coordinates in longitude and latitude. It must be
a list with two numbers.</p></li>
<li><p><strong>centermap_delta</strong> (<cite>list</cite>, default=None) – Displace the center of the map given displacement in X and Y, in km.
It must be a list with two numbers.</p></li>
<li><p><strong>centerproj</strong> (<cite>list</cite>) – Rotates the Earth to show occultation with the center projected at a
given longitude and latitude. It must be a list with two numbers.</p></li>
<li><p><strong>labels</strong> (<cite>bool</cite>, default=True) – Plots text above and below the map with the occultation parameters.</p></li>
<li><p><strong>meridians</strong> (<cite>int</cite>, default=30) – Plots lines representing the meridians for given interval, in degrees.</p></li>
<li><p><strong>parallels</strong> (<cite>int</cite>, default=30) – Plots lines representing the parallels for given interval, in degrees.</p></li>
<li><p><strong>sites</strong> (<cite>dict</cite>) – Plots site positions in map. It must be a python dictionary where the
key is  the <cite>name</cite> of the site, and the value is a list with <cite>longitude</cite>,
<cite>latitude</cite>, <cite>delta_x</cite>, <cite>delta_y</cite> and <cite>color</cite>. <cite>delta_x</cite> and <cite>delta_y</cite>
are displacement, in km, from the point position of the site in the map
and the <cite>name</cite>. <cite>color</cite> is the color of the point.</p></li>
<li><p><strong>site_name</strong> (<cite>bool</cite>) – If True, it prints the name of the sites given, else it plots only the points.</p></li>
<li><p><strong>countries</strong> (<cite>dict</cite>) – Plots the names of countries. It must be a python dictionary where the
key is the name of the country and the value is a list with longitude
and latitude of the lower left part of the text.</p></li>
<li><p><strong>offset</strong> (<cite>list</cite>) – Applies an offset to the ephemeris, calculating new CA and instant of
CA. It is a pair of <cite>delta_RA*cosDEC</cite> and <cite>delta_DEC</cite>.</p></li>
<li><p><strong>mapstyle</strong> (<cite>int</cite>, default=1) – Define the color style of the map. <code class="docutils literal notranslate"><span class="pre">'1'</span></code> is the default black
and white scale. <code class="docutils literal notranslate"><span class="pre">'2'</span></code> is a colored map.</p></li>
<li><p><strong>error</strong> (<cite>int</cite>, <cite>float</cite>) – Ephemeris error in mas. It plots a dashed line representing radius + error.</p></li>
<li><p><strong>ercolor</strong> (<cite>str</cite>) – Changes the color of the lines of the error bar.</p></li>
<li><p><strong>ring</strong> (<cite>int</cite>, <cite>float</cite>) – Plots a dashed line representing the location of a ring. It is given
in km, from the center.</p></li>
<li><p><strong>rncolor</strong> (<cite>str</cite>) – Changes the color of ring lines.</p></li>
<li><p><strong>atm</strong> (<cite>int</cite>, <cite>float</cite>) – Plots a dashed line representing the location of an atmosphere. It is
given in km, from the center.</p></li>
<li><p><strong>atcolor</strong> (<cite>str</cite>) – Changes the color of atm lines.</p></li>
<li><p><strong>chord_delta</strong> (<cite>list</cite>) – List with distances from center to plot chords.</p></li>
<li><p><strong>chord_geo</strong> (<cite>2d-list</cite>) – List with pairs of coordinates to plot chords.</p></li>
<li><p><strong>chcolor</strong> (<cite>str</cite>, default=’grey’) – Color of the line of the chords.</p></li>
<li><p><strong>heights</strong> (<cite>list</cite>) – It plots a circular dashed line showing the locations where the observer
would observe the occultation at a given height above the horizons.
This must be a list.</p></li>
<li><p><strong>hcolor</strong> (<cite>str</cite>) – Changes the color of the height lines.</p></li>
<li><p><strong>mapsize</strong> (<cite>list</cite>, default= [46.0, 38.0]) – The size of figure, in cm. It must be a list with two values.</p></li>
<li><p><strong>cpoints</strong> (<cite>int</cite>, <cite>float</cite>, default=60) – Interval for the small points marking the center of shadow, in seconds.</p></li>
<li><p><strong>ptcolor</strong> (<cite>str</cite>) – Change the color of the center points.</p></li>
<li><p><strong>alpha</strong> (<cite>float</cite>, default=0.2) – The transparency of the night shade, where 0.0 is full transparency and
1.0 is full black.</p></li>
<li><p><strong>fmt</strong> (<cite>str</cite>, default:’png’) – The format to save the image. It is parsed directly by <cite>matplotlib.pyplot</cite>.</p></li>
<li><p><strong>dpi</strong> (<cite>int</cite>, default=100) – Resolution in “dots per inch”. It defines the quality of the image.</p></li>
<li><p><strong>lncolor</strong> (<cite>str</cite>) – Changes the color of the line that represents the limits of the shadow
over Earth.</p></li>
<li><p><strong>outcolor</strong> (<cite>str</cite>) – Changes the color of the lines that represents the limits of the shadow
outside Earth.</p></li>
<li><p><strong>scale</strong> (<cite>int</cite>, <cite>float</cite>) – Arbitrary scale for the size of the name of the site.</p></li>
<li><p><strong>cscale</strong> (<cite>int</cite>, <cite>float</cite>) – Arbitrary scale for the name of the country.</p></li>
<li><p><strong>sscale</strong> (<cite>int</cite>, <cite>float</cite>) – Arbitrary scale for the size of point of the site.</p></li>
<li><p><strong>pscale</strong> (<cite>int</cite>, <cite>float</cite>) – Arbitrary scale for the size of the points that represent the center of
the shadow.</p></li>
<li><p><strong>arrow</strong> (<cite>bool</cite>) – If True, it plots the arrow with the occultation direction.</p></li>
</ul>
</dd>
</dl>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Required parameters to plot an occultation map: ‘name’, ‘radius’, ‘coord’,
‘time’, ‘ca’, ‘pa’, ‘vel’, and ‘dist’.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parameters ‘mag’ and ‘longi’ are optional and only printed in label.
All other remaining parameters can be used to further customize the Map
configuration.</p>
<p>When producing the map, only one of ‘centermap_geo’ or ‘centermap_delta’
options can be used at a time.</p>
</div>
</dd></dl>

</div>
<div class="section" id="predictiontable-cbject">
<h3>PredictionTable Cbject<a class="headerlink" href="#predictiontable-cbject" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.prediction.PredictionTable">
<em class="property">class </em><code class="sig-prename descclassname">sora.prediction.</code><code class="sig-name descname">PredictionTable</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/prediction/table.html#PredictionTable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.prediction.PredictionTable" title="Permalink to this definition">¶</a></dt>
<dd><p>An Astropy Table object modified for Prediction purposes.</p>
<dl class="py attribute">
<dt id="sora.prediction.PredictionTable.Row">
<code class="sig-name descname">Row</code><a class="headerlink" href="#sora.prediction.PredictionTable.Row" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal notranslate"><span class="pre">PredictRow</span></code></p>
</dd></dl>

<dl class="py method">
<dt id="sora.prediction.PredictionTable.from_praia">
<em class="property">classmethod </em><code class="sig-name descname">from_praia</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/prediction/table.html#PredictionTable.from_praia"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.prediction.PredictionTable.from_praia" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a PredictionTable Table reading from a PRAIA table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<cite>str</cite>) – Path to the PRAIA table file.</p></li>
<li><p><strong>name</strong> (<cite>str</cite>) – Name of the Object of the prediction.</p></li>
<li><p><strong>radius</strong> (<cite>int</cite>, <cite>float</cite>, optional) – Object radius, in km.
If not given it’s searched in online database.
When not found online, the default is set to zero.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A PredictionTable object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>sora.prediction.PredictionTable</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.prediction.PredictionTable.keep_from_selected_images">
<code class="sig-name descname">keep_from_selected_images</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">path</span><span class="o">=</span><span class="default_value">'.'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/prediction/table.html#PredictionTable.keep_from_selected_images"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.prediction.PredictionTable.keep_from_selected_images" title="Permalink to this definition">¶</a></dt>
<dd><p>Keeps predictions which images were not deleted in given path.
This function uses the name of the images to identify predictions.
The name must be the automatic one generated by plot_occ_map().
The format of the image is not relevant.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>path</strong> (<cite>str</cite>) – Path where images are located.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.prediction.PredictionTable.plot_occ_map">
<code class="sig-name descname">plot_occ_map</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/prediction/table.html#PredictionTable.plot_occ_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.prediction.PredictionTable.plot_occ_map" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<cite>int</cite>, <cite>float</cite>) – The radius of the shadow. If not given it uses saved value.</p></li>
<li><p><strong>nameimg</strong> (<cite>str</cite>) – Change the name of the image saved.</p></li>
<li><p><strong>path</strong> (<cite>str</cite>) – Path to a directory where to save map.</p></li>
<li><p><strong>resolution</strong> (<cite>int</cite>, default=2) – </p></li>
<li><p><strong>feature resolution.</strong> (<em>Cartopy</em>) – </p></li>
<li><p><strong>1 means a resolution of &quot;10m&quot;;</strong> (<em>-</em>) – </p></li>
<li><p><strong>2 a resolution of &quot;50m&quot;;</strong> (<em>-</em>) – </p></li>
<li><p><strong>3 a resolution of &quot;100m&quot;.</strong> (<em>-</em>) – </p></li>
<li><p><strong>states</strong> (<cite>bool</cite>) – If True, plots the states borders of the countries. The states
of some countries will only be shown depending on the resolution.</p></li>
<li><p><strong>zoom</strong> (<cite>int</cite>, <cite>float</cite>) – Zooms in or out of the map.</p></li>
<li><p><strong>centermap_geo</strong> (<cite>list</cite>, default=None) – Center the map given coordinates in longitude and latitude. It must be
a list with two numbers.</p></li>
<li><p><strong>centermap_delta</strong> (<cite>list</cite>, default=None) – Displace the center of the map given displacement in X and Y, in km.
It must be a list with two numbers.</p></li>
<li><p><strong>centerproj</strong> (<cite>list</cite>) – Rotates the Earth to show occultation with the center projected at a
given longitude and latitude. It must be a list with two numbers.</p></li>
<li><p><strong>labels</strong> (<cite>bool</cite>, default=True) – Plots text above and below the map with the occultation parameters.</p></li>
<li><p><strong>meridians</strong> (<cite>int</cite>, default=30) – Plots lines representing the meridians for given interval, in degrees.</p></li>
<li><p><strong>parallels</strong> (<cite>int</cite>, default=30) – Plots lines representing the parallels for given interval, in degrees.</p></li>
<li><p><strong>sites</strong> (<cite>dict</cite>) – Plots site positions in map. It must be a python dictionary where the
key is  the <cite>name</cite> of the site, and the value is a list with <cite>longitude</cite>,
<cite>latitude</cite>, <cite>delta_x</cite>, <cite>delta_y</cite> and <cite>color</cite>. <cite>delta_x</cite> and <cite>delta_y</cite>
are displacement, in km, from the point position of the site in the map
and the <cite>name</cite>. <cite>color</cite> is the color of the point.</p></li>
<li><p><strong>site_name</strong> (<cite>bool</cite>) – If True, it prints the name of the sites given, else it plots only the points.</p></li>
<li><p><strong>countries</strong> (<cite>dict</cite>) – Plots the names of countries. It must be a python dictionary where the
key is the name of the country and the value is a list with longitude
and latitude of the lower left part of the text.</p></li>
<li><p><strong>offset</strong> (<cite>list</cite>) – Applies an offset to the ephemeris, calculating new CA and instant of
CA. It is a pair of <cite>delta_RA*cosDEC</cite> and <cite>delta_DEC</cite>.</p></li>
<li><p><strong>mapstyle</strong> (<cite>int</cite>, default=1) – Define the color style of the map. <code class="docutils literal notranslate"><span class="pre">'1'</span></code> is the default black
and white scale. <code class="docutils literal notranslate"><span class="pre">'2'</span></code> is a colored map.</p></li>
<li><p><strong>error</strong> (<cite>int</cite>, <cite>float</cite>) – Ephemeris error in mas. It plots a dashed line representing radius + error.</p></li>
<li><p><strong>ercolor</strong> (<cite>str</cite>) – Changes the color of the lines of the error bar.</p></li>
<li><p><strong>ring</strong> (<cite>int</cite>, <cite>float</cite>) – Plots a dashed line representing the location of a ring. It is given
in km, from the center.</p></li>
<li><p><strong>rncolor</strong> (<cite>str</cite>) – Changes the color of ring lines.</p></li>
<li><p><strong>atm</strong> (<cite>int</cite>, <cite>float</cite>) – Plots a dashed line representing the location of an atmosphere. It is
given in km, from the center.</p></li>
<li><p><strong>atcolor</strong> (<cite>str</cite>) – Changes the color of atm lines.</p></li>
<li><p><strong>chord_delta</strong> (<cite>list</cite>) – List with distances from center to plot chords.</p></li>
<li><p><strong>chord_geo</strong> (<cite>2d-list</cite>) – List with pairs of coordinates to plot chords.</p></li>
<li><p><strong>chcolor</strong> (<cite>str</cite>, default=’grey’) – Color of the line of the chords.</p></li>
<li><p><strong>heights</strong> (<cite>list</cite>) – It plots a circular dashed line showing the locations where the observer
would observe the occultation at a given height above the horizons.
This must be a list.</p></li>
<li><p><strong>hcolor</strong> (<cite>str</cite>) – Changes the color of the height lines.</p></li>
<li><p><strong>mapsize</strong> (<cite>list</cite>, default= [46.0, 38.0]) – The size of figure, in cm. It must be a list with two values.</p></li>
<li><p><strong>cpoints</strong> (<cite>int</cite>, <cite>float</cite>, default=60) – Interval for the small points marking the center of shadow, in seconds.</p></li>
<li><p><strong>ptcolor</strong> (<cite>str</cite>) – Change the color of the center points.</p></li>
<li><p><strong>alpha</strong> (<cite>float</cite>, default=0.2) – The transparency of the night shade, where 0.0 is full transparency and
1.0 is full black.</p></li>
<li><p><strong>fmt</strong> (<cite>str</cite>, default:’png’) – The format to save the image. It is parsed directly by <cite>matplotlib.pyplot</cite>.</p></li>
<li><p><strong>dpi</strong> (<cite>int</cite>, default=100) – Resolution in “dots per inch”. It defines the quality of the image.</p></li>
<li><p><strong>lncolor</strong> (<cite>str</cite>) – Changes the color of the line that represents the limits of the shadow
over Earth.</p></li>
<li><p><strong>outcolor</strong> (<cite>str</cite>) – Changes the color of the lines that represents the limits of the shadow
outside Earth.</p></li>
<li><p><strong>scale</strong> (<cite>int</cite>, <cite>float</cite>) – Arbitrary scale for the size of the name of the site.</p></li>
<li><p><strong>cscale</strong> (<cite>int</cite>, <cite>float</cite>) – Arbitrary scale for the name of the country.</p></li>
<li><p><strong>sscale</strong> (<cite>int</cite>, <cite>float</cite>) – Arbitrary scale for the size of point of the site.</p></li>
<li><p><strong>pscale</strong> (<cite>int</cite>, <cite>float</cite>) – Arbitrary scale for the size of the points that represent the center of
the shadow.</p></li>
<li><p><strong>arrow</strong> (<cite>bool</cite>) – If True, it plots the arrow with the occultation direction.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only one of centermap_geo and centermap_delta can be given.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="sora.prediction.PredictionTable.remove_occ">
<code class="sig-name descname">remove_occ</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">date</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/prediction/table.html#PredictionTable.remove_occ"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.prediction.PredictionTable.remove_occ" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes stellar occultations from table.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>date</strong> (<cite>str</cite>, <cite>list</cite>) – Date or list of dates of the occultation to be removed.
The dates mut be as shown in the ‘Epoch’ column. If the date is not
complete, the function will select all occultations that matches the
given string. For instance, <code class="docutils literal notranslate"><span class="pre">date='2020-06'</span></code> will remove all
occultations from the month of June 2020.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.prediction.PredictionTable.to_ow">
<code class="sig-name descname">to_ow</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ow_des</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'append'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/prediction/table.html#PredictionTable.to_ow"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.prediction.PredictionTable.to_ow" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes PredictionTable to OccultWatcher feeder update file format.
Tables will be saved in two files: “tableOccult_update.txt” and “LOG.dat”</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ow_des</strong> (<cite>str</cite>) – Occult Watcher designation for the object.</p></li>
<li><p><strong>mode</strong> (<cite>str</cite>, default=’append’) – Use <code class="docutils literal notranslate"><span class="pre">'append'</span></code> to append table to already existing file and
<code class="docutils literal notranslate"><span class="pre">'restart'</span></code> to overwrite existing file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.prediction.PredictionTable.to_praia">
<code class="sig-name descname">to_praia</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">filename</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/prediction/table.html#PredictionTable.to_praia"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.prediction.PredictionTable.to_praia" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes PredictionTable to PRAIA format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename</strong> (<cite>str</cite>) – Name of the file to save table.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="observer">
<h2>Observer<a class="headerlink" href="#observer" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-observer-class">
<h3>The Observer Class<a class="headerlink" href="#the-observer-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.Observer">
<em class="property">class </em><code class="sig-prename descclassname">sora.</code><code class="sig-name descname">Observer</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/observer/core.html#Observer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Observer" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines the observer object.</p>
<dl class="py attribute">
<dt id="sora.Observer.name">
<code class="sig-name descname">name</code><a class="headerlink" href="#sora.Observer.name" title="Permalink to this definition">¶</a></dt>
<dd><p>Name for the Observer. Observer is uniquely defined (name must be
different for each observer).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Observer.code">
<code class="sig-name descname">code</code><a class="headerlink" href="#sora.Observer.code" title="Permalink to this definition">¶</a></dt>
<dd><p>The IAU code for SORA to search for its coordinates in MPC database.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Observer.site">
<code class="sig-name descname">site</code><a class="headerlink" href="#sora.Observer.site" title="Permalink to this definition">¶</a></dt>
<dd><p>User provides an EarthLocation object.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>astropy.coordinates.EarthLocation</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Observer.lon">
<code class="sig-name descname">lon</code><a class="headerlink" href="#sora.Observer.lon" title="Permalink to this definition">¶</a></dt>
<dd><p>The Longitude of the site in degrees.
Positive to East. Range (0 to 360) or (-180 to +180).
User can provide in degrees (<cite>float</cite>) or hexadecimal (<cite>string</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite>, <cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Observer.lat">
<code class="sig-name descname">lat</code><a class="headerlink" href="#sora.Observer.lat" title="Permalink to this definition">¶</a></dt>
<dd><p>The Latitude of the site in degrees.
Positive North. Range (+90 to -90).
User can provide in degrees (float) or hexadecimal (string).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite>, <cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Observer.height">
<code class="sig-name descname">height</code><a class="headerlink" href="#sora.Observer.height" title="Permalink to this definition">¶</a></dt>
<dd><p>The height of the site in meters above see level.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>int</cite>, <cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Examples</p>
<p>User can provide one of the following to define an observer:</p>
<ul class="simple">
<li><p>If user will use the MPC name for the site:</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Observer</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>If user wants to use a different name from the MPC database:</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">code</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>If user wants to use an EarthLocation value:</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">EarthLocation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">EarthLocation</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">site</span><span class="p">)</span>
</pre></div>
</div>
<ul class="simple">
<li><p>If user wants to give site coordinates directly:</p></li>
</ul>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Observer</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="n">height</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt id="sora.Observer.altaz">
<code class="sig-name descname">altaz</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">coord</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/observer/core.html#Observer.altaz"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Observer.altaz" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Altitude and Azimuth at a reference time for a coordinate.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Reference time to calculate the sidereal time. It can be a string
in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p></li>
<li><p><strong>coord</strong> (<cite>str</cite>, <cite>astropy.coordinates.SkyCoord</cite>) – Coordinate of the target ICRS.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>altitude</strong> (<cite>float</cite>) – Object altitude in degrees.</p></li>
<li><p><strong>azimuth</strong> (<cite>float</cite>) – Object azimuth in degrees.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Observer.get_ksi_eta">
<code class="sig-name descname">get_ksi_eta</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">star</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/observer/core.html#Observer.get_ksi_eta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Observer.get_ksi_eta" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates relative position to star in the orthographic projection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Reference time to calculate the position. It can be a string in the
format <code class="docutils literal notranslate"><span class="pre">'yyyy-mm-dd</span> <span class="pre">hh:mm:ss.s'</span></code> or an astropy <cite>Time</cite> object.</p></li>
<li><p><strong>star</strong> (<cite>str</cite>, <cite>astropy.coordinates.SkyCoord</cite>) – The coordinate of the star in the same reference frame as the
ephemeris. It can be a string in the format <code class="docutils literal notranslate"><span class="pre">'hh</span> <span class="pre">mm</span> <span class="pre">ss.s</span> <span class="pre">+dd</span> <span class="pre">mm</span> <span class="pre">ss.ss'</span></code>
or an astropy <cite>SkyCoord</cite> object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>ksi, eta</strong> – On-sky orthographic projection of the observer relative to a star.
<code class="docutils literal notranslate"><span class="pre">ksi</span></code> is in the North-South direction (North positive).
<code class="docutils literal notranslate"><span class="pre">eta</span></code> is in the East-West direction (East positive).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>float</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Observer.sidereal_time">
<code class="sig-name descname">sidereal_time</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">mode</span><span class="o">=</span><span class="default_value">'local'</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/observer/core.html#Observer.sidereal_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Observer.sidereal_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Apparent Sidereal Time at a reference time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Reference time to calculate sidereal time.It can be a string
in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p></li>
<li><p><strong>mode</strong> (<cite>str</cite>) – Local or greenwich time.
If mode set <code class="docutils literal notranslate"><span class="pre">'local'</span></code> calculates the sidereal time for the
coordinates of this object.
If mode set <code class="docutils literal notranslate"><span class="pre">'greenwich'</span></code> calculates the Greenwich Apparent
Sidereal Time.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An Astropy Longitude object with the Sidereal Time.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>sidereal_time</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="id3">
<h3>Module <cite>utils</cite><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-sora.observer.utils"></span><dl class="py function">
<dt id="sora.observer.utils.search_code_mpc">
<code class="sig-prename descclassname">sora.observer.utils.</code><code class="sig-name descname">search_code_mpc</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/observer/utils.html#search_code_mpc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.observer.utils.search_code_mpc" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads the MPC Observer Database.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>observatories</strong> – A python dictionary with all the sites as Astropy EarthLocation objects.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="lightcurve">
<h2>LightCurve<a class="headerlink" href="#lightcurve" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-lightcurve-class">
<h3>The LightCurve Class<a class="headerlink" href="#the-lightcurve-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.LightCurve">
<em class="property">class </em><code class="sig-prename descclassname">sora.</code><code class="sig-name descname">LightCurve</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a Light Curve.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<cite>str</cite>) – The name of the LightCurve. Each time an LightCurve object is defined
the name must be different.</p></li>
<li><p><strong>tref</strong> (<cite>astropy.time.Time</cite>, <cite>str</cite>, <cite>float</cite>) – <p>Instant of reference.</p>
<p>Format: <cite>Julian Date</cite>, string in ISO format or Time object.
Required only if LightCurve have input fluxes and given time is
not in Julian Date.</p>
</p></li>
<li><p><strong>central_bandpass</strong> (<cite>int</cite>, <cite>float</cite>, otpional, default=0.7) – The center band pass of the detector used in observation. Value in microns.</p></li>
<li><p><strong>delta_bandpass</strong> (<cite>int</cite>, <cite>float</cite>, optional, default=0.3) – The band pass width of the detector used in observation. Value in microns.</p></li>
<li><p><strong>exptime</strong> (<cite>int</cite>, <cite>float</cite>) – The exposure time of the observation, in seconds.
<em>NOT</em> required in cases <em>2</em>, <em>3</em> and <em>4</em> below.
<em>Required</em> in case <em>1</em> below.</p></li>
<li><p><strong>**kwargs</strong> (<cite>int</cite>, <cite>float</cite>) – <p>Object velocity, distance, and star diameter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl>
<dt>vel<span class="classifier"><cite>int</cite>, <cite>float</cite></span></dt><dd><p>Velocity in km/s.</p>
</dd>
<dt>dist<span class="classifier"><cite>int</cite>, <cite>float</cite></span></dt><dd><p>Object distance in AU.</p>
</dd>
<dt>d_star<span class="classifier"><cite>float</cite></span></dt><dd><p>Star diameter, in km.</p>
</dd>
</dl>
</div>
</p></li>
</ul>
</dd>
</dl>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Input data must be one of the 4 options below:</p>
<ol class="arabic">
<li><dl>
<dt>Input data from file with time and flux</dt><dd><p><cite>file (str)</cite>: a file with the time and flux. A third column with the error in
flux can also be given.</p>
<p><cite>usecols (int, tuple, array)</cite>: Which columns to read, with the first being the
time, the seconds the flux and third the flux error (optional).</p>
<p><strong>Example:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">file</span><span class="p">,</span> <span class="n">exptime</span><span class="p">)</span> <span class="c1"># dflux can also be given</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
</div>
<ol class="arabic" start="2">
<li><dl>
<dt>Input data when file is not given:</dt><dd><p><cite>time</cite>: time must be a list of times, in seconds from tref, or Julian Date, or
a Time object.</p>
<p><cite>flux</cite>: flux must be a list of fluxes. It must have the same lenght as time.</p>
<p><cite>dflux</cite>: if file not given, dflux must be a list of fluxes errors. It must
have the same lenght as time. (not required)</p>
<p><strong>Example:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">flux</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="n">exptime</span><span class="p">)</span> <span class="c1"># dflux can also be given</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
<p>Cases for when <cite>time</cite> and <cite>flux</cite> are not given.</p>
<ol class="arabic" start="3">
<li><dl>
<dt>Input for a positive occultation:</dt><dd><p><cite>immersion</cite>: The instant of immersion.</p>
<p><cite>emersion</cite>: The instant of emersion.</p>
<p><cite>immersion_err</cite>: Immersion time uncertainty, in seconds.</p>
<p><cite>emersion_err</cite>: Emersion time uncertainty, in seconds.</p>
<p><strong>Example:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">immersion</span><span class="p">,</span> <span class="n">immersion_err</span><span class="p">,</span> <span class="n">emersion</span><span class="p">,</span> <span class="n">emersion_err</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl>
<dt>Input for a negative occultation:</dt><dd><p><cite>initial_time</cite>: The initial time of observation.</p>
<p><cite>end_time</cite>: The end time of observation.</p>
<p><strong>Example:</strong></p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LightCurve</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">initial_time</span><span class="p">,</span> <span class="n">end_time</span><span class="p">)</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ol>
<dl class="py method">
<dt id="sora.LightCurve.calc_magnitude_drop">
<code class="sig-name descname">calc_magnitude_drop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mag_star</span></em>, <em class="sig-param"><span class="n">mag_obj</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.calc_magnitude_drop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.calc_magnitude_drop" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the magnitude drop of the occultation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mag_star</strong> (<cite>int</cite>, <cite>float</cite>) – Star magnitude.</p></li>
<li><p><strong>int</strong> (<em>mag_obj</em>) – Object apparent magnitude to the date.</p></li>
<li><p><strong>float</strong> – Object apparent magnitude to the date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mag_drop</strong> (<cite>float</cite>) – Magnitude drop for the given magnitudes.</p></li>
<li><p><strong>bottom_flux</strong> (<cite>float</cite>) – Normalized bottom flux for the given magnitudes.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.normalize">
<code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">poly_deg</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">mask</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">flux_min</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">flux_max</span><span class="o">=</span><span class="default_value">1.0</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.normalize" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the fresnel scale.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>poly_deg</strong> (<cite>int</cite>) – Degree of the polynomial to be fitted.</p></li>
<li><p><strong>mask</strong> (<cite>bool</cite> array) – Which values to be fitted.</p></li>
<li><p><strong>flux_min</strong> (<cite>int</cite>, <cite>float</cite>) – Event flux to be set as 0.</p></li>
<li><p><strong>flux_max</strong> (<cite>int</cite>, <cite>float</cite>) – Baseline flux to be set as 1.</p></li>
<li><p><strong>plot</strong> (<cite>bool</cite>) – If True plot the steps for visual aid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.occ_detect">
<code class="sig-name descname">occ_detect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">maximum_duration</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dur_step</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">snr_limit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_detections</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.occ_detect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.occ_detect" title="Permalink to this definition">¶</a></dt>
<dd><p>Detects automatically the occultation event in the light curve.</p>
<p>Detects a ‘square well’ shaped transit. All parameters are optional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>maximum_duration</strong> (<cite>float</cite>, default: light curve time span) – Maximum duration of the occultation event.</p></li>
<li><p><strong>dur_step</strong> (<cite>float</cite>, default: 1/2 of sampling rate) – Step size to sweep occultation duration event.</p></li>
<li><p><strong>snr_limit</strong> (<cite>float</cite>, default=None) – Minimum occultation SNR.</p></li>
<li><p><strong>n_detections</strong> (<cite>int</cite>, default=1) – Number of detections regardless the SNR. <cite>n_detections</cite> is
superseded by <cite>snr_limit</cite>.</p></li>
<li><p><strong>plot</strong> (<cite>bool</cite>) – True if output plots are desired.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>OrderedDict</strong> – An ordered dictionary of <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code>:<code class="xref py py-attr docutils literal notranslate"><span class="pre">value</span></code> pairs for each
parameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lc</span> <span class="o">=</span> <span class="n">LightCurve</span><span class="p">(</span><span class="n">time</span><span class="o">=</span><span class="n">time</span><span class="p">,</span> <span class="n">flux</span><span class="o">=</span><span class="n">flux</span><span class="p">,</span> <span class="n">exptime</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;lc_example&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">lc</span><span class="o">.</span><span class="n">occ_detect</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span>
<span class="go">{&#39;rank&#39;: 1,</span>
<span class="go">&#39;occultation_duration&#39;: 40.1384063065052,</span>
<span class="go">&#39;central_time&#39;: 7916.773870512843,</span>
<span class="go">&#39;immersion_time&#39;: 7896.7046673595905,</span>
<span class="go">&#39;emersion_time&#39;: 7936.843073666096,</span>
<span class="go">&#39;time_err&#39;: 0.05011036992073059,</span>
<span class="go">&#39;depth&#39;: 0.8663887801707082,</span>
<span class="go">&#39;depth_err&#39;: 0.10986223384336465,</span>
<span class="go">&#39;baseline&#39;: 0.9110181732552853,</span>
<span class="go">&#39;baseline_err&#39;: 0.19045768512595365,</span>
<span class="go">&#39;snr&#39;: 7.886138392251848,</span>
<span class="go">&#39;occ_mask&#39;: array([False, False, False, ..., False, False, False])}</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.occ_lcfit">
<code class="sig-name descname">occ_lcfit</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.occ_lcfit"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.occ_lcfit" title="Permalink to this definition">¶</a></dt>
<dd><p>Monte Carlo chi square fit for occultations lightcurve.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tmin</strong> (<cite>int</cite>, <cite>float</cite>) – Minimum time to consider in the fit procedure, in seconds.</p></li>
<li><p><strong>tmax</strong> (<cite>int</cite>, <cite>float</cite>) – Maximum time to consider in the fit procedure, in seconds.</p></li>
<li><p><strong>flux_min</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – Bottom flux (only object).</p></li>
<li><p><strong>flux_max</strong> (<cite>int</cite>, <cite>float</cite>, default=1) – Base flux (object plus star).</p></li>
<li><p><strong>immersion_time</strong> (<cite>int</cite>, <cite>float</cite>) – Initial guess for immersion time, in seconds.</p></li>
<li><p><strong>emersion_time</strong> (<cite>int</cite>, <cite>float</cite>) – Initial guess for emersion time, in seconds.</p></li>
<li><p><strong>opacity</strong> (<cite>int</cite>, <cite>float</cite>, default=1) – Initial guess for opacity. Opaque = 1, Transparent = 0.</p></li>
<li><p><strong>delta_t</strong> (<cite>int</cite>, <cite>float</cite>) – Interval to fit immersion or emersion time.</p></li>
<li><p><strong>dopacity</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – Interval to fit opacity.</p></li>
<li><p><strong>sigma</strong> (<cite>int</cite>, <cite>float</cite>, <cite>array</cite>, ‘auto’) – Fluxes errors. If None it will use the <cite>self.dflux</cite>. If ‘auto’ it
will calculate using the region outside the event.</p></li>
<li><p><strong>loop</strong> (<cite>int</cite>, default=10000) – Number of tests to be done.</p></li>
<li><p><strong>sigma_result</strong> (<cite>int</cite>, <cite>float</cite>) – Sigma value to be considered as result.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>chi2</strong> – ChiSquare object.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>sora.extra.ChiSquare</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.occ_model">
<code class="sig-name descname">occ_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">immersion_time</span></em>, <em class="sig-param"><span class="n">emersion_time</span></em>, <em class="sig-param"><span class="n">opacity</span></em>, <em class="sig-param"><span class="n">mask</span></em>, <em class="sig-param"><span class="n">npt_star</span><span class="o">=</span><span class="default_value">12</span></em>, <em class="sig-param"><span class="n">time_resolution_factor</span><span class="o">=</span><span class="default_value">10</span></em>, <em class="sig-param"><span class="n">flux_min</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">flux_max</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.occ_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.occ_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the modelled light curve.</p>
<p>The modelled light curve takes into account the fresnel diffraction, the
star diameter and the instrumental response.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>immersion_time</strong> (<cite>int</cite>, <cite>float</cite>) – Immersion time, in seconds.</p></li>
<li><p><strong>emersion_time</strong> (<cite>int</cite>, <cite>float</cite>) – Emersion time, in seconds.</p></li>
<li><p><strong>opacity</strong> (<cite>int</cite>, <cite>float</cite>) – Opacity. Opaque = 1.0, transparent = 0.0,</p></li>
<li><p><strong>mask</strong> (<cite>bool</cite> array) – Mask with True values to be computed.</p></li>
<li><p><strong>npt_star</strong> (<cite>int</cite>, default=12) – Number of subdivisions for computing the star size effects.</p></li>
<li><p><strong>time_resolution_factor</strong> (<cite>int</cite>, <cite>float</cite>, default: 10*fresnel scale) – Steps for fresnel scale used for modelling the light curve.</p></li>
<li><p><strong>flux_min</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – Bottom flux (only object).</p></li>
<li><p><strong>flux_max</strong> (<cite>int</cite>, <cite>float</cite>, default=1) – Base flux (object plus star).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.plot_lc">
<code class="sig-name descname">plot_lc</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.plot_lc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.plot_lc" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the light curve</p>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.plot_model">
<code class="sig-name descname">plot_model</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.plot_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.plot_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the modelled light curve</p>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.reset_flux">
<code class="sig-name descname">reset_flux</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.reset_flux"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.reset_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets flux for original values</p>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.set_dist">
<code class="sig-name descname">set_dist</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">dist</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.set_dist"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.set_dist" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the object distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dist</strong> (<cite>int</cite>, <cite>float</cite>) – Object distance in AU.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.set_exptime">
<code class="sig-name descname">set_exptime</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">exptime</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.set_exptime"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.set_exptime" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the light curve exposure time.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>exptime</strong> (<cite>int</cite>, <cite>float</cite>) – Exposure time, in seconds.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.set_filter">
<code class="sig-name descname">set_filter</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">central_bandpass</span></em>, <em class="sig-param"><span class="n">delta_bandpass</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.set_filter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.set_filter" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the filter bandwidth in microns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>central_bandpass</strong> (<cite>float</cite>) – Center band in microns.</p></li>
<li><p><strong>delta_bandpass</strong> (<cite>float</cite>) – Bandwidth in microns.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.set_flux">
<code class="sig-name descname">set_flux</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.set_flux"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.set_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the flux for the LightCurve.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>exptime</strong> (<cite>int</cite>, <cite>float</cite>, required) – The exposure time of the observation, in seconds.</p></li>
<li><p><strong>file</strong> (<cite>str</cite>) – A file with the time and flux in the first and second columns,
respectively. A third column with error in flux can also be given.</p></li>
<li><p><strong>time</strong> – If file not given, time must be a list of times, in seconds from <cite>tref</cite>,
or <cite>Julian Date</cite>, or a <cite>Time object</cite>.</p></li>
<li><p><strong>flux</strong> – If file not given, flux must be a list of fluxes. It must have the
same lenght as time.</p></li>
<li><p><strong>dflux</strong> – If file not given, dflux must be a list of fluxes errors. It must
have the same lenght as time.</p></li>
<li><p><strong>tref</strong> (<cite>astropy.time.Time</cite>, <cite>str</cite>, <cite>float</cite>) – Instant of reference. It can be in <cite>Julian Date</cite>, string in ISO
format or <cite>Time object</cite>.</p></li>
<li><p><strong>usecols</strong> (<cite>int</cite>, <cite>tuple</cite>, array, optional) – Which columns to read, with the first being the time, the seconds
the flux and third the flux error.</p></li>
<li><p><strong>**kwargs</strong> (<cite>int</cite>, <cite>float</cite>) – <p>Object velocity, object distance, star diameter.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl>
<dt>vel<span class="classifier"><cite>int</cite>, <cite>float</cite></span></dt><dd><p>Velocity in km/s.</p>
</dd>
<dt>dist<span class="classifier"><cite>int</cite>, <cite>float</cite>:</span></dt><dd><p>Object distance in AU.</p>
</dd>
<dt>d_star<span class="classifier"><cite>float</cite></span></dt><dd><p>Star diameter, in km.</p>
</dd>
</dl>
</div>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.set_star_diam">
<code class="sig-name descname">set_star_diam</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">d_star</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.set_star_diam"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.set_star_diam" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the star diameter.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>d_star</strong> (<cite>float</cite>) – Star diameter, in km.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.set_vel">
<code class="sig-name descname">set_vel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">vel</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.set_vel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.set_vel" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the occultation velocity.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>vel</strong> (<cite>int</cite>, <cite>float</cite>) – Velocity in km/s.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.to_file">
<code class="sig-name descname">to_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">namefile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.to_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the light curve to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>namefile</strong> (<cite>str</cite>) – Filename to save the data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.LightCurve.to_log">
<code class="sig-name descname">to_log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">namefile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/core.html#LightCurve.to_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.LightCurve.to_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the light curve log to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>namefile</strong> (<cite>str</cite>) – Filename to save the log.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-sora.lightcurve.occdetect">
<span id="occutation-detection"></span><h3>Occutation Detection<a class="headerlink" href="#module-sora.lightcurve.occdetect" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="sora.lightcurve.occdetect.occ_detect">
<code class="sig-prename descclassname">sora.lightcurve.occdetect.</code><code class="sig-name descname">occ_detect</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">flux</span></em>, <em class="sig-param"><span class="n">dflux</span></em>, <em class="sig-param"><span class="n">time</span></em>, <em class="sig-param"><span class="n">cycle</span></em>, <em class="sig-param"><span class="n">maximum_duration</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">dur_step</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">snr_limit</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">n_detections</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/occdetect.html#occ_detect"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.lightcurve.occdetect.occ_detect" title="Permalink to this definition">¶</a></dt>
<dd><p>Detects automatically the occultation event in the light curve.</p>
<p>Detects a ‘square well’ shaped transit. All parameters are optional.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>flux</strong> (<cite>float</cite> array) – Flux of the time series. Dependent variable.</p></li>
<li><p><strong>dflux</strong> (<cite>float</cite> array) – Error in the flux. Error in the dependent variable.</p></li>
<li><p><strong>time</strong> (<cite>float</cite> array) – Time variable. Independent variable.</p></li>
<li><p><strong>cycle</strong> (<cite>float</cite>) – Sampling value of the time series.</p></li>
<li><p><strong>maximum_duration</strong> (<cite>float</cite>, default: light curve time span) – Maximum duration of the occultation event.</p></li>
<li><p><strong>dur_step</strong> (<cite>float</cite>, default: 1/2 cycle) – Step size to sweep occultation duration event.</p></li>
<li><p><strong>snr_limit</strong> (<cite>float</cite>, default=None) – Minimum occultation SNR.</p></li>
<li><p><strong>n_detections</strong> (<cite>int</cite>, default=1) – Number of detections regardless the SNR. <cite>n_detections</cite> is superseded by
<cite>snr_limit</cite>.</p></li>
<li><p><strong>plot</strong> (<cite>boolean</cite>, default=False) – True if output plots are desired.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>OrderedDict</strong> – An ordered dictionary of <code class="xref py py-attr docutils literal notranslate"><span class="pre">name</span></code>:<code class="xref py py-attr docutils literal notranslate"><span class="pre">value</span></code> pairs for each
parameter.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sora.lightcurve.occdetect</span> <span class="kn">import</span> <span class="n">occ_detect</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">occ_detect</span><span class="p">(</span><span class="n">flux</span><span class="p">,</span> <span class="n">dflux</span><span class="p">,</span> <span class="n">time</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span>
<span class="go">{&#39;rank&#39;: 1,</span>
<span class="go">&#39;occultation_duration&#39;: 40.1384063065052,</span>
<span class="go">&#39;central_time&#39;: 7916.773870512843,</span>
<span class="go">&#39;immersion_time&#39;: 7896.7046673595905,</span>
<span class="go">&#39;emersion_time&#39;: 7936.843073666096,</span>
<span class="go">&#39;time_err&#39;: 0.05011036992073059,</span>
<span class="go">&#39;depth&#39;: 0.8663887801707082,</span>
<span class="go">&#39;depth_err&#39;: 0.10986223384336465,</span>
<span class="go">&#39;baseline&#39;: 0.9110181732552853,</span>
<span class="go">&#39;baseline_err&#39;: 0.19045768512595365,</span>
<span class="go">&#39;snr&#39;: 7.886138392251848,</span>
<span class="go">&#39;occ_mask&#39;: array([False, False, False, ..., False, False, False])}</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="module-sora.lightcurve.utils">
<span id="module-s-utils"></span><h3>Module’s <cite>utils</cite><a class="headerlink" href="#module-sora.lightcurve.utils" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="sora.lightcurve.utils.calc_fresnel">
<code class="sig-prename descclassname">sora.lightcurve.utils.</code><code class="sig-name descname">calc_fresnel</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">distance</span></em>, <em class="sig-param"><span class="n">bandpass</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/utils.html#calc_fresnel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.lightcurve.utils.calc_fresnel" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the Fresnel scale.</p>
<p>Fresnel Scale = square root of half the multiplication of wavelength and
object distance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>distance</strong> (<cite>int</cite>, <cite>float</cite> array) – Distances, in km.</p></li>
<li><p><strong>bandpass</strong> (<cite>int</cite>, <cite>float</cite>, array) – Wavelength, in km.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>fresnel_scale</strong> – Fresnel scale, in km.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>float</cite>, array</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sora.lightcurve.utils.calc_magnitude_drop">
<code class="sig-prename descclassname">sora.lightcurve.utils.</code><code class="sig-name descname">calc_magnitude_drop</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">mag_star</span></em>, <em class="sig-param"><span class="n">mag_obj</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/lightcurve/utils.html#calc_magnitude_drop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.lightcurve.utils.calc_magnitude_drop" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the magnitude drop of the occultation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mag_star</strong> (<cite>int</cite>, <cite>float</cite>) – Star magnitude.</p></li>
<li><p><strong>mag_obj</strong> (<cite>int</cite>, <cite>float</cite>) – Object apparent magnitude to the date.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>mag_drop</strong> (<cite>float</cite>) – Magnitude drop for the given magnitudes.</p></li>
<li><p><strong>bottom_flux</strong> (<cite>float</cite>) – Normalized bottom flux for the given magnitudes.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="occultation">
<h2>Occultation<a class="headerlink" href="#occultation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="the-occultation-class">
<h3>The Occultation Class<a class="headerlink" href="#the-occultation-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.Occultation">
<em class="property">class </em><code class="sig-prename descclassname">sora.</code><code class="sig-name descname">Occultation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">star</span></em>, <em class="sig-param"><span class="n">body</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ephem</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">time</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation" title="Permalink to this definition">¶</a></dt>
<dd><p>Instantiates the Occultation object and performs the reduction of the
occultation.</p>
<dl class="py attribute">
<dt id="sora.Occultation.star">
<code class="sig-name descname">star</code><a class="headerlink" href="#sora.Occultation.star" title="Permalink to this definition">¶</a></dt>
<dd><p>the coordinate of the star in the same reference frame as the ephemeris.
It must be a Star object or a string with the coordinates of the object
to search on Vizier.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>sora.Star</cite>, <cite>str</cite>, required</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Occultation.body">
<code class="sig-name descname">body</code><a class="headerlink" href="#sora.Occultation.body" title="Permalink to this definition">¶</a></dt>
<dd><p>Object that will occult the star. It must be a Body object or its name
to search in the Small Body Database.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>sora.Body</cite>, <cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Occultation.ephem">
<code class="sig-name descname">ephem</code><a class="headerlink" href="#sora.Occultation.ephem" title="Permalink to this definition">¶</a></dt>
<dd><p>Object ephemeris. It must be an Ephemeris object or a list.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>sora.Ephem</cite>, <cite>list</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.Occultation.time">
<code class="sig-name descname">time</code><a class="headerlink" href="#sora.Occultation.time" title="Permalink to this definition">¶</a></dt>
<dd><p>Reference time of the occultation. Time does not need to be exact, but
needs to be within approximately 50 minutes of the occultation closest
approach to calculate occultation parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite>, <cite>astropy.time.Time</cite>, required</p>
</dd>
</dl>
</dd></dl>

<div class="admonition important">
<p class="admonition-title">Important</p>
<p>When instantiating with “body” and “ephem”, the user may define the
Occultation in 3 ways:</p>
<ol class="arabic simple">
<li><p>With <cite>body</cite> and <cite>ephem</cite>.</p></li>
</ol>
<p>2. With only “body”. In this case, the “body” parameter must be a Body
object and have an ephemeris associated (see Body documentation).</p>
<p>3. With only <cite>ephem</cite>. In this case, the <cite>ephem</cite> parameter must be one of the
Ephem Classes and have a name (see Ephem documentation) to search for the
body in the Small Body Database.</p>
</div>
<dl class="py method">
<dt id="sora.Occultation.add_observation">
<code class="sig-name descname">add_observation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">obs</span></em>, <em class="sig-param"><span class="n">lightcurve</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation.add_observation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation.add_observation" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds observations to the Occultation object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obs</strong> (<cite>sora.Observer</cite>) – The Observer object to be added.</p></li>
<li><p><strong>lightcurve</strong> (<cite>sora.LightCurve</cite>) – The LightCurve object to be added.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Occultation.check_time_shift">
<code class="sig-name descname">check_time_shift</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time_interval</span><span class="o">=</span><span class="default_value">30</span></em>, <em class="sig-param"><span class="n">time_resolution</span><span class="o">=</span><span class="default_value">0.001</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">plot</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">use_error</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">delta_plot</span><span class="o">=</span><span class="default_value">100</span></em>, <em class="sig-param"><span class="n">ignore_chords</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation.check_time_shift"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation.check_time_shift" title="Permalink to this definition">¶</a></dt>
<dd><p>Check the needed time offset, so all chords have their center aligned.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time_interval</strong> (<cite>int</cite>, <cite>float</cite>) – Time interval to check, default is 30 seconds.</p></li>
<li><p><strong>time_resolution</strong> (<cite>int</cite>, <cite>float</cite>) – Time resolution of the search, default is 0.001 seconds.</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – If True, it prints text, default is False.</p></li>
<li><p><strong>plot</strong> (<cite>bool</cite>, default=False) – If True, it plots figures as a visual aid.</p></li>
<li><p><strong>use_error</strong> (<cite>bool</cite>, default=True) – if True, the linear fit considers the time uncertainty.</p></li>
<li><p><strong>delta_plot</strong> (<cite>int</cite>, <cite>float</cite>, default=100) – Value to be added to increase the plot limit, in km.</p></li>
<li><p><strong>ignore_chords</strong> (<cite>str</cite>, list, default=None) – Names of the chords to be ignored in the linear fit.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>time_shift</strong> – Dictionary with needed time offset to align the chords, each key is
the name of the chord.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Occultation.check_velocities">
<code class="sig-name descname">check_velocities</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation.check_velocities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation.check_velocities" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints the current velocity used by the LightCurves and its radial velocity.</p>
</dd></dl>

<dl class="py method">
<dt id="sora.Occultation.fit_ellipse">
<code class="sig-name descname">fit_ellipse</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation.fit_ellipse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation.fit_ellipse" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits an ellipse to given occultation using given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center_f</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The coordinate in f of the ellipse center.</p></li>
<li><p><strong>center_g</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The coordinate in g of the ellipse center.</p></li>
<li><p><strong>equatorial_radius</strong> (<cite>int</cite>, <cite>float</cite>) – The Equatorial radius (semi-major axis) of the ellipse.</p></li>
<li><p><strong>oblateness</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The oblateness of the ellipse.</p></li>
<li><p><strong>position_angle</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The pole position angle of the ellipse in degrees.
Zero is in the North direction (‘g-positive’). Positive clockwise.</p></li>
<li><p><strong>dcenter_f</strong> (<cite>int</cite>, <cite>float</cite>) – Interval for coordinate f of the ellipse center.</p></li>
<li><p><strong>dcenter_g</strong> (<cite>int</cite>, <cite>float</cite>) – Interval for coordinate g of the ellipse center.</p></li>
<li><p><strong>int</strong> (<em>dequatorial_radius</em>) – Interval for the Equatorial radius (semi-major axis) of the ellipse.</p></li>
<li><p><strong>float</strong> – Interval for the Equatorial radius (semi-major axis) of the ellipse.</p></li>
<li><p><strong>doblateness</strong> (<cite>int</cite>, <cite>float</cite>) – Interval for the oblateness of the ellipse</p></li>
<li><p><strong>dposition_angle</strong> (<cite>int</cite>, <cite>float</cite>) – Interval for the pole position angle of the ellipse in degrees.</p></li>
<li><p><strong>loop</strong> (<cite>int</cite>, default=10000000) – The number of ellipses to attempt fitting.</p></li>
<li><p><strong>dchi_min</strong> (<cite>int</cite>, <cite>float</cite>) – If given, it will only save ellipsis which chi square are smaller than
chi_min + dchi_min.</p></li>
<li><p><strong>number_chi</strong> (<cite>int</cite>, default=10000) – If dchi_min is given, the procedure is repeated until number_chi is
reached.</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, default=False) – If True, it prints information while fitting.</p></li>
<li><p><strong>ellipse_error</strong> (<cite>int</cite>, <cite>float</cite>) – Model uncertainty to be considered in the fit, in km.</p></li>
<li><p><strong>sigma_result</strong> (<cite>int</cite>, <cite>float</cite>) – Sigma value to be considered as result.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>chisquare</strong> – A ChiSquare object with all parameters.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>sora.ChiSquare</cite></p>
</dd>
</dl>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Each occultation is added as the first argument(s) directly.</p>
<p>Mandatory input parameters: ‘center_f’, ‘center_g’, ‘equatorial_radius’,
‘oblateness’, and ‘position_angle’.</p>
<p>Parameters fitting interval: ‘dcenter_f’, ‘dcenter_g’, ‘dequatorial_radius’,
‘doblateness’, and ‘dposition_angle’. Default values are set to zero.
Search done between (value - dvalue) and (value + dvalue).</p>
</div>
<p class="rubric">Examples</p>
<p>To fit the ellipse to the chords of occ1 Occultation object:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fit_ellipse</span><span class="p">(</span><span class="n">occ1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>To fit the ellipse to the chords of occ1 and occ2 Occultation objects together:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fit_ellipse</span><span class="p">(</span><span class="n">occ1</span><span class="p">,</span> <span class="n">occ2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sora.Occultation.get_map_sites">
<code class="sig-name descname">get_map_sites</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation.get_map_sites"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation.get_map_sites" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns Dictionary with sites in the format required by plot_occ_map function.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>sites</strong> – Dictionary with the sites in the format required by <cite>plot_occ_map</cite>
function.</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p><cite>dict</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Occultation.new_astrometric_position">
<code class="sig-name descname">new_astrometric_position</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">offset</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">error</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation.new_astrometric_position"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation.new_astrometric_position" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the new astrometric position for the object given fitted parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<cite>str</cite>, <cite>astropy.time.Time</cite>) – Reference time to calculate the position. If not given, it uses the
instant of the occultation Closest Approach. It can be a string
in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p></li>
<li><p><strong>offset</strong> (<cite>list</cite>) – <p>Offset to apply to the position. If not given, uses the parameters
from the fitted ellipse.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Must be a list of 3 values being [X, Y, ‘unit’]. ‘unit’ must be
Angular or Distance unit.</p>
<p>If Distance units for X and Y:
Ex: [100, -200, ‘km’], [0.001, 0.002, ‘AU’]</p>
<p>If Angular units fox X [d*a*cos(dec)] and Y [d*dec]:
Ex: [30.6, 20, ‘mas’], or [-15, 2, ‘arcsec’]</p>
</div>
</p></li>
<li><p><strong>error</strong> (<cite>list</cite>) – <p>Error bar of the given offset. If not given, it uses the 1-sigma
value of the fitted ellipse.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Error must be a list of 3 values being [dX, dY, ‘unit’], similar to
offset. It does not need to be in the same unit as offset.</p>
</div>
</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – If true, it Prints text, else it Returns text.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Occultation.observations">
<code class="sig-name descname">observations</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation.observations"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation.observations" title="Permalink to this definition">¶</a></dt>
<dd><p>Print all the observations added to the Occultation object
Pair (<cite>Observer</cite>, <cite>LightCurve</cite>)</p>
</dd></dl>

<dl class="py method">
<dt id="sora.Occultation.plot_chords">
<code class="sig-name descname">plot_chords</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">all_chords</span><span class="o">=</span><span class="default_value">True</span></em>, <em class="sig-param"><span class="n">positive_color</span><span class="o">=</span><span class="default_value">'blue'</span></em>, <em class="sig-param"><span class="n">negative_color</span><span class="o">=</span><span class="default_value">'green'</span></em>, <em class="sig-param"><span class="n">error_color</span><span class="o">=</span><span class="default_value">'red'</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lw</span><span class="o">=</span><span class="default_value">2</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation.plot_chords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation.plot_chords" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the chords of the occultation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_chords</strong> (<cite>bool</cite>, default=True) – If True, it plots all the chords. If False, it sees what was
deactivated in self.positions and ignores them.</p></li>
<li><p><strong>positive_color</strong> (<cite>str</cite>, default=’blue’) – Color for the positive chords.</p></li>
<li><p><strong>negative_color</strong> (<cite>str</cite>, default=’green’) – Color for the negative chords.</p></li>
<li><p><strong>error_color</strong> (<cite>str</cite>, default=’red’) – Color for the error bars of the chords.</p></li>
<li><p><strong>ax</strong> (<cite>maptlotlib.pyplot.Axes</cite>, default=None) – Axis where to plot chords (default: Uses matplotlib pool).</p></li>
<li><p><strong>lw</strong> (<cite>int</cite>, <cite>float</cite>, default=2) – Linewidth of the chords.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Occultation.plot_occ_map">
<code class="sig-name descname">plot_occ_map</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation.plot_occ_map"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation.plot_occ_map" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>radius</strong> (<cite>int</cite>, <cite>float</cite>) – The radius of the shadow. If not given it uses saved value.</p></li>
<li><p><strong>nameimg</strong> (<cite>str</cite>) – Change the name of the image saved.</p></li>
<li><p><strong>path</strong> (<cite>str</cite>) – Path to a directory where to save map.</p></li>
<li><p><strong>resolution</strong> (<cite>int</cite>, default=2) – </p></li>
<li><p><strong>feature resolution.</strong> (<em>Cartopy</em>) – </p></li>
<li><p><strong>1 means a resolution of &quot;10m&quot;;</strong> (<em>-</em>) – </p></li>
<li><p><strong>2 a resolution of &quot;50m&quot;;</strong> (<em>-</em>) – </p></li>
<li><p><strong>3 a resolution of &quot;100m&quot;.</strong> (<em>-</em>) – </p></li>
<li><p><strong>states</strong> (<cite>bool</cite>) – If True, plots the states borders of the countries. The states
of some countries will only be shown depending on the resolution.</p></li>
<li><p><strong>zoom</strong> (<cite>int</cite>, <cite>float</cite>) – Zooms in or out of the map.</p></li>
<li><p><strong>centermap_geo</strong> (<cite>list</cite>, default=None) – Center the map given coordinates in longitude and latitude. It must be
a list with two numbers.</p></li>
<li><p><strong>centermap_delta</strong> (<cite>list</cite>, default=None) – Displace the center of the map given displacement in X and Y, in km.
It must be a list with two numbers.</p></li>
<li><p><strong>centerproj</strong> (<cite>list</cite>) – Rotates the Earth to show occultation with the center projected at a
given longitude and latitude. It must be a list with two numbers.</p></li>
<li><p><strong>labels</strong> (<cite>bool</cite>, default=True) – Plots text above and below the map with the occultation parameters.</p></li>
<li><p><strong>meridians</strong> (<cite>int</cite>, default=30) – Plots lines representing the meridians for given interval, in degrees.</p></li>
<li><p><strong>parallels</strong> (<cite>int</cite>, default=30) – Plots lines representing the parallels for given interval, in degrees.</p></li>
<li><p><strong>sites</strong> (<cite>dict</cite>) – Plots site positions in map. It must be a python dictionary where the
key is  the <cite>name</cite> of the site, and the value is a list with <cite>longitude</cite>,
<cite>latitude</cite>, <cite>delta_x</cite>, <cite>delta_y</cite> and <cite>color</cite>. <cite>delta_x</cite> and <cite>delta_y</cite>
are displacement, in km, from the point position of the site in the map
and the <cite>name</cite>. <cite>color</cite> is the color of the point.</p></li>
<li><p><strong>site_name</strong> (<cite>bool</cite>) – If True, it prints the name of the sites given, else it plots only the points.</p></li>
<li><p><strong>countries</strong> (<cite>dict</cite>) – Plots the names of countries. It must be a python dictionary where the
key is the name of the country and the value is a list with longitude
and latitude of the lower left part of the text.</p></li>
<li><p><strong>offset</strong> (<cite>list</cite>) – Applies an offset to the ephemeris, calculating new CA and instant of
CA. It is a pair of <cite>delta_RA*cosDEC</cite> and <cite>delta_DEC</cite>.</p></li>
<li><p><strong>mapstyle</strong> (<cite>int</cite>, default=1) – Define the color style of the map. <code class="docutils literal notranslate"><span class="pre">'1'</span></code> is the default black
and white scale. <code class="docutils literal notranslate"><span class="pre">'2'</span></code> is a colored map.</p></li>
<li><p><strong>error</strong> (<cite>int</cite>, <cite>float</cite>) – Ephemeris error in mas. It plots a dashed line representing radius + error.</p></li>
<li><p><strong>ercolor</strong> (<cite>str</cite>) – Changes the color of the lines of the error bar.</p></li>
<li><p><strong>ring</strong> (<cite>int</cite>, <cite>float</cite>) – Plots a dashed line representing the location of a ring. It is given
in km, from the center.</p></li>
<li><p><strong>rncolor</strong> (<cite>str</cite>) – Changes the color of ring lines.</p></li>
<li><p><strong>atm</strong> (<cite>int</cite>, <cite>float</cite>) – Plots a dashed line representing the location of an atmosphere. It is
given in km, from the center.</p></li>
<li><p><strong>atcolor</strong> (<cite>str</cite>) – Changes the color of atm lines.</p></li>
<li><p><strong>chord_delta</strong> (<cite>list</cite>) – List with distances from center to plot chords.</p></li>
<li><p><strong>chord_geo</strong> (<cite>2d-list</cite>) – List with pairs of coordinates to plot chords.</p></li>
<li><p><strong>chcolor</strong> (<cite>str</cite>, default=’grey’) – Color of the line of the chords.</p></li>
<li><p><strong>heights</strong> (<cite>list</cite>) – It plots a circular dashed line showing the locations where the observer
would observe the occultation at a given height above the horizons.
This must be a list.</p></li>
<li><p><strong>hcolor</strong> (<cite>str</cite>) – Changes the color of the height lines.</p></li>
<li><p><strong>mapsize</strong> (<cite>list</cite>, default= [46.0, 38.0]) – The size of figure, in cm. It must be a list with two values.</p></li>
<li><p><strong>cpoints</strong> (<cite>int</cite>, <cite>float</cite>, default=60) – Interval for the small points marking the center of shadow, in seconds.</p></li>
<li><p><strong>ptcolor</strong> (<cite>str</cite>) – Change the color of the center points.</p></li>
<li><p><strong>alpha</strong> (<cite>float</cite>, default=0.2) – The transparency of the night shade, where 0.0 is full transparency and
1.0 is full black.</p></li>
<li><p><strong>fmt</strong> (<cite>str</cite>, default:’png’) – The format to save the image. It is parsed directly by <cite>matplotlib.pyplot</cite>.</p></li>
<li><p><strong>dpi</strong> (<cite>int</cite>, default=100) – Resolution in “dots per inch”. It defines the quality of the image.</p></li>
<li><p><strong>lncolor</strong> (<cite>str</cite>) – Changes the color of the line that represents the limits of the shadow
over Earth.</p></li>
<li><p><strong>outcolor</strong> (<cite>str</cite>) – Changes the color of the lines that represents the limits of the shadow
outside Earth.</p></li>
<li><p><strong>scale</strong> (<cite>int</cite>, <cite>float</cite>) – Arbitrary scale for the size of the name of the site.</p></li>
<li><p><strong>cscale</strong> (<cite>int</cite>, <cite>float</cite>) – Arbitrary scale for the name of the country.</p></li>
<li><p><strong>sscale</strong> (<cite>int</cite>, <cite>float</cite>) – Arbitrary scale for the size of point of the site.</p></li>
<li><p><strong>pscale</strong> (<cite>int</cite>, <cite>float</cite>) – Arbitrary scale for the size of the points that represent the center of
the shadow.</p></li>
<li><p><strong>arrow</strong> (<cite>bool</cite>) – If True, it plots the arrow with the occultation direction.</p></li>
</ul>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Only one of centermap_geo and centermap_delta can be given.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="sora.Occultation.positions">
<em class="property">property </em><code class="sig-name descname">positions</code><a class="headerlink" href="#sora.Occultation.positions" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the position and velocity for all chords.
Saves it into an <cite>_PositionDict</cite> object.</p>
</dd></dl>

<dl class="py method">
<dt id="sora.Occultation.remove_observation">
<code class="sig-name descname">remove_observation</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span></em>, <em class="sig-param"><span class="n">key_lc</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation.remove_observation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation.remove_observation" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes an observation from the Occultation object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<cite>str</cite>) – The name given to <cite>Observer</cite> or <cite>LightCurve</cite> to remove from the list.</p></li>
<li><p><strong>key_lc</strong> (<cite>str</cite>) – In the case where repeated names are present for different
observations, <cite>key_lc</cite> must be given for the name of the <cite>LightCurve</cite>
and key will be used for the name of the <cite>Observer</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.Occultation.to_file">
<code class="sig-name descname">to_file</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation.to_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation.to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the occultation data to a file.</p>
<p>Three files are saved containing the positions and velocities for the
observations. They are for the positive, negative and error bars positions.</p>
<p>The format of the files are: positions in f and g, velocities in f and
g, the Julian Date of the observation, light curve name of the
corresponding position.</p>
</dd></dl>

<dl class="py method">
<dt id="sora.Occultation.to_log">
<code class="sig-name descname">to_log</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">namefile</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/core.html#Occultation.to_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.Occultation.to_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the occultation log to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>namefile</strong> (<cite>str</cite>) – Filename to save the log.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-chord-class">
<h3>The Chord Class<a class="headerlink" href="#the-chord-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.occultation.Chord">
<em class="property">class </em><code class="sig-prename descclassname">sora.occultation.</code><code class="sig-name descname">Chord</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">name</span></em>, <em class="sig-param"><span class="n">observer</span></em>, <em class="sig-param"><span class="n">lightcurve</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chord.html#Chord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.Chord" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines an Occultation Chord.</p>
<dl class="py attribute">
<dt id="sora.occultation.Chord.name">
<code class="sig-name descname">name</code><a class="headerlink" href="#sora.occultation.Chord.name" title="Permalink to this definition">¶</a></dt>
<dd><p>The name of the Chord.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>str</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.occultation.Chord.observer">
<code class="sig-name descname">observer</code><a class="headerlink" href="#sora.occultation.Chord.observer" title="Permalink to this definition">¶</a></dt>
<dd><p>The site of observation.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>sora.Observer</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.occultation.Chord.lightcurve">
<code class="sig-name descname">lightcurve</code><a class="headerlink" href="#sora.occultation.Chord.lightcurve" title="Permalink to this definition">¶</a></dt>
<dd><p>The lightcurve observed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>sora.LightCurve</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.Chord.disable">
<code class="sig-name descname">disable</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">time</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chord.html#Chord.disable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.Chord.disable" title="Permalink to this definition">¶</a></dt>
<dd><p>Disables a contact point of the curve to be used in the fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<cite>None</cite>, <cite>str</cite>) – If None, it will disable all contact points.
If <code class="docutils literal notranslate"><span class="pre">'immersion'</span></code> or <code class="docutils literal notranslate"><span class="pre">'emersion'</span></code>, it will disable respective
contact point.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.Chord.enable">
<code class="sig-name descname">enable</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">time</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chord.html#Chord.enable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.Chord.enable" title="Permalink to this definition">¶</a></dt>
<dd><p>Enables a contact point of the curve to be used in the fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>time</strong> (<cite>None</cite>, <cite>str</cite>) – If <code class="docutils literal notranslate"><span class="pre">None</span></code>, it will enable all contact points.
If <code class="docutils literal notranslate"><span class="pre">'immersion'</span></code> or <code class="docutils literal notranslate"><span class="pre">'emersion'</span></code>, it will enable respective
contact point.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.Chord.get_fg">
<code class="sig-name descname">get_fg</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">time</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">vel</span><span class="o">=</span><span class="default_value">False</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chord.html#Chord.get_fg"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.Chord.get_fg" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the on-sky position for this chord at a given time.</p>
<p>This Chord object must be associated to an Occultation to work, since
it needs the position of the star and an ephemeris.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>time</strong> (<cite>astropy.time.Time</cite>, <cite>str</cite>) – It must a time or a list of time to calculate the on-sky position.
If time is <code class="docutils literal notranslate"><span class="pre">'immersion'</span></code>, <code class="docutils literal notranslate"><span class="pre">'emersion'</span></code>, <code class="docutils literal notranslate"><span class="pre">'start'</span></code> or <code class="docutils literal notranslate"><span class="pre">'end'</span></code>,
it will get the respective on-sky position. If <code class="docutils literal notranslate"><span class="pre">time=None</span></code>, it
will return the on-sky position for the immersion and emersion times
if positive or raise an error if negative.</p></li>
<li><p><strong>vel</strong> (<cite>bool</cite>) – If True, it will return the on-sky velocity as well.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>f, g, [vf, vg]</strong> – The geocentric on-sky Orthographic projection of the object with <cite>f</cite>
pointing to the celestial North and <cite>g</cite> pointing to the celestial
East. The respective velocities (vf, vg) are returned if <code class="docutils literal notranslate"><span class="pre">vel=True</span></code>.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>float</cite>, <cite>float</cite>, [<cite>float</cite>, <cite>float</cite>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.Chord.get_impact_param">
<code class="sig-name descname">get_impact_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">center_f</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">center_g</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chord.html#Chord.get_impact_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.Chord.get_impact_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the impact parameter, minimal distance between the chord and the
centre position.</p>
<p>This Chord object must be associated to an Occultation to work, since it
needs the position of the star and an ephemeris.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center_f</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The coordinate in f of the ellipse center;</p></li>
<li><p><strong>center_g</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The coordinate in g of the ellipse center.</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, default=True) – If True, prints the obtained values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>impact, sense</strong> – The impact parameter (in km) and the direction of the chord relative
the ellipse center, North (N), South (S), East (E) and West (W).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.Chord.get_theoretical_times">
<code class="sig-name descname">get_theoretical_times</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equatorial_radius</span></em>, <em class="sig-param"><span class="n">center_f</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">center_g</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">oblateness</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">position_angle</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">sigma</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chord.html#Chord.get_theoretical_times"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.Chord.get_theoretical_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the theoretical times and chord size for a given ellipse.</p>
<p>This Chord object must be associated to an Occultation to work, since
it needs the position of the star and an ephemeris.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equatorial_radius</strong> (<cite>int</cite>, <cite>float</cite>) – The Equatorial radius (semi-major axis) of the ellipse.</p></li>
<li><p><strong>center_f</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The coordinate in f of the ellipse center</p></li>
<li><p><strong>center_g</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The coordinate in g of the ellipse center</p></li>
<li><p><strong>oblateness</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The oblateness of the ellipse.</p></li>
<li><p><strong>position_angle</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The pole position angle of the ellipse in degrees.
Zero is in the North direction (‘g-positive’). Positive clockwise.</p></li>
<li><p><strong>sigma</strong> (<cite>int</cite>, <cite>float</cite>) – Uncertainty of the expected ellipse, in km.</p></li>
<li><p><strong>step</strong> (<cite>int</cite>, <cite>float</cite>) – Time resolution of the chord, in seconds.</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, default=True) – If True, prints the obtained values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>theory_immersion_time, theory_emersion_time, theory_chord_size</strong> – The expected immersion time for the given ellipse, the expected
emersion time for the given ellipse, and the expected chord size
for the given ellipse.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.Chord.is_able">
<em class="property">property </em><code class="sig-name descname">is_able</code><a class="headerlink" href="#sora.occultation.Chord.is_able" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a dictionary with the references enabled and disabled for the fit.</p>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.Chord.path">
<code class="sig-name descname">path</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">segment</span><span class="o">=</span><span class="default_value">'standard'</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chord.html#Chord.path"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.Chord.path" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the on-sky path of this chord.</p>
<p>This Chord object must be associated to an Occultation to work, since it
needs the position of the star and an ephemeris.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segment</strong> (<cite>str</cite>) – <p>The segment to get the path of the chord. The available options are:</p>
<p><code class="docutils literal notranslate"><span class="pre">'positive'</span></code>: to get the path between the immersion and emersion
times if the chord is positive.</p>
<p><code class="docutils literal notranslate"><span class="pre">'negative'</span></code>: to get the path between the start and end of
observation if the chord is negative.</p>
<p><code class="docutils literal notranslate"><span class="pre">'standard'</span></code>: to get the ‘positive’ path if the chord is positive
or ‘negative’ if the chord is negative.</p>
<p><code class="docutils literal notranslate"><span class="pre">'full'</span></code>: to get  the path between the start and end of observation
independent if the chord is positive or negative.</p>
<p><code class="docutils literal notranslate"><span class="pre">'outer'</span></code>: to get the path outside the ‘positive’ path, for
instance between the start and immersion times and between the
emersion and end times.</p>
<p><code class="docutils literal notranslate"><span class="pre">'error'</span></code>: to get the path corresponding to the error bars. Be aware
that some of these segments may return more than 1 path, for example
<code class="docutils literal notranslate"><span class="pre">segment='error'</span></code>.</p>
</p></li>
<li><p><strong>step</strong> (<cite>int</cite>, <cite>float</cite>, <cite>str</cite>) – <p>If a number, it corresponds to the step, in seconds, for each point
of the path.</p>
<p>This correspond to an approximate value if it is not a multiple of
the interval of the segment.</p>
<p>The step can also be equal to <code class="docutils literal notranslate"><span class="pre">'exposure'</span></code>. In this case, the path
will return a set of pairs where each pair will have the position
at the beginning of the exposure and the end of the exposure.</p>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>path f, path g</strong> – It will return the path separated by <cite>f</cite> and <cite>g</cite>. If <code class="docutils literal notranslate"><span class="pre">step='exposure'</span></code>,
it will return f and g intercalated for each exposure.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>array</cite>, <cite>array</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.Chord.plot_chord">
<code class="sig-name descname">plot_chord</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">segment</span><span class="o">=</span><span class="default_value">'standard'</span></em>, <em class="sig-param"><span class="n">only_able</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">linestyle</span><span class="o">=</span><span class="default_value">'-'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chord.html#Chord.plot_chord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.Chord.plot_chord" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the on-sky path of this chord.</p>
<p>This Chord object must be associated to an Occultation to work, since
it needs the position of the star and an ephemeris.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segment</strong> (<cite>str</cite>) – <p>The segment to plot the chord. The available options are:</p>
<p><code class="docutils literal notranslate"><span class="pre">'positive'</span></code>: to get the path between the immersion and emersion
times if the chord is positive.</p>
<p><code class="docutils literal notranslate"><span class="pre">'negative'</span></code>: to get the path between the start and end of
observation if the chord is negative.</p>
<dl class="simple">
<dt><code class="docutils literal notranslate"><span class="pre">'standard'</span></code>: to get the ‘positive’ path if the chord is positive</dt><dd><p>or ‘negative’ if the chord is negative.</p>
</dd>
</dl>
<p><code class="docutils literal notranslate"><span class="pre">'full'</span></code>: to get  the path between the start and end of observation
independent if the chord is positive or negative.</p>
<p><code class="docutils literal notranslate"><span class="pre">'outer'</span></code>: to get the path outside the ‘positive’ path, for
instance between the start and immersion times and between the
emersion and end times.</p>
<p><code class="docutils literal notranslate"><span class="pre">'error'</span></code>: to get the path corresponding to the error bars.</p>
</p></li>
<li><p><strong>only_able</strong> (<cite>bool</cite>) – Plot only the contact points that are able to be used in the fit.
If <code class="docutils literal notranslate"><span class="pre">segment='error'</span></code> it will show only the contact points able. If
segment is any other, the path will be plotted only if both
immersion and emersion are able, or it is a negative chord.</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.Axes</cite>) – The axes where to make the plot. If None, it will use the default axes.</p></li>
<li><p><strong>linestyle</strong> (<cite>str</cite>) – Default linestyle used in <cite>matplotlib.pyplot.plot</cite>.
The difference is that now it accepts <code class="docutils literal notranslate"><span class="pre">linestyle='exposure'</span></code>, where
the plot will be a dashed line corresponding to each exposure.
The blank space between the lines can be interpreted as ‘dead time’.</p></li>
<li><p><strong>**kwargs</strong> – Any other kwarg will be parsed directly by <cite>maplotlip.pyplot.plot</cite>.
The only difference is that the default linewidth <code class="docutils literal notranslate"><span class="pre">lw=2</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.Chord.status">
<code class="sig-name descname">status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chord.html#Chord.status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.Chord.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns if the chord is positive or negative</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="the-chordlist-class">
<h3>The Chordlist Class<a class="headerlink" href="#the-chordlist-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.occultation.chordlist.ChordList">
<em class="property">class </em><code class="sig-prename descclassname">sora.occultation.chordlist.</code><code class="sig-name descname">ChordList</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">star</span></em>, <em class="sig-param"><span class="n">body</span></em>, <em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chordlist.html#ChordList"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.chordlist.ChordList" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines a collection of Chord objects associated to an Occultation.</p>
<p>This object is not supposed to be defined by the user. It will be automatically
defined in Occultation.</p>
<dl class="py attribute">
<dt id="sora.occultation.chordlist.ChordList.star">
<code class="sig-name descname">star</code><a class="headerlink" href="#sora.occultation.chordlist.ChordList.star" title="Permalink to this definition">¶</a></dt>
<dd><p>The Star occulted.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>sora.Star</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.occultation.chordlist.ChordList.body">
<code class="sig-name descname">body</code><a class="headerlink" href="#sora.occultation.chordlist.ChordList.body" title="Permalink to this definition">¶</a></dt>
<dd><p>The occulting Body.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>sora.Body</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="sora.occultation.chordlist.ChordList.time">
<code class="sig-name descname">time</code><a class="headerlink" href="#sora.occultation.chordlist.ChordList.time" title="Permalink to this definition">¶</a></dt>
<dd><p>The occultation time.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><cite>astropy.time.Time</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.chordlist.ChordList.add_chord">
<code class="sig-name descname">add_chord</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">name</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">chord</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">observer</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">lightcurve</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chordlist.html#ChordList.add_chord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.chordlist.ChordList.add_chord" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a chord to the occultation chord list</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> (<cite>str</cite>) – The name of the Chord. It must be unique within the list of chords.
If not given, it will use the name in chord if chord is directly
given or the name in the observer object. If the name in Chord already
exists in the list, the name parameter can be given to update the
chord name. The <cite>name</cite> parameter is required if given together with
observer and lightcurve. It can not be an empty string.</p></li>
<li><p><strong>sora.occultation.Chord</strong> (<em>chord</em>) – A chord instance defined by the user.</p></li>
<li><p><strong>observer</strong> (<cite>sora.Observer</cite>) – An Observer instance defined by the user. It must be given together
with a lightcurve.</p></li>
<li><p><strong>lightcurve</strong> (<cite>sora.LightCurve</cite>) – A lightcurve defined by the user. It must be given together with observer.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Ways to add a chord:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">chord</span><span class="p">)</span> <span class="c1"># where the name in chord will be used.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">chord</span><span class="p">)</span> <span class="c1"># where the name in chord will be replaced by &quot;name&quot;.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">observer</span><span class="p">,</span> <span class="n">lightcurve</span><span class="p">)</span> <span class="c1"># where the name in observer will be used.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">add_chord</span><span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="n">observer</span><span class="p">,</span> <span class="n">lightcurve</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.chordlist.ChordList.disable">
<code class="sig-name descname">disable</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">chord</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">time</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chordlist.html#ChordList.disable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.chordlist.ChordList.disable" title="Permalink to this definition">¶</a></dt>
<dd><p>Disable a contact point of the curve to be used in the fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chord</strong> (<cite>str</cite>) – Name of the chord to disable. If <code class="docutils literal notranslate"><span class="pre">chord=None</span></code>, it applies to all chords.</p></li>
<li><p><strong>time</strong> (None, <cite>str</cite>) – If <code class="docutils literal notranslate"><span class="pre">time=None</span></code>, it will disable all contact points.
If ‘immersion’ or ‘emersion’, it will disable respective contact point.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.chordlist.ChordList.enable">
<code class="sig-name descname">enable</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">chord</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">time</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chordlist.html#ChordList.enable"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.chordlist.ChordList.enable" title="Permalink to this definition">¶</a></dt>
<dd><p>Enable a contact point of the curve to be used in the fit.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chord</strong> (<cite>str</cite>) – Name of the chord to enable. If <code class="docutils literal notranslate"><span class="pre">chord=None</span></code>, it applies to all chords.</p></li>
<li><p><strong>time</strong> (Non`, <cite>str</cite>) – If <code class="docutils literal notranslate"><span class="pre">time=None</span></code>, it will enable all contact points.
If ‘immersion’ or ‘emersion’, it will enable respective contact point.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.chordlist.ChordList.get_impact_param">
<code class="sig-name descname">get_impact_param</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">chords</span><span class="o">=</span><span class="default_value">'all_chords'</span></em>, <em class="sig-param"><span class="n">center_f</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">center_g</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chordlist.html#ChordList.get_impact_param"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.chordlist.ChordList.get_impact_param" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the impact parameter, minimal distance between the chord and the
centre position.</p>
<p>This Chord object must be associated to an Occultation to work, since it
needs the position of the star and an ephemeris.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chords</strong> (<cite>int</cite>, <cite>str</cite>, default=’all_chords’) – Index or names of the chords to be considered.</p></li>
<li><p><strong>center_f</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The coordinate in f of the ellipse center.</p></li>
<li><p><strong>center_g</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The coordinate in g of the ellipse center.</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – If True, prints the obtained values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>impact, sense, chord_name</strong> – The impact parameter (in km), the direction of the chord relative
the ellipse center, North (N), South (S), East (E) and West (W), and
the name of the chord</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.chordlist.ChordList.get_theoretical_times">
<code class="sig-name descname">get_theoretical_times</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equatorial_radius</span></em>, <em class="sig-param"><span class="n">chords</span><span class="o">=</span><span class="default_value">'all_chords'</span></em>, <em class="sig-param"><span class="n">center_f</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">center_g</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">oblateness</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">position_angle</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">sigma</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">True</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chordlist.html#ChordList.get_theoretical_times"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.chordlist.ChordList.get_theoretical_times" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the theoretical times and chords sizes for a given ellipse.</p>
<p>This Chord object must be associated to an Occultation to work, since it needs
the position of the star and an ephemeris.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chords</strong> (<cite>int</cite>, <cite>str</cite>, default=’all_chords’) – Index or names of the chords to be considered.</p></li>
<li><p><strong>equatorial_radius</strong> (<cite>int</cite>, <cite>float</cite>) – The Equatorial radius (semi-major axis) of the ellipse.</p></li>
<li><p><strong>center_f</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The coordinate in f of the ellipse center.</p></li>
<li><p><strong>center_g</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The coordinate in g of the ellipse center.</p></li>
<li><p><strong>oblateness</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The oblateness of the ellipse.</p></li>
<li><p><strong>position_angle</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The pole position angle of the ellipse in degrees.
Zero is in the North direction (‘g-positive’). Positive clockwise.</p></li>
<li><p><strong>sigma</strong> (<cite>int</cite>, <cite>float</cite>) – Uncertainty of the expected ellipse, in km.</p></li>
<li><p><strong>step</strong> (<cite>int</cite>, <cite>float</cite>) – Time resolution of the chord, in seconds.</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>) – If True, prints the obtained values.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>theory_immersion_time, theory_emersion_time, theory_chord_size, chord_name</strong> – The expected immersion time for the given ellipse, the expected
emersion time for the given ellipse, the expected chord size for the
given ellipse, and the name of the chord.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.chordlist.ChordList.plot_chords">
<code class="sig-name descname">plot_chords</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">segment</span><span class="o">=</span><span class="default_value">'standard'</span></em>, <em class="sig-param"><span class="n">ignore_chords</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">only_able</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">linestyle</span><span class="o">=</span><span class="default_value">'-'</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chordlist.html#ChordList.plot_chords"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.chordlist.ChordList.plot_chords" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots the on-sky path of this chord.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>segment</strong> (<cite>str</cite>) – <p>The segment to plot the chord. The available options are:</p>
<p><code class="docutils literal notranslate"><span class="pre">'positive'</span></code> to get the path between the immersion and emersion
times if the chord is positive.</p>
<p><code class="docutils literal notranslate"><span class="pre">'negative'</span></code> to get the path between the start and end of
observation if the chord is negative.</p>
<p><code class="docutils literal notranslate"><span class="pre">'standard'</span></code> to get the ‘positive’ path if the chord is positive
or ‘negative’ if the chord is negative.</p>
<p><code class="docutils literal notranslate"><span class="pre">'full'</span></code> to get  the path between the start and end of observation
independent if the chord is positive or negative.</p>
<p><code class="docutils literal notranslate"><span class="pre">'outer'</span></code> to get the path outside the ‘positive’ path, for instance
between the start and immersion times and between the emersion and
end times.</p>
<p><code class="docutils literal notranslate"><span class="pre">'error'</span></code> to get the path corresponding to the error bars.</p>
</p></li>
<li><p><strong>ignore_chords</strong> (<cite>str</cite>, <cite>list</cite>) – Name of chord or list of names to ignore in the plot.</p></li>
<li><p><strong>only_able</strong> (<cite>bool</cite>) – Plot only the chords or contact points that are able to be used in the fit.
If <code class="docutils literal notranslate"><span class="pre">segment='error'</span></code> it will show only the contact points able.
If segment is any other, the path will be plotted only if both
immersion and emersion are able, or it is a negative chord.</p></li>
<li><p><strong>ax</strong> (<cite>matplotlib.pyplot.Axes</cite>) – The axes where to make the plot. If None, it will use the default axes.</p></li>
<li><p><strong>linestyle</strong> (<cite>str</cite>) – Default linestyle used in <cite>matplotlib.pyplot.plot</cite>. The difference
is that now it accept <code class="docutils literal notranslate"><span class="pre">linestyle='exposure'</span></code>, where the plot will
be a dashed line corresponding to each exposure. The blank space
between the lines can be interpreted as ‘dead time’.</p></li>
<li><p><strong>**kwargs</strong> – Any other kwarg will be parsed directly by <cite>maplotlip.pyplot.plot</cite>.
The only difference is that the default linewidth <code class="docutils literal notranslate"><span class="pre">lw=2</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.chordlist.ChordList.remove_chord">
<code class="sig-name descname">remove_chord</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span></em>, <em class="sig-param"><span class="n">name</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chordlist.html#ChordList.remove_chord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.chordlist.ChordList.remove_chord" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove a chord from the chord list and disassociate it from the Occultation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>name</strong> (<cite>str</cite>) – The name of the chord.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.occultation.chordlist.ChordList.summary">
<code class="sig-name descname">summary</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/chordlist.html#ChordList.summary"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.chordlist.ChordList.summary" title="Permalink to this definition">¶</a></dt>
<dd><p>Prints a table with the summary of the chords.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="fit-ellipse">
<h3>Fit Ellipse<a class="headerlink" href="#fit-ellipse" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="sora.occultation.fit_ellipse">
<code class="sig-prename descclassname">sora.occultation.</code><code class="sig-name descname">fit_ellipse</code><span class="sig-paren">(</span><em class="sig-param"><span class="o">*</span><span class="n">args</span></em>, <em class="sig-param"><span class="n">equatorial_radius</span></em>, <em class="sig-param"><span class="n">dequatorial_radius</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">center_f</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">dcenter_f</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">center_g</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">dcenter_g</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">oblateness</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">doblateness</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">position_angle</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">dposition_angle</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">loop</span><span class="o">=</span><span class="default_value">10000000</span></em>, <em class="sig-param"><span class="n">number_chi</span><span class="o">=</span><span class="default_value">10000</span></em>, <em class="sig-param"><span class="n">dchi_min</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">verbose</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ellipse_error</span><span class="o">=</span><span class="default_value">0</span></em>, <em class="sig-param"><span class="n">sigma_result</span><span class="o">=</span><span class="default_value">1</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/fitting.html#fit_ellipse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.fit_ellipse" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits an ellipse to given occultation using given parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>center_f</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The coordinate in f of the ellipse center.</p></li>
<li><p><strong>center_g</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The coordinate in g of the ellipse center.</p></li>
<li><p><strong>equatorial_radius</strong> (<cite>int</cite>, <cite>float</cite>) – The Equatorial radius (semi-major axis) of the ellipse.</p></li>
<li><p><strong>oblateness</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The oblateness of the ellipse.</p></li>
<li><p><strong>position_angle</strong> (<cite>int</cite>, <cite>float</cite>, default=0) – The pole position angle of the ellipse in degrees.
Zero is in the North direction (‘g-positive’). Positive clockwise.</p></li>
<li><p><strong>dcenter_f</strong> (<cite>int</cite>, <cite>float</cite>) – Interval for coordinate f of the ellipse center.</p></li>
<li><p><strong>dcenter_g</strong> (<cite>int</cite>, <cite>float</cite>) – Interval for coordinate g of the ellipse center.</p></li>
<li><p><strong>int</strong> (<em>dequatorial_radius</em>) – Interval for the Equatorial radius (semi-major axis) of the ellipse.</p></li>
<li><p><strong>float</strong> – Interval for the Equatorial radius (semi-major axis) of the ellipse.</p></li>
<li><p><strong>doblateness</strong> (<cite>int</cite>, <cite>float</cite>) – Interval for the oblateness of the ellipse</p></li>
<li><p><strong>dposition_angle</strong> (<cite>int</cite>, <cite>float</cite>) – Interval for the pole position angle of the ellipse in degrees.</p></li>
<li><p><strong>loop</strong> (<cite>int</cite>, default=10000000) – The number of ellipses to attempt fitting.</p></li>
<li><p><strong>dchi_min</strong> (<cite>int</cite>, <cite>float</cite>) – If given, it will only save ellipsis which chi square are smaller than
chi_min + dchi_min.</p></li>
<li><p><strong>number_chi</strong> (<cite>int</cite>, default=10000) – If dchi_min is given, the procedure is repeated until number_chi is
reached.</p></li>
<li><p><strong>verbose</strong> (<cite>bool</cite>, default=False) – If True, it prints information while fitting.</p></li>
<li><p><strong>ellipse_error</strong> (<cite>int</cite>, <cite>float</cite>) – Model uncertainty to be considered in the fit, in km.</p></li>
<li><p><strong>sigma_result</strong> (<cite>int</cite>, <cite>float</cite>) – Sigma value to be considered as result.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>chisquare</strong> – A ChiSquare object with all parameters.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>sora.ChiSquare</cite></p>
</dd>
</dl>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>Each occultation is added as the first argument(s) directly.</p>
<p>Mandatory input parameters: ‘center_f’, ‘center_g’, ‘equatorial_radius’,
‘oblateness’, and ‘position_angle’.</p>
<p>Parameters fitting interval: ‘dcenter_f’, ‘dcenter_g’, ‘dequatorial_radius’,
‘doblateness’, and ‘dposition_angle’. Default values are set to zero.
Search done between (value - dvalue) and (value + dvalue).</p>
</div>
<p class="rubric">Examples</p>
<p>To fit the ellipse to the chords of occ1 Occultation object:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fit_ellipse</span><span class="p">(</span><span class="n">occ1</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>To fit the ellipse to the chords of occ1 and occ2 Occultation objects together:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fit_ellipse</span><span class="p">(</span><span class="n">occ1</span><span class="p">,</span> <span class="n">occ2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="id4">
<h3>Module <cite>utils</cite><a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-sora.occultation.utils"></span><dl class="py function">
<dt id="sora.occultation.utils.filter_negative_chord">
<code class="sig-prename descclassname">sora.occultation.utils.</code><code class="sig-name descname">filter_negative_chord</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">chord</span></em>, <em class="sig-param"><span class="n">chisquare</span></em>, <em class="sig-param"><span class="n">step</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">sigma</span><span class="o">=</span><span class="default_value">0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/utils.html#filter_negative_chord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.utils.filter_negative_chord" title="Permalink to this definition">¶</a></dt>
<dd><p>Get points for the ellipse with the given input parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chord</strong> (<cite>sora.observer.Chord</cite>) – Chord object, must be associated to an Occultation to work.</p></li>
<li><p><strong>chisquare</strong> (<cite>sora.extra.ChiSquare</cite>) – Resulted ChiSquare object of fit_ellipse.</p></li>
<li><p><strong>sigma</strong> (<cite>int</cite>, <cite>float</cite>) – Uncertainty of the expected ellipse, in km.</p></li>
<li><p><strong>step</strong> (<cite>int</cite>, <cite>float</cite>, <cite>str</cite>) – If a number, it corresponds to the step, in seconds, for each point of
the chord path. The step can also be equal to <code class="docutils literal notranslate"><span class="pre">'exposure'</span></code>. In this
case, the chord path will consider the lightcurve individual times and
exptime.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="sora.occultation.utils.positionv">
<code class="sig-prename descclassname">sora.occultation.utils.</code><code class="sig-name descname">positionv</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">star</span></em>, <em class="sig-param"><span class="n">ephem</span></em>, <em class="sig-param"><span class="n">observer</span></em>, <em class="sig-param"><span class="n">time</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/occultation/utils.html#positionv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.occultation.utils.positionv" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the position and velocity of the occultation shadow relative
to the observer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>star</strong> (<cite>sora.Star</cite>) – The coordinate of the star in the same reference frame as the ephemeris.
It must be a Star object.</p></li>
<li><p><strong>ephem</strong> (<cite>sora.Ephem</cite>) – The object ephemeris. It must be an Ephemeris object.</p></li>
<li><p><strong>observer</strong> (<cite>sora.Observer</cite>) – The Observer information. It must be an Observer object.</p></li>
<li><p><strong>time</strong> (<cite>astropy.time.Time</cite>) – Reference instant to calculate position and velocity. It can be a string
in the ISO format (yyyy-mm-dd hh:mm:ss.s) or an astropy Time object.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>f, g, vf, vg</strong> – The orthographic projection of the shadow relative to the observer.
<code class="docutils literal notranslate"><span class="pre">'f'</span></code> is in the x-axis (East-West direction; East positive).
<code class="docutils literal notranslate"><span class="pre">'g'</span></code> is in the y-axis (North-South direction; North positive).</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite></p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="extra">
<h2>Extra<a class="headerlink" href="#extra" title="Permalink to this headline">¶</a></h2>
<div class="section" id="chisquare-class">
<h3>ChiSquare Class<a class="headerlink" href="#chisquare-class" title="Permalink to this headline">¶</a></h3>
<dl class="py class">
<dt id="sora.extra.ChiSquare">
<em class="property">class </em><code class="sig-prename descclassname">sora.extra.</code><code class="sig-name descname">ChiSquare</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">chi2</span></em>, <em class="sig-param"><span class="n">npts</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/extra/chisquare.html#ChiSquare"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.extra.ChiSquare" title="Permalink to this definition">¶</a></dt>
<dd><p>Stores the arrays for all inputs and given chi-square.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>chi2</strong> (<cite>array</cite>) – Array with all the chi-square values.</p></li>
<li><p><strong>npts</strong> (<cite>int</cite>) – Number of points used in the fit.</p></li>
<li><p><strong>**kwargs</strong> – Any other given input must be an array with the same size as chi2. The
keyword <cite>name</cite> will be associated as the variable <cite>name</cite> of the given data.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chisquare</span> <span class="o">=</span> <span class="n">ChiSquare</span><span class="p">(</span><span class="n">chi2</span><span class="p">,</span> <span class="n">immersion</span><span class="o">=</span><span class="n">t1</span><span class="p">,</span> <span class="n">emersion</span><span class="o">=</span><span class="n">t2</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">t1</span></code> and <code class="docutils literal notranslate"><span class="pre">t2</span></code> must be an array with the same size as chi2.</p>
<p>The data can be accessed as</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">chisquare</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;immersion&#39;</span><span class="p">]</span>
</pre></div>
</div>
<dl class="py method">
<dt id="sora.extra.ChiSquare.get_nsigma">
<code class="sig-name descname">get_nsigma</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sigma</span><span class="o">=</span><span class="default_value">1</span></em>, <em class="sig-param"><span class="n">key</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/extra/chisquare.html#ChiSquare.get_nsigma"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.extra.ChiSquare.get_nsigma" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines the interval of the chi-square within the nth sigma.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> (<cite>float</cite>, <cite>int</cite>) – Value of sigma to calculate.</p></li>
<li><p><strong>key</strong> (<cite>str</cite>, default=None) – keyword the user desire to obtain results.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dictionary with the average n-sigma value and bondaries.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.9)">dict</a></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a key value is given the mean value within the n-sigma and the error
bar within the n-sigma are returned.</p>
<p>If no key is given, a dictionary with: the minimum chi-square, the sigma
required, the number of points where <span class="math notranslate nohighlight">\(chi2 &lt; (chi2_min + sigma^2)\)</span>,
and the mean values and errors for all keys is returned.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="sora.extra.ChiSquare.get_values">
<code class="sig-name descname">get_values</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">sigma</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">key</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/extra/chisquare.html#ChiSquare.get_values"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.extra.ChiSquare.get_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all values where the chi-square is within the nth sigma.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sigma</strong> (<cite>float</cite>, <cite>int</cite>) – Value of sigma to cut values.</p></li>
<li><p><strong>key</strong> (<cite>str</cite>) – Keyword (parameter) that the user desires to obtain results of.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>list or dict</strong> – List or dictionary with chi-square values within the nth sigma, the
average n-sigma value, and bondaries.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><cite>list</cite>, <cite>dict</cite></p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If a <cite>key</cite> is given, it returns a <cite>list</cite> with all the values that are within
the chosen n-sigma.</p>
<p>If no <cite>key</cite> is given, it returns a dictionary with the list with all the
values that are within the n-sigma for all keys.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">sigma=0</span></code>, it returns the parameters for the minimum chi-square
instead of a list.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="sora.extra.ChiSquare.plot_chi2">
<code class="sig-name descname">plot_chi2</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">key</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/extra/chisquare.html#ChiSquare.plot_chi2"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.extra.ChiSquare.plot_chi2" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots an ellipse using the input parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>key</strong> (<cite>str</cite>) – Key (parameter) for which to plot the chi squares. If no key  is
given, it will plot for all parameters.</p></li>
<li><p><strong>ax</strong> (<cite>maplotlib.pyplot.Axes</cite>) – Matplotlib plot axes. If none is given, it uses the matplotlib pool
to identify.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="sora.extra.ChiSquare.to_file">
<code class="sig-name descname">to_file</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">namefile</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/extra/chisquare.html#ChiSquare.to_file"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.extra.ChiSquare.to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves the data to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>namefile</strong> (<cite>str</cite>) – Filename to save the data.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-sora.extra.plots">
<span id="plot-ellipse"></span><h3>Plot ellipse<a class="headerlink" href="#module-sora.extra.plots" title="Permalink to this headline">¶</a></h3>
<dl class="py function">
<dt id="sora.extra.plots.draw_ellipse">
<code class="sig-prename descclassname">sora.extra.plots.</code><code class="sig-name descname">draw_ellipse</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">equatorial_radius</span></em>, <em class="sig-param"><span class="n">oblateness</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">center_f</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">center_g</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">position_angle</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">center_dot</span><span class="o">=</span><span class="default_value">False</span></em>, <em class="sig-param"><span class="n">ax</span><span class="o">=</span><span class="default_value">None</span></em>, <em class="sig-param"><span class="o">**</span><span class="n">kwargs</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/extra/plots.html#draw_ellipse"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.extra.plots.draw_ellipse" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots an ellipse with the given input parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>equatorial_radius</strong> (<cite>float</cite>, <cite>int</cite>, default=0) – Semi-major axis of the ellipse.</p></li>
<li><p><strong>oblateness</strong> (<cite>float</cite>, <cite>int</cite>, default=0) – Oblateness of the ellipse.</p></li>
<li><p><strong>center_f</strong> (<cite>float</cite>, <cite>int</cite>, default=0) – Coordinate of the ellipse (abscissa).</p></li>
<li><p><strong>center_g</strong> (<cite>float</cite>, <cite>int</cite>, default=0) – Coordinate of the ellipse (ordinate).</p></li>
<li><p><strong>center_dot</strong> (<cite>bool</cite>, default=False) – If True, plots a dot at the center of the ellipse.</p></li>
<li><p><strong>position_angle</strong> (<cite>float</cite>, <cite>int</cite>, default= 0) – Pole position angle (Default=0.0).</p></li>
<li><p><strong>ax</strong> (<cite>maptlotlib.pyplot.Axes</cite>) – Axis where to plot ellipse.</p></li>
<li><p><strong>**kwargs</strong> – All other parameters. They will be parsed directly by matplotlib.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id5">
<h3>Module <cite>utils</cite><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-sora.extra.utils"></span><dl class="py function">
<dt id="sora.extra.utils.get_ellipse_points">
<code class="sig-prename descclassname">sora.extra.utils.</code><code class="sig-name descname">get_ellipse_points</code><span class="sig-paren">(</span><em class="sig-param"><span class="n">theta</span></em>, <em class="sig-param"><span class="n">equatorial_radius</span></em>, <em class="sig-param"><span class="n">oblateness</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">center_f</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">center_g</span><span class="o">=</span><span class="default_value">0.0</span></em>, <em class="sig-param"><span class="n">position_angle</span><span class="o">=</span><span class="default_value">0.0</span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/sora/extra/utils.html#get_ellipse_points"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#sora.extra.utils.get_ellipse_points" title="Permalink to this definition">¶</a></dt>
<dd><p>Get points for the ellipse with the given input parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>theta</strong> (<cite>float</cite> array) – Angular coordinate, in degrees, to return the ellipse points.</p></li>
<li><p><strong>equatorial_radius</strong> (<cite>float</cite>, <cite>int</cite>) – Semi-major axis of the ellipse.</p></li>
<li><p><strong>oblateness</strong> (<cite>float</cite>, <cite>int</cite>, default=0) – Oblateness of the ellipse.</p></li>
<li><p><strong>center_f</strong> (<cite>float</cite>, <cite>int</cite>, default=0) – Coordinate of the ellipse (abscissa).</p></li>
<li><p><strong>center_g</strong> (<cite>float</cite>, <cite>int</cite>, default=0) – Coordinate of the ellipse (ordinate).</p></li>
<li><p><strong>position_angle</strong> (<cite>float</cite>, <cite>int</cite>, default=0) – The pole position angle of the ellipse in degrees.
Zero is in the North direction (‘g-positive’). Positive clockwise.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x_model</strong> (<cite>float</cite>, array) – Cartesian x-component, in km</p></li>
<li><p><strong>y_model</strong> (<cite>float</cite>, array) – Cartesian y-component, in km</p></li>
<li><p><strong>r_model</strong> (<cite>float</cite>, array) – Radial distance, in km</p></li>
<li><p><strong>theta</strong> (<cite>float</cite> array) – Angular coordinate, in degrees, to return the ellipse points.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="examples/Tutorial_SORAv0.2_GettingStarted.html" class="btn btn-neutral float-right" title="SORA Getting Started" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="team.html" class="btn btn-neutral float-left" title="About Us" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020, SORA Team.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>